<html><head>


<meta http-equiv="Content-Type" content="text/html; charset=GB2312">
<meta name="Generator" content="Microsoft Word 12 (filtered)">
<title>JFox 参考指南</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 5 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 3 5 7 5 2 3 3;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
h1
	{margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:240%;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
h2
	{margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:173%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h3
	{margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:173%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
h4
	{margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:156%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h5
	{margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:156%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
h6
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:133%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:63.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	font-size:16.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	background:navy;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:宋体;}
p.MMTitle, li.MMTitle, div.MMTitle
	{mso-style-name:"MM Title";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	font-size:16.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MMTopic1, li.MMTopic1, div.MMTopic1
	{mso-style-name:"MM Topic 1";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:240%;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.MMTopic2, li.MMTopic2, div.MMTopic2
	{mso-style-name:"MM Topic 2";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:173%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MMTopic3, li.MMTopic3, div.MMTopic3
	{mso-style-name:"MM Topic 3";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:9.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:173%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.a
	{mso-style-name:a;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
 /* Page Definitions */
 @page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head><body style="" link="blue" lang="ZH-CN" vlink="purple">

<div class="Section1" style="">

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-size: 36pt; font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><span style="font-size: 36pt; font-family: 宋体;" lang="EN-US">JFox </span><span style="font-size: 36pt; font-family: 宋体;">参考指南</span></p>

<p class="MsoNormal" style="margin-left: 161.9pt; text-indent: 468pt;"><span style="font-size: 36pt; font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><span style="font-size: 36pt; font-family: 宋体;" lang="EN-US">V3.0</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-size: 14pt; font-family: 宋体;">目 录</span></b></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745367"><span style="font-family: 宋体;">1.</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">文档说明</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">4</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745368"><span style="font-family: 宋体;">1.1</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">内容范围</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">4</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745369"><span style="font-family: 宋体;">1.2</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">阅读对象</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">4</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745370"><span style="font-family: 宋体;">1.3</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">版权声明</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">4</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745371"><span style="font-family: 宋体;">1.4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">历史记录</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">4</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745372"><span style="font-family: 宋体;">2.JFox </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">概述</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">5</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745373">2.1<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">功能特性</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">5</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745374">2.2 JFox<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">在企业应用中的角色</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">5</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745375"><span style="font-family: 宋体;">3. JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">安装与配置指南</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">6</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745376">3.1<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">运行环<span lang="EN-US">境</span></span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">6</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745377">3.2<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">资源下载</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">7</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745378">3.3<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">安装</span></span>Tomcat<span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">7</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745379"><span style="font-family: 宋体;">3.4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">安装JFox</span></span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">7</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745380"><span style="font-family: 宋体;">3.5</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">安装集成版</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">8</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745381"><span style="font-family: 宋体;">3.6 JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">目录结构</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">8</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745382"><span style="font-family: 宋体;">3.7</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">主程序结构</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">8</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745383"><span style="font-family: 宋体;">3.8 JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块结构</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">9</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745384"><span style="font-family: 宋体;">3.9 JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">配置</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">9</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745385"><span style="font-family: 宋体;">3.10 web.xml</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">配置</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">10</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745386"><span style="font-family: 宋体;">3.11</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">数据源配置</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">10</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745387"><span style="font-family: 宋体;">4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">第一个EJB</span></span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">应用</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">12</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745388">4.1<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">第一个</span></span>Session Bean<span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">12</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745389">4.2<span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">第一个</span></span>Entity Bean<span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">14</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745390"><span style="font-family: 宋体;">4.3</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">第一个Message Driven Bean</span></span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">19</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745391"><span style="font-family: 宋体;">4.4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">容器外运行与容器内运行</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">21</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745392"><span style="font-family: 宋体;">4.4.1</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">容器外运行</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">21</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745393"><span style="font-family: 宋体;">4.4.2</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">容器内运行</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">22</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745394"><span style="font-family: 宋体;">5 JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">体系结构</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">22</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745395"><span style="font-family: 宋体;">5.1 JFox Java EE</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">容器</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">23</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745396"><span style="font-family: 宋体;">5.1.1 JNDI</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">23</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745397"><span style="font-family: 宋体;">5.1.2 EJB3 Container</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">23</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745398"><span style="font-family: 宋体;">5.1.3 Security</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">27</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745399"><span style="font-family: 宋体;" lang="FR">5.1.4 Web Service</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">32</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745400"><span style="font-family: 宋体;" lang="FR">5.1.5 Transaction
Manager</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">35</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745401"><span style="font-family: 宋体;" lang="FR">5.1.6 Message
Service</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">35</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745402"><span style="font-family: 宋体;">5.1.7 JFox 3 EJB</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">容器的局限性</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">38</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745403"><span style="font-family: 宋体;">5.1.8 JPA Container</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">38</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745404"><span style="font-family: 宋体;">5.2 JFox</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">微内核</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">52</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745405"><span style="font-family: 宋体;">5.2.1 Component</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">52</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745406"><span style="font-family: 宋体;">5.2.2 ComponentContext</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">54</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745407"><span style="font-family: 宋体;">5.2.3 Annotation</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">54</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745408"><span style="font-family: 宋体;" lang="FR">5.2.4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">事件和监听器</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">59</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745409"><span style="font-family: 宋体;">5.2.5</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">生命周期回调方法</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">59</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745410"><span style="font-family: 宋体;">5.2.6</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">全局占位符</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">61</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745411"><span style="font-family: 宋体;">5.3 JFox MVC </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">框架</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">62</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745412"><span style="font-family: 宋体;">5.3.1 web.xml</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">62</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745413"><span style="font-family: 宋体;">5.3.2 Action</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">65</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745414"><span style="font-family: 宋体;">5.3.3 Invocation</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">72</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745415"><span style="font-family: 宋体;">5.3.4 InvocationContext</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">78</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745416"><span style="font-family: 宋体;">5.3.5</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">依赖注入</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">81</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745417"><span style="font-family: 宋体;">5.3.6</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">文件上传</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">82</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745418"><span style="font-family: 宋体;">5.3.7</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">使用JAAS</span></span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">登录</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">82</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745419"><span style="font-family: 宋体;">5.3.8</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">访问Action</span></span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">84</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745420"><span style="font-family: 宋体;">5.4 JFox Module</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">84</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745421"><span style="font-family: 宋体;">5.4.1</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块结构</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">85</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745422"><span style="font-family: 宋体;">5.4.2</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块类路径</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">85</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745423"><span style="font-family: 宋体;">5.4.3</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块的配置</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">85</span></a></span></span></p>

<p class="MsoToc3"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745424"><span style="font-family: 宋体;">5.4.4</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块的部署</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">86</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745425"><span style="font-family: 宋体;">6</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">管理控制台</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">86</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745426"><span style="font-family: 宋体;">6.1 System Information</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">86</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745427"><span style="font-family: 宋体;">6.2 JNDI View</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">87</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745428"><span style="font-family: 宋体;">6.3 EJB Container</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">88</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745429"><span style="font-family: 宋体;">6.4 JPA Container</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">88</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745430"><span style="font-family: 宋体;">6.5 Modules</span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">89</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745431"><span style="font-family: 宋体;">6.6</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">查看Web Service</span></span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">90</span></a></span></span></p>

<p class="MsoToc1"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745432"><span style="font-family: 宋体;">7</span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">安装JFox Petstore</span></span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">模块</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">90</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745433"><span style="font-family: 宋体;">7.1 </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">环境准备</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">90</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745434"><span style="font-family: 宋体;">7.2 </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">配置Petstore</span></span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">数据源</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">91</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745435"><span style="font-family: 宋体;">7.3 </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">导入初始化数据</span></span><span style="color: windowtext; display: none; text-decoration: none;">... </span><span style="color: windowtext; display: none; text-decoration: none;">91</span></a></span></span></p>

<p class="MsoToc2"><span class="MsoHyperlink"><span lang="EN-US"><a href="#_Toc171745436"><span style="font-family: 宋体;">7.4 </span><span style="font-family: 宋体;" lang="EN-US"><span lang="EN-US">访问Petstore</span></span><span style="color: windowtext; display: none; text-decoration: none;">. </span><span style="color: windowtext; display: none; text-decoration: none;">92</span></a></span></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h1 style="margin-left: 21.6pt; text-indent: -21.6pt;"><a name="_Toc171745367"></a><a name="_Toc88467912"></a><a name="_Toc88465947"></a><a name="_Toc41099336"></a><a name="_Toc525899624"></a><a name="_Toc523468822"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">1.</span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">文档说明</span></h1>

<p class="MsoNormal" style="margin: 6pt 0cm; text-indent: 21pt;"><span style="font-family: 宋体;">本文档是<span lang="EN-US">JFox 3.0 </span>开放源码应用服务器参考手册，主要介绍<span lang="EN-US">JFox 3.0</span>应用服务器的安装、开发、部署、结构。</span></p>

<h2 style="margin: 12pt 0cm 6pt 28.8pt; text-indent: -28.8pt; line-height: 172%;"><a name="_Toc171745368"></a><a name="_Toc88467913"></a><a name="_Toc88465948"></a><a name="_Toc41099337"></a><a name="_Toc525899625"></a><a name="_Toc523468823"><span style="font-family: 宋体; font-weight: normal;" lang="EN-US">1.1</span></a><span style="font-family: 宋体;">内容范围</span></h2>

<p class="MsoNormal" style="margin: 6pt 0cm; text-indent: 21pt;"><span style="font-family: 宋体;">本文档由如下章节组成：</span></p>

<p class="MsoNormal" style="margin: 6pt 0cm 6pt 61.4pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp; </span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">概述</span></p>

<p class="MsoNormal" style="margin: 6pt 0cm 6pt 61.4pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp; </span></span><span style="font-family: 宋体;" lang="EN-US">JFox </span><span style="font-family: 宋体;">安装、目录结构、配置</span></p>

<p class="MsoNormal" style="margin: 6pt 0cm 6pt 61.4pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp; </span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">体系结构</span></p>

<p class="MsoNormal" style="margin: 6pt 0cm 6pt 61.4pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp; </span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">应用开发</span></p>

<h2 style="margin: 12pt 0cm 6pt 28.8pt; text-indent: -28.8pt; line-height: 172%;"><a name="_Toc171745369"></a><a name="_Toc88467914"></a><a name="_Toc88465949"></a><a name="_Toc41099338"></a><a name="_Toc525899626"></a><a name="_Toc523468824"><span style="font-family: 宋体; font-weight: normal;" lang="EN-US">1.2</span></a><span style="font-family: 宋体;">阅读对象</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">本</span><span style="font-family: 宋体;">文档</span><span style="font-family: 宋体;">面向的主要对象是<span lang="EN-US">JFox</span>应用服务器的用户</span><span style="font-family: 宋体;">、</span><span style="font-family: 宋体;" lang="EN-US">Java EE</span><span style="font-family: 宋体;">开发人员、技术专家、广大师生、<span lang="EN-US">Java EE</span>技术爱好者。如果你有任何疑问，可以访问<span lang="EN-US">JFox</span>网站<span lang="EN-US">(<a href="http://www.jfox.org.cn/">http://www.jfox.org.cn</a>)</span>获得帮助，或者发邮件至<span lang="EN-US"><a href="mailto:support@jfox.org.cn">support@jfox.org.cn</a></span>。</span></p>

<h2 style="margin: 12pt 0cm 6pt 28.8pt; text-indent: -28.8pt; line-height: 172%;"><a name="_Toc171745370"></a><a name="_Toc88467915"></a><a name="_Toc88465950"><span style="font-family: 宋体; font-weight: normal;" lang="EN-US">1.3</span></a><span style="font-family: 宋体;">版权声明</span></h2>

<p class="MsoNormal" style="margin: 6pt 0cm; text-indent: 26.25pt;"><span style="font-family: 宋体;" lang="EN-US">Copyright
&#169; 2007 JFox Team</span><span style="font-family: 宋体;">。 </span></p>

<p class="MsoNormal" style="margin: 6pt 0cm; text-indent: 26.25pt;"><span style="font-family: 宋体;" lang="EN-US">JFox
</span><span style="font-family: 宋体;">遵循<span lang="EN-US"> LGPL(<a href="http://www.gnu.org/licenses/lgpl.txt">http://www.gnu.org/licenses/lgpl.txt</a>)
</span>协议进行分发，复制和修改。</span></p>

<p class="MsoNormal" style="margin-left: 5.25pt; text-align: left; text-indent: 21pt;" align="left"><span style="font-family: 宋体;" lang="EN-US">JFox trademarks are trademarks or registered trademarks of JFox Team. </span></p>

<h2><a name="_Toc171745371"><span style="font-family: 宋体;" lang="EN-US">1.4</span></a><span style="font-family: 宋体;">历史记录</span></h2>

<table class="MsoNormalTable" style="border: medium none ; margin-left: 14.4pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 127.6pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="170">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">日期</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 142.05pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="189">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">内容</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 142.05pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="189">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">作者</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">2007-5-7</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;">文档结构初始化</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Peter Cheng, Young
  Yang</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">2007-5-19</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;">完成主要章节</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Young Yang,Peter
  Cheng</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">2007-5-20</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;">全文<span lang="EN-US">Review, </span>错误修订</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Peter Cheng</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">2007-5-23</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;">再次<span lang="EN-US">Review</span>，错误修订</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Young Yang</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 127.6pt;" valign="top" width="170">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 142.05pt;" valign="top" width="189">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MMTopic1"><a name="_Toc171745372"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">2.JFox </span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">概述</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">应用被设计为轻量的、稳定的、高性能的<span lang="EN-US">Java EE</span>应用服务器，从<span lang="EN-US">3.0</span>开始，<span lang="EN-US">JFox</span>提供了支持模块化的<span lang="EN-US">MVC</span>框架，以简化<span lang="EN-US">EJB</span>以及<span lang="EN-US">Web</span>应用的开发，以满足企业对快速化统一开发平台的迫切要求。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 20.75pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3</span><span style="font-family: 宋体;">支持标准如下：</span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">EJB </span>规范 <span lang="EN-US">3.0</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US"> JPA </span>规范<span lang="EN-US"> 1.0</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">JMS </span>规范<span lang="EN-US">1.1</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">JNDI </span>规范<span lang="EN-US">1.2</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">JDBC</span>规范<span lang="EN-US">3.0</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">JTA</span>规范<span lang="EN-US">1.1</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">Servlet</span>规范<span lang="EN-US">2.5</span></span></p>

<p class="MsoNormal" style="margin-left: 41.75pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">支持<span lang="EN-US">JSP</span>规范<span lang="EN-US">2.1</span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以从以下网站获得关于<span lang="EN-US">JFox</span>的更多信息。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">官方网站：<span lang="EN-US"><a href="http://www.jfox.org.cn/">http://www.jfox.org.cn</a></span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">社区网站：<span lang="EN-US"><a href="http://www.huihoo.org/jfox">http://www.huihoo.org/jfox</a></span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">项目网站：<span lang="EN-US"><a href="http://code.google.com/p/jfox">http://code.google.com/p/jfox</a></span></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h2><a name="_Toc171745373"><span lang="EN-US">2.1</span></a><span style="font-family: 宋体;">功能特性</span></h2>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3.0</span><span style="font-family: 宋体;">在以前版本的基础上进行较大的重构和改进，在尽可能兼容<span lang="EN-US">EJB 3</span>规范的同时，保持<span lang="EN-US">JFox</span>一直以来坚持轻量、简单、高效、实用的目标。</span></p>

<ol style="margin-top: 0cm;" start="1" type="1">
 <li class="MsoNormal"><span style="font-family: 宋体;">重新设计的<span lang="EN-US"> IoC </span>微内核，融入<span lang="EN-US"> OSGi </span>模块化思想</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">设计成嵌入式架构，能够和任何<span lang="EN-US"> Java Web Server</span>集成部署</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">支持<span lang="EN-US"> EJB3</span>，<span lang="EN-US">JPA</span>规范，支持容器内和容器外两种方式运行<span lang="EN-US">EJB</span>和<span lang="EN-US">JPA</span>组件</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">支持<span lang="EN-US">EJB</span>发布成<span lang="EN-US">Web Service</span></span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">采用<span lang="EN-US">JOTM(<a href="http://jotm.objectweb.org/">http://jotm.objectweb.org/</a>)</span>提供事务处理，支持两阶段提交<span lang="EN-US">(2PC)</span></span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">采用<span lang="EN-US"> XAPool(<a href="http://forge.objectweb.org/projects/xapool/">http://forge.objectweb.org/projects/xapool/</a>)
     </span>提供<span lang="EN-US"> XA DataSource</span>，支持智能连接池管理</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">内置<span lang="EN-US"> MVC </span>框架，实现自动<span lang="EN-US">Form Mapping,Validator,Uploading</span>等功能，支持<span lang="EN-US">JSP/Velocity/Freemarker</span>页面引擎，并支持直接在<span lang="EN-US">Action</span>中注入<span lang="EN-US">EJB</span></span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">支持多应用模块部署，让中大型应用充分享受模块化开发的带来的优势</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">提供<span lang="EN-US"> Manager </span>管理模块，可以查看和管理各种运行时参数</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">提供根据<span lang="EN-US"> JFox </span>特色重写的<span lang="EN-US"> Petstore </span>应用模块</span></li>
</ol>

<h2><a name="_Toc171745374"><span lang="EN-US">2.2 JFox</span></a><span style="font-family: 宋体;">在企业应用中的角色</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">经济的高速发展，信息系统间的孤立成了最大的绊脚石，对于任何一家企业，信息间缺少关联和通讯都在不时地阻碍企业的发展。解决这一难题的最佳方案就是中间件。<span lang="EN-US">JFox</span>是实现<span lang="EN-US">Java EE 5.0</span>规范的轻量级应用服务器，作为企业信息化的中间件平台，
它的应用范围非常广泛，包括电子政务、电子商务、电信、金融、环保、教育、<span lang="EN-US">ERP</span>、<span lang="EN-US"> CRM</span>、 人力资源管理等等与互联网相关的所有行业。<span lang="EN-US">JFox</span>作为企业信息化的核心基础平台，将在信息化进程中扮演重要的角色。如下图<span lang="EN-US">:</span></span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-family: 宋体;">图<span lang="EN-US"> JFox </span>企业应用系统架构</span></b></p>

<p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image001.jpg" border="0" height="338" width="518"></span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h1><a name="_Toc171745375"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">3. JFox</span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">安装与配置指南</span></h1>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">请按以下要求和步骤安装<span lang="EN-US">JFox 3.0</span>应用服务器。</span></p>

<h2><a name="_Toc171745376"><span lang="EN-US">3.1</span></a><span style="font-family: 宋体;">运行环境</span></h2>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><b><span style="font-family: 宋体;">表<span lang="EN-US">. 2-2 JFox </span>运行硬件环境最低配置</span></b></p>

<table class="MsoNormalTable" style="border: medium none ; margin-left: 21pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 140.35pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="187">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;" lang="EN-US">CPU</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 106.3pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="142">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">内存</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 120.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="161">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">硬盘</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 140.35pt;" valign="top" width="187">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">PIII 500 </span><span style="font-family: 宋体;">相当</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 106.3pt;" valign="top" width="142">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">128M</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 120.5pt;" valign="top" width="161">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">1G</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 140.35pt;" valign="top" width="187">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">SUN Ultra 10 </span><span style="font-family: 宋体;">相当</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 106.3pt;" valign="top" width="142">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">128M</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 120.5pt;" valign="top" width="161">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">1G</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><b><span style="font-family: 宋体;">表<span lang="EN-US">. 2-3 JFox JDK</span>支持版本列表</span></b></p>

<table class="MsoNormalTable" style="border: medium none ; margin-left: 21pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 144pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">供应商</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 225pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">版本号</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Sun Microsystems</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">5.0 </span><span style="font-family: 宋体;">或更高</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><b><span style="font-family: 宋体;">表<span lang="EN-US">. 2-4 JFox </span>支持操作系统列表</span></b></p>

<table class="MsoNormalTable" style="border: medium none ; margin-left: 21pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 144pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">供应商</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 225pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">名称<span lang="EN-US">+</span>版本号</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Red Hat</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">RedHat 7.2, 8.0, 9.0, Enterprise Server
  3.0</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Novell</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">SuSe 8.0, 9.0</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">GNU</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">Debian 3.0</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Sun Microsystems</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">Solaris 6, 8</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Microsoft</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">Windows 2000, 2000Server, 2003, XP</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-align: left;" align="left"><b><span style="font-family: 宋体;">表<span lang="EN-US">. 2-5 JFox</span>支持数据库列表</span></b></p>

<table class="MsoNormalTable" style="border: medium none ; margin-left: 21pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 144pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">供应商</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(230, 230, 230) none repeat scroll 0% 0%; width: 225pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-family: 宋体;">名称<span lang="EN-US">+</span>版本号</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">MySQL</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">MySQL 3.x, 4.x</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">PostgreSQL</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">PostgreSQL&nbsp; 7.x, 8.x</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">Oracle</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">Oracle 8, 9i, 10g</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">IBM</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">DB2 7.1, 7.2, 8.1</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">Microsoft</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">MS SQL Server 2000</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 144pt;" valign="top" width="192">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;" lang="EN-US">HSQL</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 225pt;" valign="top" width="300">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体; color: black;" lang="EN-US">HSQL 1.7.2</span></p>
  </td>
 </tr>
</tbody></table>

<h2><a name="_Toc171745377"><span lang="EN-US">3.2</span></a><span style="font-family: 宋体;">资源下载</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下载<span lang="EN-US">JDK</span>，<span lang="EN-US"><a href="http://java.sun.com/">http://java.sun.com</a></span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下载<span lang="EN-US">Tomcat</span>，<span lang="EN-US"><a href="http://tomcat.apache.org/">http://tomcat.apache.org</a></span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下载<span lang="EN-US">JFox3</span>，<span lang="EN-US"><a href="http://code.google.com/p/jfox/downloads/list">http://code.google.com/p/jfox/downloads/list</a></span></span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p style="margin-bottom: 0.0001pt; text-indent: 20pt;"><span style="font-family: 宋体;">如果需要获得<span lang="EN-US">JFox 3 </span>源码，请参考 <span lang="EN-US"><a href="http://code.google.com/p/jfox/source">http://code.google.com/p/jfox/source</a></span>。</span></p>

<h2><a name="_Toc171745378"><span lang="EN-US">3.3</span></a><span style="font-family: 宋体;">安装</span><span lang="EN-US">Tomcat</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">详细过程请参考<span lang="EN-US"> Tomat </span>安装指南，<span lang="EN-US"><a href="http://tomcat.apache.org/">http://<span style="font-size: 10pt;">tomcat</span><span style="font-size: 10pt;">.apache.org</span></a></span></span><span class="a"><span style="font-size: 10pt; font-family: 宋体;" lang="EN-US"> </span></span><span class="a"><span style="font-size: 10pt; font-family: 宋体;">。</span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">实际上，<span lang="EN-US">JFox 3</span>可以部署在任何<span lang="EN-US">Java EE Web</span>服务器上，但是没有特殊情况，我们仍然推荐采用<span lang="EN-US">Tomcat</span>作为<span lang="EN-US">Web</span>服务器。</span></p>

<h2><a name="_Toc171745379"><span style="font-family: 宋体;" lang="EN-US">3.4</span></a><span style="font-family: 宋体;">安装<span lang="EN-US">JFox</span></span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">假设下载的是<span lang="EN-US">JFox standalone</span>版本，即<span lang="EN-US">jfox.war</span>（如果下载的是<span lang="EN-US">jfox.war.20070520</span>这样的文件，请更名，去掉日期后缀）文件，请将下载的<span lang="EN-US">
jfox.war </span>拷贝到<span lang="EN-US"> %TOMCAT_HOME%/webapps </span>下，以便在<span lang="EN-US">Tomcat</span>启动时加载。<span lang="EN-US">JFox 3</span>应用服务器是设计成嵌入式的，作为一个标准的<span lang="EN-US">Web Application</span>部署在<span lang="EN-US">Tomcat</span>中。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">启动<span lang="EN-US">Tomcat</span>，默认配置下，使用浏览器访问 <span lang="EN-US"><a href="http://localhost:8080/jfox">http://localhost:8080/jfox</a></span>，如果看到<span lang="EN-US">JFox</span>欢迎页面，那么恭喜你，<span lang="EN-US">JFox</span>安装成功了。</span></p>

<h2><a name="_Toc171745380"><span style="font-family: 宋体;" lang="EN-US">3.5</span></a><span style="font-family: 宋体;">安装集成版</span></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">也可以下载已经集成了<span lang="EN-US">Tomat</span>的版本，如：<span lang="EN-US">”jfox-3.0-with-apache-tomcat-6.0.10.zip”</span>（如果下载的是<span lang="EN-US">jfox.war.20070520</span>这样的文件，请更名，去掉日期后缀）<span lang="EN-US"><a href="http://code.google.com/p/jfox/downloads/detail?name=jfox-3.0%20with%20apache-tomcat-6.0.10.zip&amp;can=2&amp;q="></a></span>，那么已经包含了<span lang="EN-US">Tomcat</span>和<span lang="EN-US">JFox</span>，解压之后，直接启动<span lang="EN-US">Tomcat</span>即可。实际上，这与手动将<span lang="EN-US">JFox</span>作为<span lang="EN-US">war</span>部署到<span lang="EN-US">Tomcat</span>中没有任何区别，<span lang="EN-US">JFox</span>并不需要对<span lang="EN-US">Tomcat</span>做特殊的配置，集成的版本只是让你的安装过程更简单而已。</span></p>

<h2><a name="_Toc171745381"><span style="font-family: 宋体;" lang="EN-US">3.6 JFox</span></a><span style="font-family: 宋体;">目录结构</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">作为<span lang="EN-US">Web Application</span>部署之后，和一般的<span lang="EN-US">Web Application</span>目录结构并没有太大的区别，目录结构如下图：</span></p>

<p class="MsoNormal" style="margin-left: 42pt;"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image002.jpg" border="0" height="325" width="138"></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">的目录分为两部分：</span></p>

<p class="MsoNormal" style="margin-left: 57pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">主程序，包含<span lang="EN-US">JFox Java EE</span>容器和<span lang="EN-US">MVC</span>框架；</span></p>

<p class="MsoNormal" style="margin-left: 57pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">应用模块，包含可以部署在<span lang="EN-US">JFox 3</span>的各个模块，如：<span lang="EN-US">manager, petstore</span>等。</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;">下面分别介绍。</span></p>

<h2><a name="_Toc171745382"><span style="font-family: 宋体;" lang="EN-US">3.7</span></a><span style="font-family: 宋体;">主程序结构</span></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">上图中，除</span><span lang="EN-US">jfox/WEB-INF/MODULES</span><span style="font-family: 宋体;">目录之外，所有内容都属于</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的主程序。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span lang="EN-US">JFox</span><span style="font-family: 宋体;">主程序结构和标准的</span><span lang="EN-US">Web Application</span><span style="font-family: 宋体;">没有任何的区别，</span><span lang="EN-US">WEB-INF</span><span style="font-family: 宋体;">外的部分存放了可通过</span><span lang="EN-US">Web</span><span style="font-family: 宋体;">访问的内容，</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的重要文件放在</span><span lang="EN-US">WEB-INF</span><span style="font-family: 宋体;">目录中。</span><span lang="EN-US">WEB-INF/web.xml</span><span style="font-family: 宋体;">配置了用来启动</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的重要参数，下一节将专门讲解；</span><span lang="EN-US">WEB-INF/lib</span><span style="font-family: 宋体;">下存放了所有</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的</span><span lang="EN-US">jar</span><span style="font-family: 宋体;">包；</span><span lang="EN-US">WEB-INF/classes</span><span style="font-family: 宋体;">下存放了</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">需要的配置文件：</span></p>

<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">来看一下</span><span lang="EN-US">WEB-INF/classes</span><span style="font-family: 宋体;">下的配置文件：</span></p>

<table class="MsoNormalTable" style="border: medium none ; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 137.65pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="184">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">目录名</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 136.85pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="182">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">作用</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 151.6pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="202">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">备注</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">META-INF/persistence.xml</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">JPA</span><span style="font-family: 宋体;">配置文件</span><span lang="EN-US"> </span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">用来配置数据源、以及</span><span lang="EN-US">Cache</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">详情参见：</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">配置章节</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">jndi.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span style="font-family: 宋体;">配置</span><span lang="EN-US">JNDI</span><span style="font-family: 宋体;">属性</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">一般无需修改配置。</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">注：</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">只支持</span><span lang="EN-US">local JNDI</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">global.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span style="font-family: 宋体;">用来配置全局占位符，以用于在</span><span lang="EN-US">@Constat</span><span style="font-family: 宋体;">注入外部变量</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">当前仅用来配置了</span><span lang="EN-US">Transaction Timeout</span><span style="font-family: 宋体;">。</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">如下：</span></p>
  <p class="MsoNormal"><span lang="EN-US">jta_transaction_timeout=60</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">详情可以参见：</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">内核</span><span lang="EN-US">-</span><span style="font-family: 宋体;">全局占位符章节</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">roles.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span style="font-family: 宋体;">使用</span><span lang="EN-US">EJB
  Security</span><span style="font-family: 宋体;">时，用来配置</span><span lang="EN-US">Application
  Role</span><span style="font-family: 宋体;">到</span><span lang="EN-US">EJB Role</span><span style="font-family: 宋体;">的映射关系</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">log4j.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">Log4J</span><span style="font-family: 宋体;">配置文件</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">jotm.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">JOTM</span><span style="font-family: 宋体;">配置文件</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">一般无需修改</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">carol.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">carol</span><span style="font-family: 宋体;">配置文件</span><span lang="EN-US"> </span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">一般无需修改</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">velocity.properties</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">Velocity</span><span style="font-family: 宋体;">配置文件</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">注意：默认采用的是</span><span lang="EN-US">UTF-8</span><span style="font-family: 宋体;">编码</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 137.65pt;" valign="top" width="184">
  <p class="MsoNormal"><span lang="EN-US">jaas.conf</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 136.85pt;" valign="top" width="182">
  <p class="MsoNormal"><span lang="EN-US">JAAS</span><span style="font-family: 宋体;">配置文件</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 151.6pt;" valign="top" width="202">
  <p class="MsoNormal"><span style="font-family: 宋体;">一般无需修改</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h2><a name="_Toc171745383"><span style="font-family: 宋体;" lang="EN-US">3.8 JFox</span></a><span style="font-family: 宋体;">模块结构</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">WEB-INF/MODULES</span><span style="font-family: 宋体;">是<span lang="EN-US">JFox</span>的一个重要目录，用来部署基于<span lang="EN-US">JFox</span>模块化规范开发的应用模块，这也是和一般的<span lang="EN-US">Web Application</span>的不同之处。默认可以看到<span lang="EN-US">MODULES</span>下有一个<span lang="EN-US">manager</span>目录或<span lang="EN-US">manager.zip</span>文件，这是<span lang="EN-US">JFox</span>内置的<span lang="EN-US">manager</span>模块，用来展示各种基于<span lang="EN-US">JFox</span>开发的样例程序，并提供管理控制台，通过<span lang="EN-US">manager</span>模块，现在就可以了解一下部署在<span lang="EN-US">JFox</span>之上的应用模块的结构</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">对部署之上的模块有一定的结构要求，就如同<span lang="EN-US">Web</span>服务器对<span lang="EN-US">war</span>包的结构有要求一样，只有提供了正确的结构，运行时<span lang="EN-US">JFox</span>才能正确加载。先提示一下，<span lang="EN-US">JFox</span>为每个模块提供独立的类加载器。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">关于<span lang="EN-US">JFox</span>应用模块的更多的介绍将在后面做详细讲解。</span></p>

<h2><a name="_Toc171745384"><span style="font-family: 宋体;" lang="EN-US">3.9 JFox</span></a><span style="font-family: 宋体;">配置</span></h2>

<p class="MsoNormal" style="text-align: left; text-indent: 21pt;" align="left"><span style="font-family: 宋体;">主要需要配置<span lang="EN-US">web.xml</span>和<span lang="EN-US">persistence.xml</span>文件。</span></p>

<h2><a name="_Toc171745385"><span style="font-family: 宋体;" lang="EN-US">3.10 web.xml</span></a><span style="font-family: 宋体;">配置</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3 Web application </span><span style="font-family: 宋体;">的配置文件，一般情况下，无需做修改。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的<span lang="EN-US">XML</span>片段配置了用于启动<span lang="EN-US">JFox</span>内核的<span lang="EN-US">Listener</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">listener</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">listener-class</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.mvc.WebContextLoader</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">listener-class</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">listener</span>&gt;</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的<span lang="EN-US">XML</span>片段配置了用来访问<span lang="EN-US">Web Service</span>的<span lang="EN-US">Servlet</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">xfire_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-class</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.webservice.xfire.JFoxXFireServlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-class</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">load-on-startup</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">1</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">load-on-startup</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">xfire_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/webservice/*</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">还有一些其它的配置，均与<span lang="EN-US">JFox MVC</span>相关，在<span lang="EN-US">JFox MVC</span>一章中讲述。</span></p>

<h2><a name="_Toc171745386"><span style="font-family: 宋体;" lang="EN-US">3.11</span></a><span style="font-family: 宋体;">数据源配置</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span lang="EN-US">JPA</span><span style="font-family: 宋体;">规范中，通过</span><span lang="EN-US">persistence.xml</span><span style="font-family: 宋体;">文件来配置存储单元，</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的数据源以及</span><span lang="EN-US">Persistence Cache</span><span style="font-family: 宋体;">也在这里配置，下面展示了</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">的</span><span lang="EN-US"> persistence.xml</span><span style="font-family: 宋体;">。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence-unit</span> <span style="color: blue;">name=</span><span style="color: green;">"default"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">jta-data-source</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java:/DefaultMySqlDS</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">jta-data-source</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"driver"</span> <span style="color: blue;">value=</span><span style="color: green;">"com.mysql.jdbc.Driver"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"url"</span> <span style="color: blue;">value=</span><span style="color: green;">"jdbc:mysql://localhost:3306/test"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"username"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"password"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"minSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- min pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"200"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"lifeTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"1800000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- 3h, connection max idle time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"sleepTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp; <i><span style="color: gray;">&lt;!--PoolKeeper sleep time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockRetryWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"2000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- retry time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockMaxWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"60000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max wait time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"checkLevelObject"</span> <span style="color: blue;">value=</span><span style="color: green;">"4"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- check connection closed --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.algorithm"</span> <span style="color: blue;">value=</span><span style="color: green;">"LRU"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- algorithm for "default" cache category, LRU, LFU, FIFO--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.ttl"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- ttl for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxIdleTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"300000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- maxidletime for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max size for "default" --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxMemorySize"</span> <span style="color: blue;">value=</span><span style="color: green;">"100000000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max memory size for "default", in bytes--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence-unit</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence</span>&gt;</span></pre></div>

<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">详细的说明如下：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Courier New&quot;; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<b><span style="color: navy;">persistence-unit</span></b> <b><span style="color: blue;">name=</span><span style="color: green;">"default"</span></b>&gt; </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">指明了</span><span lang="EN-US">persistence unit</span><span style="font-family: 宋体;">名称，</span><span lang="EN-US">unit</span><span style="font-family: 宋体;">是</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">的概念，表示一个存储单元，</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">的</span><span lang="EN-US">EntityManager</span><span style="font-family: 宋体;">都关于在存储单元上。使用</span><span lang="EN-US"> @PersistenceContext
</span><span style="font-family: 宋体;">注入</span><span lang="EN-US">EntityManager</span><span style="font-family: 宋体;">时，可以通过</span><span lang="EN-US"> unitName </span><span style="font-family: 宋体;">指定使用的</span><span lang="EN-US"> unit</span><span style="font-family: 宋体;">，如果不指明，则会使用默认的</span><span lang="EN-US">persistence unit</span><span style="font-family: 宋体;">，前提是只有一个</span><span lang="EN-US">unit</span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<b><span style="color: navy;">jta-data-source</span></b>&gt;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java:/DefaultMySqlDS</span></b><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<b><span style="color: navy;">jta-data-source</span></b>&gt;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">指明绑定的数据源</span><span lang="EN-US">JNDI</span><span style="font-family: 宋体;">的名称，</span><span lang="EN-US">JFox
JPA</span><span style="font-family: 宋体;">创建了数据源之后，将使用该名称将其绑定到</span><span lang="EN-US">JNDI</span><span style="font-family: 宋体;">上。</span></p>

<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">通过</span><span lang="EN-US">properties</span><span style="font-family: 宋体;">可以指定各种参数，这些参数是与特定的应用服务器相关的，</span><span lang="EN-US">JFox </span><span style="font-family: 宋体;">使用的</span><span lang="EN-US">property
</span><span style="font-family: 宋体;">说明如下：</span></p>

<table class="MsoNormalTable" style="border: medium none ; width: 427.25pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0" width="570">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 125.3pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="167">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">名称</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 96.1pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="128">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">意义</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(217, 217, 217) none repeat scroll 0% 0%; width: 205.85pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="274">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">备注</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">driver</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">数据库驱动</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">需要将数据库驱动程序拷贝到</span><span lang="EN-US">WEB-INF/lib</span><span style="font-family: 宋体;">目录中或者</span><span lang="EN-US">Web Server</span><span style="font-family: 宋体;">的</span><span lang="EN-US">lib</span><span style="font-family: 宋体;">中</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">url</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">数据库连接的</span><span lang="EN-US">url</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">username</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">用户名</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">password</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">密码</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">minSize</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">最小连接数</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">维持的最小的数据库连接数目，即使空闲也不会被释放</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">maxSize</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">最大连接数</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果实际连接数达到</span><span lang="EN-US">maxSize</span><span style="font-family: 宋体;">，发生新的连接时，将尝试等待有连接释放，直至超时</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">lifeTime</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">连接保持时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果一个连接已经从创建到当前已经超过</span><span lang="EN-US">lifeTime</span><span style="font-family: 宋体;">时间，将会被断开以便重连</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">sleepTime</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">连接空闲时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果一个连接处于空闲，超过</span><span lang="EN-US">sleepTime</span><span style="font-family: 宋体;">时间之后，将会被释放</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">deadLockRetryTime</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">重连的等待时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果连接已满，重连之前的等待时间</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">deadLockMaxWait</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">最大重试时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果连接已满，在重试超过该时间之后，如果仍未连接成功，讲抛出连接失败异常</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">checkObjectLevel</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">是否检查连接有效</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">设置是否每次获得连接之后，是否对连接进行有效性检查。如果数据库会出现重启现象，则必须设置有效值，否则只有重启应用服务器才能重新获得有效连接。</span></p>
  <p class="MsoNormal"><span lang="EN-US">4</span><span style="font-family: 宋体;">为总是检查。</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">cache.algorithm</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span lang="EN-US">Cache</span><span style="font-family: 宋体;">清除策略的算法</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span lang="EN-US">LRU</span><span style="font-family: 宋体;">为最近最少使用；</span></p>
  <p class="MsoNormal"><span lang="EN-US">LFU</span><span style="font-family: 宋体;">为最近最常使用；</span></p>
  <p class="MsoNormal"><span lang="EN-US">FIFO</span><span style="font-family: 宋体;">为先进先出；</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">一般配置为</span><span lang="EN-US">LRU</span><span style="font-family: 宋体;">。</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">cache.ttl</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span lang="EN-US">cache</span><span style="font-family: 宋体;">数据的最大生存时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">从创建到当前时间，超过最大生存时间的数据，将会被清除</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">cache.maxIdleTime</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span style="font-family: 宋体;">最大空闲时间</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">空闲超过该时间的</span><span lang="EN-US">cache</span><span style="font-family: 宋体;">数据将被清除</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">cache.maxSize</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span lang="EN-US">cache</span><span style="font-family: 宋体;">的最大尺寸</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果</span><span lang="EN-US">cache</span><span style="font-family: 宋体;">中的数据的条目已经达到该值，且均有效时，新的数据将不被缓存</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 125.3pt;" valign="top" width="167">
  <p class="MsoNormal"><span lang="EN-US">cache.maxMemory</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 96.1pt;" valign="top" width="128">
  <p class="MsoNormal"><span lang="EN-US">Cache</span><span style="font-family: 宋体;">使用的最大内存数</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 205.85pt;" valign="top" width="274">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果</span><span lang="EN-US">cache</span><span style="font-family: 宋体;">的数据的体积已经达到最大可用内存数且均有效时，新的数据将不会被缓存</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-align: left; text-indent: 21pt;" align="left"><span style="font-family: 宋体;">请保证</span><span lang="EN-US"> url</span><span style="font-family: 宋体;">、</span><span lang="EN-US">username</span><span style="font-family: 宋体;">、</span><span lang="EN-US">password&nbsp;</span><span style="font-family: 宋体;">的设置是正确的，否则将无法成功连接数据库，关于</span><span lang="EN-US">cache</span><span style="font-family: 宋体;">的更多内容可以参考后面“</span><span lang="EN-US">JPA Container</span><span style="font-family: 宋体;">”章节。</span></p>

<h1><a name="_Toc171745387"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">4</span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">第一个<span lang="EN-US">EJB</span>应用</span></h1>

<p class="MsoNormal" style="text-indent: 9pt;"><span style="font-family: 宋体;">接下来，我们看一下如何编写<span lang="EN-US">EJB</span>组件，旨在让大家对基于<span lang="EN-US">JFox</span>开发<span lang="EN-US">EJB</span>有个初步的了解，更多关于<span lang="EN-US">EJB</span>组件的内容可以参考相关书籍和资料。</span></p>

<h2><a name="_Toc171745388"><span lang="EN-US">4.1</span></a><span style="font-family: 宋体;">第一个</span><span lang="EN-US">Session Bean</span></h2>

<p class="MsoNormal" style="text-indent: 9pt;"><span style="font-family: 宋体;">编写<span lang="EN-US"> EJB </span>接口：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.stateless;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* Calculator EJB interface</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> Calculator {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> add(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> subtract(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">编写</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">实现</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> jfox.test.ejb3.stateless;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* Calculator EJB Bean</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">name = <span style="color: blue;">"stateless.CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CalculatorBean <b><span style="color: navy;">implements</span></b> Calculator {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> add(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x + y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> subtract(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x - y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">编写用于测试的<span lang="EN-US">EJB Client</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.stateless;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.util.Hashtable;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.naming.Context;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.naming.InitialContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.Framework;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.ejb3.naming.InitialContextFactoryImpl;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.ejb3.naming.url.javaURLContextFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> TestMain {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">void</span></b> main(String[] args) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// start Framework</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework framework = <b><span style="color: navy;">new</span></b> Framework();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;framework.start();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// initialize JNDI</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtable&lt;String, String&gt; prop = <b><span style="color: navy;">new</span></b> Hashtable&lt;String, String&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">INITIAL_CONTEXT_FACTORY,</span></i></b> InitialContextFactoryImpl.<b><span style="color: navy;">class</span></b>.getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">OBJECT_FACTORIES,</span></i></b> InitialContextFactoryImpl.<b><span style="color: navy;">class</span></b>.getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">URL_PKG_PREFIXES,</span></i></b> javaURLContextFactory.<b><span style="color: navy;">class</span></b>.getPackage().getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">PROVIDER_URL,</span></i></b> <span style="color: blue;">"java://localhost"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context context = <b><span style="color: navy;">new</span></b> InitialContext(prop);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// lookup calculator then invoke add method</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculator calculator = (Calculator)context.lookup(<span style="color: blue;">"stateless.CalculatorBean/remote"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> result = calculator.add(<span style="color: blue;">99</span>,<span style="color: blue;">1</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"invoke calculator: 99+1="</span> + result);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// stop Framework</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.<i>sleep(</i><span style="color: blue;">2000</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;framework.stop();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">将<span lang="EN-US">JFox </span>的<span lang="EN-US">WEB-INF/lib/*.jar</span>和<span lang="EN-US">WEB-INF/classes</span>加入到执行时的<span lang="EN-US">classpath</span>中，执行<span lang="EN-US">TestMain</span>，将会看到如下输出：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">invoke calculator: 99+1=100</span></p>

<h2><a name="_Toc171745389"><span lang="EN-US">4.2</span></a><span style="font-family: 宋体;">第一个</span><span lang="EN-US">Entity Bean</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">EJB3</span>中，<span lang="EN-US">Entity Bean</span>已经独立出来，形成了<span lang="EN-US">JPA</span>规范，编写<span lang="EN-US">JPA Entity</span>已经不再像从前那么复杂。首先用<span lang="EN-US">@Entity</span>描述在类上，指明这是一个<span lang="EN-US">JPA Entity</span>类，然后用<span lang="EN-US">@Column</span>描述在<span lang="EN-US">Field</span>上，指明对应的数据库表的字段。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;">代码如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.jpa;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.persistence.Column;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.persistence.Entity;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Entity</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> Address {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_ID"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">long</span></b> <b><span style="color: rgb(102, 14, 122);">id;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_ACC_ID"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">long</span></b> <b><span style="color: rgb(102, 14, 122);">accountId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_DESCRIPTION"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">description;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_STREET"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 <span style="background: white none repeat scroll 0% 0%; color: windowtext; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">&nbsp;&nbsp;&nbsp;&nbsp;String </span><b><span style="background: white none repeat scroll 0% 0%; color: rgb(102, 14, 122); -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">street</span></b><b><span style="background: white none repeat scroll 0% 0%; color: rgb(102, 14, 122); -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_CITY"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">city;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_PROVINCE"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">province;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ADR_POSTAL_CODE"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">postalCode;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 32 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;33 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">long</span></b> getId() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">id;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 37 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setId(<b><span style="color: navy;">long</span></b> id) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">id </span></b>= id;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 41 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getDescription() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">description;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 45 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setDescription(String description) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">description </span></b>= description;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 49 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getCity() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">city;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 53 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;54 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setCity(String city) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 55 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">city </span></b>= city;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 56 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 57 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;58 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">long</span></b> getAccountId() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 59 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">accountId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 60 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 61 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;62 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setAccountId(<b><span style="color: navy;">long</span></b> accountId) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 63 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">accountId </span></b>= accountId;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 64 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 65 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;66 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getPostalCode() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 67 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">postalCode;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 68 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 69 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;70 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setPostalCode(String postalCode) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 71 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">postalCode </span></b>= postalCode;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 72 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 73 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;74 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getProvince() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 75 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">province;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 76 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 77 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;78 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setProvince(String province) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 79 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">province </span></b>= province;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 80 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 81 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;82 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getStreet() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 83 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">street;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 84 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 85 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;86 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setStreet(String street) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 87 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">street </span></b>= street;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 88 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 89 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;90 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String toString() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 91 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <span style="color: blue;">"Address{"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 92 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"id="</span> + <b><span style="color: rgb(102, 14, 122);">id </span></b>+</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 93 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", accountId="</span> + <b><span style="color: rgb(102, 14, 122);">accountId </span></b>+</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 94 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", city='"</span> + <b><span style="color: rgb(102, 14, 122);">city </span></b>+ <span style="color: blue;">'</span><b><span style="color: navy;">\'</span></b><span style="color: blue;">'</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 95 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", street='"</span> + <b><span style="color: rgb(102, 14, 122);">street </span></b>+ <span style="color: blue;">'</span><b><span style="color: navy;">\'</span></b><span style="color: blue;">'</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">96 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", postalCode='"</span> + <b><span style="color: rgb(102, 14, 122);">postalCode </span></b>+ <span style="color: blue;">'</span><b><span style="color: navy;">\'</span></b><span style="color: blue;">'</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 97 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", province='"</span> + <b><span style="color: rgb(102, 14, 122);">province </span></b>+ <span style="color: blue;">'</span><b><span style="color: navy;">\'</span></b><span style="color: blue;">'</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 98 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">", description='"</span> + <b><span style="color: rgb(102, 14, 122);">description </span></b>+ <span style="color: blue;">'</span><b><span style="color: navy;">\'</span></b><span style="color: blue;">'</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">99 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">'}'</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">100 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">101 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">102 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">编写<span lang="EN-US">Client</span>，下面的代码示范了如何独立执行<span lang="EN-US">JPA</span>，产品开发中，可以使用<span lang="EN-US">@PersistenceContext</span>直接注入<span lang="EN-US">EntityManager</span>，可以参考<span lang="EN-US">JFox</span>提供了<span lang="EN-US">perstore</span>模块。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.jpa;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.persistence.EntityManager;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.persistence.Persistence;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.persistence.EntityManagerFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> AddressTestMain {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">void</span></b> main(String[] args) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// initialize EntityManager by persistence unit</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EntityManagerFactory emFactory = Persistence.<i>createEntityManagerFactory(</i><span style="color: blue;">"default"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">final</span></b> EntityManager em = emFactory.createEntityManager();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// query</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Address address = (Address)em.createNativeQuery(<span style="color: blue;">"select * from address where ADR_ID = $id"</span>, Address.<b><span style="color: navy;">class</span></b>).setParameter(<span style="color: blue;">"id"</span>,<span style="color: blue;">1</span>).getSingleResult();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"Address: "</span> + address);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// close EntityManager, EntityManagerFactory</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;em.close();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emFactory.close();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">同样加入<span lang="EN-US">JFox </span>的<span lang="EN-US">WEB-INF/lib/*.jar</span>和<span lang="EN-US">WEB-INF/classes</span>加入到执行时的<span lang="EN-US">classpath</span>中，执行<span lang="EN-US">AddressTestMain</span>，成功则会打印出<span lang="EN-US">Address</span>结果，应该类似如下：</span></p>

<p class="MsoNormal"><span style="font-size: 9pt; font-family: 宋体;" lang="EN-US">Address:
Address{id=1, accountId=1, city='Edmonton', street='434 Edward St.',
postalCode='L5G 2P9', province='Alberta', description='Fake'}</span></p>

<p class="MsoNormal"><span style="font-size: 9pt; font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-size: 9pt; font-family: 宋体;">注意：需要建立<span lang="EN-US">ADDRESS</span>数据库表以及在<span lang="EN-US">META-INF/persistence.xml</span>中正确的配置数据源才能正确执行成功，下面是创建数据库的<span lang="EN-US">MySQL</span>脚本，以及<span lang="EN-US">persistence.xml</span>中<span lang="EN-US">persistence unit</span>配置。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">CREATE TABLE ACCOUNT (</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ACC_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTEGER NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ACC_FIRST_NAME&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ACC_LAST_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ACC_EMAIL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32),</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;PRIMARY KEY (ACC_ID)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">CREATE TABLE ADDRESS (</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTEGER NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_ACC_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTEGER NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_DESCRIPTION&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_STREET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_CITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_PROVINCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;ADR_POSTAL_CODE&nbsp;&nbsp;&nbsp; VARCHAR(32) NOT NULL,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;PRIMARY KEY (ADR_ID)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ACCOUNT VALUES(1,'Clinton', 'Begin', 'clinton.begin@ibatis.com');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ACCOUNT VALUES(2,'Jim', 'Smith', 'jim.smith@somewhere.com');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ACCOUNT VALUES(3,'Elizabeth', 'Jones', null);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ACCOUNT VALUES(4,'Bob', 'Jackson', 'bob.jackson@somewhere.com');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ACCOUNT VALUES(5,'Amanda', 'Goodman', null);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ADDRESS VALUES(1, 1, 'Fake', '434 Edward St.', 'Edmonton', 'Alberta', 'L5G 2P9');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ADDRESS VALUES(2, 2, 'Fake', '652 John St.', 'Vancouver', 'British Columbia', 'B42 4W2');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ADDRESS VALUES(3, 3, 'Fake', '863 William St.', 'Regina', 'Saskatchewan', 'J9K 4L6');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ADDRESS VALUES(4, 4, 'Fake', '237 Arthur St.', 'Winnipeg', 'Manitoba', 'P4G 2D3');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">INSERT INTO ADDRESS VALUES(5, 5, 'Fake', '989 Memorial St.', 'Toronto', 'Ontario', 'Q5J 4F4');</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-size: 9pt; font-family: 宋体;" lang="EN-US">persistence.xml</span><span style="font-size: 9pt; font-family: 宋体;">配置：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence-unit</span> <span style="color: blue;">name=</span><span style="color: green;">"DefaultHsqlDS"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">jta-data-source</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java:/DefaultHsqlDS</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">jta-data-source</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"driver"</span> <span style="color: blue;">value=</span><span style="color: green;">"com.mysql.jdbc.Driver"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"url"</span> <span style="color: blue;">value=</span><span style="color: green;">"jdbc:mysql://localhost:3306/test"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"username"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"password"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence-unit</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-size: 9pt; font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h2><a name="_Toc171745390"><span style="font-family: 宋体;" lang="EN-US">4.3</span></a><span style="font-family: 宋体;">第一个<span lang="EN-US">Message Driven Bean</span></span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">编写<span lang="EN-US">MDB(Message Driven Bean)</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.mdb;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.ActivationConfigProperty;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.MessageDriven;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.jms.MessageListener;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.jms.Message;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:yang_y@sysnet.com.cn"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@MessageDriven(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">activationConfig =</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActivationConfigProperty(</span>propertyName=<span style="color: blue;">"destinationType"</span>, propertyValue=<span style="color: blue;">"javax.jms.Queue"</span>),</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActivationConfigProperty(</span>propertyName=<span style="color: blue;">"destination"</span>, propertyValue=<span style="color: blue;">"testQ"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> QueueMDB <b><span style="color: navy;">implements</span></b> MessageListener {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> onMessage(Message recvMsg) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"Received message: "</span> + recvMsg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">MDB</span><span style="font-family: 宋体;">必须实现<span lang="EN-US">javax.jms.MessageListener</span>接口，并且使用<span lang="EN-US">@MessageDriven</span>来描述，并申明两个<span lang="EN-US">ActivationConfigProperty</span>，一个为<span lang="EN-US">destinationType</span>指定地址类型（<span lang="EN-US">javax.jms.Queue</span>或者<span lang="EN-US">javax.jms.Topic</span>），另一个为<span lang="EN-US">destination</span>，指定地址名称。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">编写<span lang="EN-US">Client</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.mdb;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.util.Hashtable;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.naming.Context;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.naming.InitialContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.jms.QueueConnectionFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.jms.QueueConnection;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.jms.QueueSession;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.Session;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.Queue;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.QueueSender;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.framework.Framework;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.ejb3.naming.InitialContextFactoryImpl;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.ejb3.naming.url.javaURLContextFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> MDBClient {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">void</span></b> main(String[] args) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// start Framework</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework framework = <b><span style="color: navy;">new</span></b> Framework();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;framework.start();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// initialize JNDI</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hashtable&lt;String, String&gt; prop = <b><span style="color: navy;">new</span></b> Hashtable&lt;String, String&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">INITIAL_CONTEXT_FACTORY,</span></i></b> InitialContextFactoryImpl.<b><span style="color: navy;">class</span></b>.getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">OBJECT_FACTORIES,</span></i></b> InitialContextFactoryImpl.<b><span style="color: navy;">class</span></b>.getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">URL_PKG_PREFIXES,</span></i></b> javaURLContextFactory.<b><span style="color: navy;">class</span></b>.getPackage().getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop.put(Context.<b><i><span style="color: rgb(102, 14, 122);">PROVIDER_URL,</span></i></b> <span style="color: blue;">"java://localhost"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context context = <b><span style="color: navy;">new</span></b> InitialContext(prop);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueConnectionFactory connectionFactory = (QueueConnectionFactory)context.lookup(<span style="color: blue;">"defaultcf"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueConnection connection = connectionFactory.createQueueConnection();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueSession session = connection.createQueueSession(<b><span style="color: navy;">false</span></b>, Session.<b><i><span style="color: rgb(102, 14, 122);">AUTO_ACKNOWLEDGE)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Queue queue = session.createQueue(<span style="color: blue;">"testQ"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="DE">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="DE">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueSender sender = session.createSender(queue);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender.send(session.createTextMessage(<span style="color: blue;">"Hello, JMS! "</span> + System.<i>currentTimeMillis(</i>)));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.close();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// stop Framework</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.<i>sleep(</i><span style="color: blue;">2000</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;framework.stop();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">同样加入<span lang="EN-US">JFox </span>的<span lang="EN-US">WEB-INF/lib/*.jar</span>和<span lang="EN-US">WEB-INF/classes</span>加入到执行时的<span lang="EN-US">classpath</span>中，执行<span lang="EN-US">MDBClient</span>，成功则会打印出如下结果： </span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Received message:
TextMessage {body=Hello, JMS! 1178634259625}</span></p>

<h2><a name="_Toc171745391"><span style="font-family: 宋体;" lang="EN-US">4.4</span></a><span style="font-family: 宋体;">容器外运行与容器内运行</span></h2>

<p class="MsoNormal" style="text-indent: 18pt;"><span lang="EN-US">JFox</span><span style="font-family: 宋体;">能完全支持容器外和容器内两种方式运行</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">和</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">组件，这得益于</span><span lang="EN-US">EJB3</span><span style="font-family: 宋体;">组件的轻量化设计以及</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">容器的轻量和可嵌入式设计。</span></p>

<h3><a name="_Toc171745392"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">4.4.1</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;">容器外运行</span></h3>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;">要在容器外运行</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">，首先需要将</span><span lang="EN-US">WEB-INF/lib/*.jar</span><span style="font-family: 宋体;">和</span><span lang="EN-US">WEB-INF/classes</span><span style="font-family: 宋体;">目录加到运行时的</span><span lang="EN-US">classpath</span><span style="font-family: 宋体;">中。注：以上的例子均为容器外方式运行。</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span lang="EN-US">EJB</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;">要运行</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">，首先使用如下代码启动</span><span lang="EN-US">Framework</span><span style="font-family: 宋体;">即可；</span></p>

<div style="border: 1pt solid black; padding: 3pt 3pt 3pt 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Arial Narrow&quot;,&quot;sans-serif&quot;; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Framework framework = <b><span style="color: navy;">new</span></b> Framework();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Arial Narrow&quot;,&quot;sans-serif&quot;; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">framework.start();</span></pre></div>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US">Framework</span><span style="font-family: 宋体;">启动时，会自动加载所有的</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">和</span><span lang="EN-US">JPA Entity</span><span style="font-family: 宋体;">，启动之后，即可以通过</span><span lang="EN-US">JNDI lookup </span><span style="font-family: 宋体;">得到</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">并发起调用。</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;">执行完毕之后，可以调用</span><span lang="EN-US">Framework.stop()</span><span style="font-family: 宋体;">方法正常中止</span><span lang="EN-US">JFox</span><span style="font-family: 宋体;">进程。</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span lang="EN-US">JPA</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;">容器外运行</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">，则可以通过如下方式创建</span><span lang="EN-US">EntityManager</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Arial Narrow&quot;,&quot;sans-serif&quot;; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">EntityManagerFactory emFactory = Persistence.<i>createEntityManagerFactory(</i><span style="color: blue;">"default"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Arial Narrow&quot;,&quot;sans-serif&quot;; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">final</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: &quot;Arial Narrow&quot;,&quot;sans-serif&quot;; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> EntityManager em = emFactory.createEntityManager();</span></pre></div>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;">创建</span><span lang="EN-US">EntityManagerFactory</span><span style="font-family: 宋体;">的时候，会自动加载</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">的</span><span lang="EN-US">Entity</span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;">然后便可以通过</span><span lang="EN-US">EntityManager</span><span style="font-family: 宋体;">发起各种持久化调用。</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;">因为这种方式执行</span><span lang="EN-US">EJB</span><span style="font-family: 宋体;">和</span><span lang="EN-US">JPA</span><span style="font-family: 宋体;">更加轻量，所以建议在进行单元测试的时候，使用该方式，但是该方式无法提供远程访问能力。</span></p>

<h3><a name="_Toc171745393"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">4.4.2</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;">容器内运行</span></h3>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;">要想容器运行，首先需要将<span lang="EN-US">JFox</span>以<span lang="EN-US">Webapp</span>方式部署到<span lang="EN-US">Tomcat</span>容器中，并将你的应用打成<span lang="EN-US">jar</span>包，可以发布至<span lang="EN-US">WEB-INF/lib</span>下，<span lang="EN-US">JFox</span>提供了更好的以模块的形式来发布你的应用，关于模块的更多内容可以参考<span lang="EN-US">5.4JFox
Module</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Tomcat</span><span style="font-family: 宋体;">启动时，会自动启动<span lang="EN-US">JFox</span>的<span lang="EN-US">EJB</span>容器，并发布你的应用；可以通过查看日志或者使用管理控制台来检查你的<span lang="EN-US">EJB/JPA</span>组件是否发布成功。</span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;">需要注意的是，即时在该方式下，<span lang="EN-US">JFox</span>也不没有启动任何端口，所以也无法直接提供远程连接服务。从<span lang="EN-US">JSP/Servlet</span>访问<span lang="EN-US">EJB</span>时，这不会有问题；而如果你需要远程访问<span lang="EN-US">EJB</span>，比如：使用独立发布的<span lang="EN-US">Client Application</span>，则需要将<span lang="EN-US">EJB</span>发布成<span lang="EN-US">Web Service</span>，通过<span lang="EN-US">Web Service</span>来远程访问<span lang="EN-US">EJB</span>。关于<span lang="EN-US">Web Service</span>的更多内容，可以参考<span lang="EN-US">“JFox</span>体系结构<span lang="EN-US">”</span>中的<span lang="EN-US">Web
Service</span>章节。</span></p>

<h1><a name="_Toc171745394"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">5 JFox</span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">体系结构</span></h1>

<p class="MsoNormal" style="margin-left: 10.5pt; text-indent: 10.5pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">应用服务器一共包含了<span lang="EN-US">3</span>个部分，基于<span lang="EN-US">IoC</span>的微内核、<span lang="EN-US">Java
EE</span>容器和<span lang="EN-US">MVC</span>框架，整体架构如下图所示：</span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image003.jpg" border="0" height="377" width="479"></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MMTopic2"><a name="_Toc171745395"><span style="font-family: 宋体;" lang="EN-US">5.1 JFox Java EE</span></a><span style="font-family: 宋体;">容器</span><span style="font-family: 宋体;" lang="EN-US"> </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3</span><span style="font-family: 宋体;">提供支持<span lang="EN-US">EJB3</span>和<span lang="EN-US">JPA</span>组件的<span lang="EN-US">Java EE</span>容器，包括服务组件有：<span lang="EN-US">JNDI</span>，<span lang="EN-US">EJB Container</span>，<span lang="EN-US">JTA
Transaction Manager</span>，<span lang="EN-US">JMS Message Service</span>，<span lang="EN-US">JPA Container</span>，<span lang="EN-US">DataSource</span>。</span></p>

<h3><a name="_Toc171745396"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">5.1.1</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US"> JNDI</span></h3>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; JNDI(Java
Name and Directory Interface)</span><span style="font-family: 宋体;">是<span lang="EN-US">Java EE</span>应用服务器的基础服务，用来定位应用服务器中的各种资源和组件。<span lang="EN-US">EJB 3</span>中，大多数时候，总能通过依赖注入来获得资源，<span lang="EN-US">JNDI</span>的使用变得很透明，但是有时候，也需要通过<span lang="EN-US">JNDI</span>来获取。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要使用<span lang="EN-US"> JFox </span>的<span lang="EN-US">JNDI</span>，需要先设置好<span lang="EN-US">jndi.properties</span>配置文件，或者初始化<span lang="EN-US">JNDI</span>上下文时，即<span lang="EN-US">new InitialContext(Properties
prop)</span>的时候传入正确的<span lang="EN-US">Properties</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">你可以在<span lang="EN-US">WEB-INF/classes</span>下找到<span lang="EN-US">jndi.properties</span>，它的配置如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java.naming.factory.initial</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<span style="color: green;">org.jfox.ejb3.naming.InitialContextFactoryImpl</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java.naming.factory.object</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<span style="color: green;">org.jfox.ejb3.naming.InitialContextFactoryImpl</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java.naming.provider.url</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<span style="color: green;">java://localhost</span></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">也可以使用<span lang="EN-US">JFox</span>提供<span lang="EN-US">JNDIContextHelper.getInitalContext()</span>来直接获得<span lang="EN-US"> InitialContext</span>，<span lang="EN-US">JNDIContextHelper</span>全名为：<span lang="EN-US">org.jfox.ejb3.naming.JNDIContextHelper</span>，在构造<span lang="EN-US">InitialContext</span>时，已经传入了正确的参数。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">部署的<span lang="EN-US">EJB</span>的<span lang="EN-US">JNDI</span>名称由两部分组成：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@Stateless/@Stateful</span><span style="font-family: 宋体;">标注时指定的<span lang="EN-US"> name</span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">如果是<span lang="EN-US">@Remote</span>，加上<span lang="EN-US">“/remote”</span>，如果是<span lang="EN-US">@Local</span>，则加上<span lang="EN-US"> “/local”</span></span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">EJB3</span>中，需要注意相对<span lang="EN-US">EJB2 JNDI</span>的变化，<span lang="EN-US">EJB3</span>直接将<span lang="EN-US">EJB</span>的存根绑定在了<span lang="EN-US">JNDI</span>中，而不是<span lang="EN-US">EJB2</span>的<span lang="EN-US">EJBHome</span>的存根，这使得之前传统的<span lang="EN-US">ServiceLocator</span>模式也可能需要改进，尤其是对于<span lang="EN-US">Stateful Sesion
Bean</span>，不能再使用<span lang="EN-US">ServiceLocator</span>中缓存<span lang="EN-US">JNDI
lookup</span>得到的存根，如果这样的话，所有的会话都将调用同一个<span lang="EN-US">Stateful Session Bean</span>的实例。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">另外，需要格外注意的是，<span lang="EN-US">JFox</span>的<span lang="EN-US">JNDI</span>不具备远程访问能力，仅支持<span lang="EN-US">Local</span>访问，也就是说，你不能在除<span lang="EN-US">JFox</span>的<span lang="EN-US">JVM</span>之外使用<span lang="EN-US">JNDI</span>，这样做，一方面是为了安全，另一方面大多数应用都在使用<span lang="EN-US">Local</span>方式来访问<span lang="EN-US">EJB</span>，还有就是更推荐采用<span lang="EN-US">Web Service</span>来实现远程访问。所以，如果你需要远程访问<span lang="EN-US">EJB</span>，那么更好的做法是将你的<span lang="EN-US">EJB</span>发布成<span lang="EN-US">Web Service</span>，你的<span lang="EN-US">Client</span>通过<span lang="EN-US">Web Service </span>来实现远程访问，后面有例子会告诉你通过<span lang="EN-US">Web Service</span>来访问你的<span lang="EN-US">EJB</span>服务会是多么的简单。</span></p>

<h3><a name="_Toc171745397"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">5.1.2</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US"> EJB3
Container</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">的<span lang="EN-US">EJB3</span>容器支持<span lang="EN-US">Stateless</span>、<span lang="EN-US">Stateful
SessionBean</span>和<span lang="EN-US">Message Driven Bean</span>，为了保持容器的简单性，并不兼容<span lang="EN-US">EJB2</span>容器，如果需要<span lang="EN-US">EJB2</span>容器，请选择<span lang="EN-US">JFox 2.x</span>的版本，但是更建议你升级你的应用至符合<span lang="EN-US">EJB 3</span>规范。</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;">依赖注入</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">支持依赖注入是<span lang="EN-US">EJB3</span>规范的重要改进，<span lang="EN-US">JFox EJB3</span>容器使用<span lang="EN-US">JDK 5</span>的<span lang="EN-US">Annotation</span>来标注依赖，支持使用<span lang="EN-US">@EJB, @Resource</span>等在<span lang="EN-US">EJB</span>中注入依赖的资源。可以参考<span lang="EN-US">JFox</span>测试用例<span lang="EN-US">jfox.test.ejb3.injection</span>来了解依赖注入的使用，更多的关于依赖注入的知识请参考<span lang="EN-US">EJB3</span>规范。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">下面是一些使用依赖注入的示例代码：</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; 1.</span><span style="font-family: 宋体;">注入<span lang="EN-US">EJB</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB(</span>beanName = <span style="color: blue;">"injection.CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> Calculator <b><span style="color: rgb(102, 14, 122);">calculator;</span></b></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; 2.</span><span style="font-family: 宋体;">注入<span lang="EN-US">SessionContext</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">SessionContext <b><span style="color: rgb(102, 14, 122);">sessionContext;</span></b></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; 3.</span><span style="font-family: 宋体;">注入<span lang="EN-US">TimerService</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">TimerService <b><span style="color: rgb(102, 14, 122);">timerService;</span></b></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; 4.</span><span style="font-family: 宋体;">注入<span lang="EN-US">EntityManager</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@PersistenceContext(</span>unitName = <span style="color: blue;">"JPetstoreMysqlDS"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;EntityManager <b><span style="color: rgb(102, 14, 122);">em;</span></b></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="FR">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="FR">Interceptors</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">JFox 3 </span><span style="font-family: 宋体;">支持</span><span style="font-family: 宋体;" lang="FR"> EJB 3</span><span style="font-family: 宋体;">的</span><span style="font-family: 宋体;" lang="FR">Interceptors</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">可以使用</span><span style="font-family: 宋体;" lang="FR">@AroundInvoke</span><span style="font-family: 宋体;">来标注</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">方法为拦截方法</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">或者使用</span><span style="font-family: 宋体;" lang="FR">@Interceptors</span><span style="font-family: 宋体;">指定外部的拦截类。可以参考<span lang="EN-US">jfox</span>测试用例<span lang="EN-US">jfox.test.ejb3.interceptor</span>来了解拦截器的使用。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是示例代码：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.interceptor;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.Resource;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.PostConstruct;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.PreDestroy;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.ejb.SessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.interceptor.AroundInvoke;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.interceptor.InvocationContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.interceptor.Interceptors;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Stateless(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">name = <span style="color: blue;">"interceptor.CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Interceptors(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{OuterClassInterceptor.<b><span style="color: navy;">class</span></b>})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CalculatorBean <b><span style="color: navy;">extends</span></b> SuperCalculatorBean <b><span style="color: navy;">implements</span></b> CalculatorRemote, CalculatorLocal {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">SessionContext <b><span style="color: rgb(102, 14, 122);">sessionContext;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> add(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x + y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Interceptors(</span>{OuterMethodInterceptor.<b><span style="color: navy;">class</span></b>})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> subtract(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x - y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@AroundInvoke</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> Object aroundInvoke(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"AroundInvoke: "</span> + <b><span style="color: navy;">this</span></b>.getClass().getName() + <span style="color: blue;">".aroundInvoke, method: "</span> + invocationContext.getMethod().getName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> invocationContext.proceed();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Timer Service</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="SV">Timer Service</span><span style="font-family: 宋体;">为</span><span style="font-family: 宋体;" lang="SV">EJB</span><span style="font-family: 宋体;">提供延时或定时执行某个方法的能力。</span><span style="font-family: 宋体;" lang="SV">EJB 3</span><span style="font-family: 宋体;">中，</span><span style="font-family: 宋体;">可以通过</span><span style="font-family: 宋体;" lang="SV">@Resource</span><span style="font-family: 宋体;">注入</span><span style="font-family: 宋体;" lang="SV">Timer Service,</span><span style="font-family: 宋体;">并通过实现</span><span style="font-family: 宋体;" lang="SV">TimedObject</span><span style="font-family: 宋体;">接口来实现<span lang="EN-US">Timer Service</span>执行的方法</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">或者使用</span><span style="font-family: 宋体;" lang="SV">@Timedout</span><span style="font-family: 宋体;">来标注<span lang="EN-US">Time Service</span>执行的方法。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="SV">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的例子展示了如何使用</span><span style="font-family: 宋体;" lang="SV">Timer Service</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">完整代码可以参考</span><span style="font-family: 宋体;" lang="SV">JFox TimerService</span><span style="font-family: 宋体;">测试用例</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">包名</span><span style="font-family: 宋体;">：<span lang="SV">jfox.test.ejb3.timer</span></span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">EJB</span><span style="font-family: 宋体;">接口，定义用来提交定时任务的方法：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.timer;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> ExampleTimer {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* EJB </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">方法，用来提交定时任务</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">void</span></b> scheduleTimer(<b><span style="color: navy;">long</span></b> milliseconds);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="SV">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="SV">EJB Bean</span><span style="font-family: 宋体;">实现：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.timer;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.util.Date;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.ejb.SessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Timeout;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.ejb.Timer;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.ejb.TimedObject;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.ejb.TimerService;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.Resource;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">name = <span style="color: blue;">"timer.ExampleTimerBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> ExampleTimerBean <b><span style="color: navy;">implements</span></b> ExampleTimer, TimedObject {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">private</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> SessionContext <b><span style="color: rgb(102, 14, 122);">ctx;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">TimerService <b><span style="color: rgb(102, 14, 122);">timerService;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">使用两种方式分别提交一个定时任务</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> scheduleTimer(<b><span style="color: navy;">long</span></b> milliseconds) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">ctx.</span></b>getTimerService().createTimer(<b><span style="color: navy;">new</span></b> Date(<b><span style="color: navy;">new</span></b> Date().getTime() + milliseconds), <span style="color: blue;">"Hello World"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">timerService.</span></b>createTimer(<b><span style="color: navy;">new</span></b> Date(<b><span style="color: navy;">new</span></b> Date().getTime() + milliseconds), <span style="color: blue;">"Hello World2"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">使用<span lang="EN-US"> @Timeout </span>标注</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Timeout</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">void</span></b> timeoutHandler(Timer timer) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"---------------------"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"* Received Timer event: "</span> + timer.getInfo());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"---------------------"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timer.cancel();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">实现<span lang="EN-US"> TimedObject </span>定义的方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> ejbTimeout(Timer timer) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"---------------------"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"* Received interface Timer event : "</span> + timer.getInfo());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"---------------------"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timer.cancel();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">更多关于<span lang="EN-US">TimerService</span>的信息，可以参考<span lang="EN-US">EJB3</span>规范或者访问下面的链接：<span lang="EN-US"><a href="http://www.javabeat.net/javabeat/ejb3/articles/timer_services_api_in_ejb_3_0_1.php">http://www.javabeat.net/javabeat/ejb3/articles/timer_services_api_in_ejb_3_0_1.php</a></span></span></p>

<h3><a name="_Toc171745398"></a><span style="font-family: 宋体;" lang="EN-US">5.1.3</span><span style="font-family: 宋体;" lang="EN-US"> Security</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">EJB Security</span><span style="font-family: 宋体;">为<span lang="EN-US">EJB</span>提供基于角色的方法级安全，并可以和应用程序的安全系统集成，认证之后，认证信息可以在<span lang="EN-US">Client</span>和<span lang="EN-US">EJB</span>容器之间传播。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">对<span lang="EN-US">JAAS</span>进行了封装，提供了基于<span lang="EN-US">JAAS</span>的登录服务，并实现了应用角色到<span lang="EN-US">EJB</span>角色之间的映射，以及在<span lang="EN-US">Client</span>和<span lang="EN-US">EJB</span>容器之间传播<span lang="EN-US">Seciruty Context</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">为了使用<span lang="EN-US">JFox EJB</span>安全，需要使用<span lang="EN-US">JFox</span>提供的<span lang="EN-US">LoginService</span>进行登录，并且需要配置好<span lang="EN-US">roles.properties</span>配置文件以定义应用角色到<span lang="EN-US">EJB</span>角色的映射，然后在<span lang="EN-US">EJB</span>中使用<span lang="EN-US">javax.annotation.security</span>提供的<span lang="EN-US">Annotation</span>对<span lang="EN-US">EJB</span>方法进行标注以进行安全控制。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="FR">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="FR">EJB Security Annotation</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">javax.annotation.security</span><span style="font-family: 宋体;">提供了多种</span><span style="font-family: 宋体;" lang="FR">Annotation</span><span style="font-family: 宋体;">用来对</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">进行标注。下面的</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">展示了如何使用</span><span style="font-family: 宋体;" lang="FR">EJB Security Annotation</span><span style="font-family: 宋体;">来标注</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">的安全。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.security;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.security.Principal;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.security.DenyAll;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.security.PermitAll;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.security.RolesAllowed;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.annotation.security.RunAs;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.annotation.Resource;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.ejb.SessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">name = <span style="color: blue;">"security.CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@RunAs(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: blue; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">"role"</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CalculatorBean <b><span style="color: navy;">implements</span></b> CalculatorRemote, CalculatorLocal {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">SessionContext <b><span style="color: rgb(102, 14, 122);">ejbContext;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@PermitAll</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <b><span style="color: navy;">int</span></b> add(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x + y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">27 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@DenyAll</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <b><span style="color: navy;">int</span></b> subtract(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x - y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">32 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@RolesAllowed(</span>{<span style="color: blue;">"role1,role2"</span>})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> plus(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x*y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">37 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">double</span></b> devide(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Principal principal = <b><span style="color: rgb(102, 14, 122);">ejbContext.</span></b>getCallerPrincipal();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"devide caller principal: "</span> + principal);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x/y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">43 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">45 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;&nbsp;&nbsp; @RunAs</span><span style="font-family: 宋体;">标注在</span><span style="font-family: 宋体;" lang="FR">Class</span><span style="font-family: 宋体;">上</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">指定使用特定的角色来执行该</span><span style="font-family: 宋体;" lang="FR">Bean</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">一般来说</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">仅用于测试阶段</span><span style="font-family: 宋体;">；</span><span style="font-family: 宋体;">其它的</span><span style="font-family: 宋体;" lang="FR">Annotation</span><span style="font-family: 宋体;">标注在方法上</span><span style="font-family: 宋体;">，<span lang="FR">@PermitAll</span>表示所有角色可以访问，<span lang="FR">@DenyAll</span>表明所有角色都不能访问，<span lang="FR">@RoleseAllowed</span>表示只有参数中的角色可以访问。注意这里说的角色均指<span lang="FR">EJB</span>角色。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">EJB Security Annotatoin</span><span style="font-family: 宋体;">详细的内容可以参考</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">规范。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Role</span></b><b><span style="font-family: 宋体;">映射</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">为了建立<span lang="EN-US">EJB </span>角色和应用角色之间的映射关系，需要编辑<span lang="EN-US">roles.properties</span>文件。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">roles.properties</span><span style="font-family: 宋体;">文件格式如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 10.5pt; color: maroon;" lang="EN-US">1 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">#define applicatiob role link to ejb role</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 10.5pt; color: maroon;" lang="EN-US">2 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">#application role = ejb role</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 10.5pt; color: maroon;" lang="EN-US">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">account_manager</span><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<span style="color: green;">manager</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 10.5pt; color: maroon;" lang="EN-US">4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">technology_manager</span><span style="background: white none repeat scroll 0% 0%; font-size: 10.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<span style="color: green;">manager</span></span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">key</span><span style="font-family: 宋体;">为应用角色<span lang="EN-US">(Application Role)</span>，<span lang="EN-US">value</span>为<span lang="EN-US">EJB</span>角色<span lang="EN-US">(EJB Role)</span>，在<span lang="EN-US">EJB
Security</span>中，将以<span lang="EN-US">EJB</span>角色来进行判断，如下面的代码，限定<span lang="EN-US">plus</span>方法只能被<span lang="EN-US">EJB</span>角色<span lang="EN-US">role1</span>和<span lang="EN-US">role2</span>访问：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@RolesAllowed(</span>{<span style="color: blue;">"role1,role2"</span>})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> plus(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x*y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">而对于没有配置对应</span><span style="font-family: 宋体;" lang="FR">EJB </span><span style="font-family: 宋体;">角色的应用角色</span><span style="font-family: 宋体;">，<span lang="FR">JFox</span></span><span style="font-family: 宋体;">将直接使用应用角色作为</span><span style="font-family: 宋体;" lang="FR">EJB </span><span style="font-family: 宋体;">角色。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">JAASLoginService</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3</span><span style="font-family: 宋体;">提供了<span lang="EN-US">JAASLoginService</span>提供登录服务。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是<span lang="EN-US"> JAASLoginService</span>接口的定义：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.ejb3.security;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.security.auth.callback.CallbackHandler;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.servlet.http.HttpServletRequest;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.mvc.SessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.framework.component.Component;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">org.jfox.framework.annotation.Exported;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Exported</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <b><span style="color: navy;">interface</span></b> JAASLoginService <b><span style="color: navy;">extends</span></b> Component {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">static</span></b> ThreadLocal&lt;JAASLoginRequestCallback&gt; <b><i><span style="color: rgb(102, 14, 122);">loginRequestThreadLocal </span></i></b>= <b><span style="color: navy;">new</span></b> ThreadLocal&lt;JAASLoginRequestCallback&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">static</span></b> ThreadLocal&lt;JAASLoginResponseCallback&gt; <b><i><span style="color: rgb(102, 14, 122);">loginResponseThreadLocal </span></i></b>= <b><span style="color: navy;">new</span></b> ThreadLocal&lt;JAASLoginResponseCallback&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录接口方法，如果在<span lang="EN-US">Servlet</span>中直接调用，则可以使用该方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> request http servlet request</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> callbackHandler </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">进行登录的<span lang="EN-US">callback</span>，调用时由<span lang="EN-US">client</span>指定</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> params </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录时提供的参数，一般是用户名和密码</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录成功之后的对象，比如：<span lang="EN-US">Account</span>对象，取决于<span lang="EN-US">callbackHandler</span>调用<span lang="EN-US">JAASLoginResponseCallback.setCallbackObject</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@throws</u></b> Exception </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录失败时抛出异常</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Object login(HttpServletRequest request, CallbackHandler callbackHandler, String... params) <b><span style="color: navy;">throws</span></b> Exception;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录接口方法，如果在<span lang="EN-US">Action</span>中调用，则可以使用该方法，因为能够得到<span lang="EN-US">SessionContext</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> sessionContext session context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> callbackHandler </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">进行登录的<span lang="EN-US">callback</span>，调用时由<span lang="EN-US">client</span>指定</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> params </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录时提供的参数，一般是用户名和密码</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录成功之后的对象，比如：<span lang="EN-US">Account</span>对象，取决于<span lang="EN-US">callbackHandler</span>调用<span lang="EN-US">JAASLoginResponseCallback.setCallbackObject</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@throws</u></b> Exception </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">登录失败时抛出异常</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Object login(SessionContext sessionContext, CallbackHandler callbackHandler, String... params) <b><span style="color: navy;">throws</span></b> Exception;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; JAASLoginService</span><span style="font-family: 宋体;">主要定义了两个方法，这两个方法之后第一参数不同，第一个参数用来得到提供<span lang="EN-US">Session
Context</span>，<span lang="EN-US">JFox</span>使用<span lang="EN-US">Session</span>传播<span lang="EN-US">Security Context</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JAASLoginService</span><span style="font-family: 宋体;">有一个实现类<span lang="EN-US">JAASLoginSreviceImpl</span>，它一个<span lang="EN-US">JFox</span>内核服务组件，为了使用<span lang="EN-US">JAASLoginService</span>，可以使用<span lang="EN-US">JFox</span>微内核定义的<span lang="EN-US"> @Inject</span>注入，或者通过<span lang="EN-US">ComponentContext.
getComponentsByInterface</span>得到，关于<span lang="EN-US">JFox</span>内核的内容，详细的描述见后面的“<span lang="EN-US">JFox</span>微内核”章节。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox Petstore</span><span style="font-family: 宋体;">的<span lang="EN-US">AccountAction</span>有以下代码，用来注入<span lang="EN-US">LoginService</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Inject</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">JAASLoginService <b><span style="color: rgb(102, 14, 122);">loginService;</span></b></span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">CallbackHandler</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">为了使用<span lang="EN-US">JAAS</span>登录，需要提供<span lang="EN-US">javax.security.auth.callback.CallbackHandler</span>回调对象，<span lang="EN-US">CallbackHandler</span>是<span lang="EN-US">JAAS</span>定义的接口，在登录过程中由<span lang="EN-US">JAAS</span>调用，用来实现用户认证的过程。接口定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.security.auth.callback;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 &nbsp;</span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> CallbackHandler {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">void</span></b> handle(Callback[] callbacks)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throws</span></b> java.io.IOException, UnsupportedCallbackException;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">CallbackHandler.handle</span><span style="font-family: 宋体;">方法的参数为<span lang="EN-US">Callback[]</span>数组，由<span lang="EN-US">JAAS</span>实现提供，<span lang="EN-US">JFox</span>提供的是一个有两个元素的数组，它们的类型分别是<span lang="EN-US">:</span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.ejb3.security.JAASLoginRequestCallback</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.ejb3.security.JAASLoginResponseCallback</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JAASLoginRequestCallback</span><span style="font-family: 宋体;">携带有登录的参数数组，数组的大小这取决你调用<span lang="EN-US">JAASLoginService.login</span>时提供的可变参数（</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">String... params</span><span style="font-family: 宋体;">）的大小，一般来说，<span lang="EN-US">0</span>号元素为<span lang="EN-US">username</span>，<span lang="EN-US">1</span>号元素为<span lang="EN-US">password</span>；</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JAASLoginResponseCallback</span><span style="font-family: 宋体;">用来携带登录完成之后需要返回的值，<span lang="EN-US">setCallbackObject</span>设置返回的对象，<span lang="EN-US">setPrincipalName</span>设置用户名，<span lang="EN-US">setRole</span>设置用户的角色，这些值将用于生成用户的<span lang="EN-US">Security Context</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是一个<span lang="EN-US">JFox Petstore</span>中<span lang="EN-US">AccountAction</span>中实现的<span lang="EN-US">handle</span>方法：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* JAAS CallbackHandler method </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> handle(Callback[] callbacks) <b><span style="color: navy;">throws</span></b> IOException, UnsupportedCallbackException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JAASLoginRequestCallback requestCallback = (JAASLoginRequestCallback)callbacks[<span style="color: blue;">0</span>];</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JAASLoginResponseCallback responseCallback = (JAASLoginResponseCallback)callbacks[<span style="color: blue;">1</span>];</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// first parameter is username</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String username = requestCallback.getParams().get(<span style="color: blue;">0</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// second parameter is password</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String password = requestCallback.getParams().get(<span style="color: blue;">1</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account account = <b><span style="color: rgb(102, 14, 122);">accountBO.</span></b>getAccount(username, password);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set callback object, will return by LoginService.login</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setCallbackObject(account);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set principal name</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setPrincipalName(username);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set role</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setRole(username);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; AccountAction.doPostSignOn</span><span style="font-family: 宋体;">方法调用<span lang="EN-US">JAASLoginService.login</span>登录，将<span lang="EN-US">this</span>作为<span lang="EN-US">CallbackHandler</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Account account = (Account)<b><span style="color: rgb(102, 14, 122);">loginService.</span></b>login(invocationContext.getSessionContext(), <b><span style="color: navy;">this</span></b>, invocation.getUsername(),invocation.getPassword())</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">让<span lang="EN-US">Action</span>类实现<span lang="EN-US">CallbackHandler</span>接口，可以方便的在<span lang="EN-US">handle</span>方法中访问登录过程需要的资源。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="FR">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="FR">Security Context</span></b><b><span style="font-family: 宋体;">的传播</span></b></p>

<p class="MsoNormal" style="margin-left: 5.25pt; text-indent: 15.75pt;"><span style="font-family: 宋体;">用户登录成功之后</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">系统将为其生成</span><span style="font-family: 宋体;" lang="FR">Security
Context</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">在</span><span style="font-family: 宋体;" lang="FR">Client</span><span style="font-family: 宋体;">和</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">容器交互的过程</span><span style="font-family: 宋体;">，<span lang="FR">Security Context</span>需要</span><span style="font-family: 宋体;">在</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">的</span><span style="font-family: 宋体;" lang="FR">Client</span><span style="font-family: 宋体;">和</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">容器之间不断的进行传播</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">以便容器总是能够得到当前调用者的</span><span style="font-family: 宋体;" lang="FR">Security </span><span style="font-family: 宋体;">信息，以做出安全判断</span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">因为</span><span style="font-family: 宋体;" lang="FR">JFox 3</span><span style="font-family: 宋体;">将</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">容器嵌入在</span><span style="font-family: 宋体;" lang="FR">Web</span><span style="font-family: 宋体;">容器中设计</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">所以</span><span style="font-family: 宋体;" lang="FR">Security Context</span><span style="font-family: 宋体;">采用了</span><span style="font-family: 宋体;" lang="FR">HttpSession</span><span style="font-family: 宋体;">来进行传播</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">这是最方便的一种传播方式</span><span style="font-family: 宋体;">，用户登录时，<span lang="FR">LoginService</span>会</span><span style="font-family: 宋体;">将用户的</span><span style="font-family: 宋体;" lang="FR">Security Context</span><span style="font-family: 宋体;">存放在<span lang="FR">Session</span>中，<span lang="FR">EJB</span>容器通过访问当前用户的<span lang="FR">Sessoin</span>就可获得其<span lang="FR">Security</span>信息，</span><span style="font-family: 宋体;">在用户退出时</span><span style="font-family: 宋体;">，只需要销毁<span lang="FR">HttpSession</span></span><span style="font-family: 宋体;">即可以销毁用户的</span><span style="font-family: 宋体;" lang="FR">Security Context</span><span style="font-family: 宋体;">。这样的做法在<span lang="FR">Web</span></span><span style="font-family: 宋体;">容器和</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">容器运行在相同的<span lang="EN-US">JVM</span>中时</span><span style="font-family: 宋体;">，能够非常非常好的工作，而如果<span lang="FR">Web</span>容器和<span lang="FR">EJB</span>容器运行在不同的<span lang="FR">JVM</span>中，则需要其它的传播机制，</span><span style="font-family: 宋体;">其它的</span><span style="font-family: 宋体;" lang="FR">Security
Context</span><span style="font-family: 宋体;">传播方式可能在后续版本中提供。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">HttpSession</span><span style="font-family: 宋体;">是在</span><span style="font-family: 宋体;" lang="FR">JAASLoginService.login</span><span style="font-family: 宋体;">的方法中</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">使用</span><span style="font-family: 宋体;" lang="FR">HttpServletRequest</span><span style="font-family: 宋体;">或者</span><span style="font-family: 宋体;" lang="FR">SessionContext</span><span style="font-family: 宋体;">提供的。</span></p>

<h3><a name="_Toc171745399"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR">5.1.4</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR"> Web Service</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">EJB 3</span><span style="font-family: 宋体;">让<span lang="FR">Web Service</span>的使用变得非常简单。<span lang="FR">JFox 3 </span></span><span style="font-family: 宋体;">集成了</span><span style="font-family: 宋体;" lang="FR"> Xfire(<a href="http://xfire.codehaus.org/">http://xfire.codehaus.org/</a>)</span><span style="font-family: 宋体;">来支持</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">要在</span><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">中使用</span><span style="font-family: 宋体;" lang="FR"> Web
Service </span><span style="font-family: 宋体;">非常简单</span><span style="font-family: 宋体;">。 </span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要使用</span><span style="font-family: 宋体;" lang="FR">Web Service</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">首先需要检查</span><span style="font-family: 宋体;" lang="FR">web.xml</span><span style="font-family: 宋体;">的配置</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">如下配置了用来接受</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">请求的<span lang="FR">Servlet</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">xfire_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;<span style="color: navy;">servlet-class</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">org.jfox.webservice.xfire.JFoxXFireServlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;/<span style="color: navy;">servlet-class</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">load-on-startup</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">1</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">load-on-startup</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">xfire_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/webservice/*</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的例子来源于</span><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">测试用例</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">包名</span><span style="font-family: 宋体;">：<span lang="FR">jfox.test.ejb3.webservice</span></span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">给<span lang="EN-US">EJB Bean</span>的加上<span lang="EN-US">@WebService</span>标注，以将<span lang="EN-US">EJB</span>发布成<span lang="EN-US">Web Service</span>，<span lang="EN-US">endpointInterface</span>指明发布的接口名，不指定则为<span lang="EN-US">EJB Bean</span>实现的所有接口，<span lang="EN-US">serviceName</span>指明<span lang="EN-US">Web Service</span>的名称，默认为<span lang="EN-US">Bean</span>的类名简称（即：<span lang="EN-US">CalculatorBean</span>）。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.webservice;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.jws.WebService;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.stateless.Calculator;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">name = <span style="color: blue;">"webservice.CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@WebService(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">endpointInterface = <span style="color: blue;">"jfox.test.ejb3.webservice.Calculator"</span>, serviceName = <span style="color: blue;">"CalculatorBean"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CalculatorBean <b><span style="color: navy;">implements</span></b> Calculator {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> add(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x + y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">int</span></b> subtract(<b><span style="color: navy;">int</span></b> x, <b><span style="color: navy;">int</span></b> y) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> x - y;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">系统启动之后，访问
<span lang="EN-US"><a href="http://localhost:8080/jfox/webservice">http://localhost:8080/jfox/webservice</a>
</span>即可以看到发布成功的<span lang="EN-US">Web Service</span>列表，如下图：</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image004.jpg" border="0" height="297" width="553"></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">点击<span lang="EN-US">wsdl</span>，就可以查看详细内容，其中有<span lang="EN-US">soap</span>地址：</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image005.jpg" border="0" height="297" width="553"></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要调用<span lang="EN-US">Web Service</span>，可以使用<span lang="EN-US">WebServiceHelper.lookupWS</span>，第一个参数是你的<span lang="EN-US">Web Service</span>发布的<span lang="EN-US">endpoint URL</span>，第二个参数为<span lang="EN-US">Web Service</span>发布的接口，代码如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.webservice;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.webservice.WebServiceHelper;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> WebServiceClient {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">void</span></b> main(String[] args) <b><span style="color: navy;">throws</span></b> Exception{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculator example = WebServiceHelper.<i>lookupWS(</i><span style="color: blue;">"http://localhost:8080/jfox/webservice/CalculatorBean"</span>, Calculator.<b><span style="color: navy;">class</span></b>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"Web Service invoke Calculator.add(1,1): "</span> + example.add(<span style="color: blue;">1</span>,<span style="color: blue;">1</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"Web Service invoke Calculator.substract(2,1): "</span> + example.subtract(<span style="color: blue;">2</span>,<span style="color: blue;">1</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">输出如下：</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Web Service invoke Calculator.add(1,1): 2</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Web Service invoke Calculator.substract(2,1):
1</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">WebServiceHelper</span><span style="font-family: 宋体;">提供了基于<span lang="EN-US">Java</span>语言的而且已经拥有<span lang="EN-US">Web Service</span>接口的调用方法，如果需要使用其它的语言或者无法获得接口的情况下，则需要通过<span lang="EN-US">WSDL</span>动态生成<span lang="EN-US">Web Service Client</span>需要的文件，然后按规范进行调用。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">使用<span lang="EN-US">JFox</span>提供的<span lang="EN-US">Web Service</span>要注意一下几点</span><span style="font-family: 宋体;">：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">1.EJB</span><span style="font-family: 宋体;">规范要求只有<span lang="FR">Stateless Bean</span>可以发布成<span lang="FR">Web service</span>；</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">2.JFox</span><span style="font-family: 宋体;">暂时只支持使用</span><span style="font-family: 宋体;" lang="FR">@WebService</span><span style="font-family: 宋体;">指明</span><span style="font-family: 宋体;">接口来发布</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">还不支持</span><span style="font-family: 宋体;" lang="FR">@WebMethod</span><span style="font-family: 宋体;">指定方法的形式发布</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">。</span></p>

<h3><a name="_Toc171745400"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR">5.1.5</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR"> Transaction
Manager</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">JFox 3</span><span style="font-family: 宋体;">使用</span><span style="font-family: 宋体;" lang="FR">JOTM(</span><span style="font-family: 宋体;" lang="EN-US"><a href="http://jotm.objectweb.org/"><span lang="FR">http://jotm.objectweb.org</span></a></span><span style="font-family: 宋体;" lang="FR">)</span><span style="font-family: 宋体;">作为</span><span style="font-family: 宋体;" lang="FR">Transaction Manager</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">为</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">和</span><span style="font-family: 宋体;" lang="FR">JPA</span><span style="font-family: 宋体;">提供事务处理服务。</span><span style="font-family: 宋体;" lang="FR">JOTM</span><span style="font-family: 宋体;">这是一个久经考验的</span><span style="font-family: 宋体;" lang="FR">JTA</span><span style="font-family: 宋体;">的实现</span><span style="font-family: 宋体;">，<span lang="FR">JFox</span></span><span style="font-family: 宋体;">集成了</span><span style="font-family: 宋体;" lang="FR">JOTM</span><span style="font-family: 宋体;">之后</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">又对</span><span style="font-family: 宋体;" lang="FR">Transaction
Manager</span><span style="font-family: 宋体;">进行了大量的测试</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">来保证</span><span style="font-family: 宋体;" lang="FR">Transaction</span><span style="font-family: 宋体;">正确性以及高效性。<span lang="EN-US">JFox</span>支持所有<span lang="EN-US">EJB</span>事务属性，<span lang="EN-US">EJB
3</span>的事务属性由<span lang="EN-US">javax.ejb.</span></span><span style="font-family: 宋体;" lang="EN-US"> TransactionAttributeType</span><span style="font-family: 宋体;">定义，共包括：<span lang="EN-US">MANDATORY</span></span><span style="font-family: 宋体;">，<span lang="EN-US">NEVER</span>，<span lang="EN-US">NOT_SUPPORTED</span>，<span lang="EN-US">REQUIRED</span>，<span lang="EN-US">REQUIRES_NEW</span>，<span lang="EN-US">SUPPORTS</span>。<span lang="EN-US">EJB</span>方法的默认的事务属性为：<span lang="EN-US">REQUIRED</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的代码展示了对<span lang="EN-US">ejb</span>方法进行事务属性的声明：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@TransactionAttribute(</span>TransactionAttributeType.<b><i><span style="color: rgb(102, 14, 122);">REQUIRES_NEW)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> ejbMethod(){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"ejbMethod"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">虽然可以<span lang="FR">EJB</span>支持<span lang="FR">CMT(Container Managed Transaction)</span>和<span lang="FR">BMT</span>（<span lang="FR">Bean Managed Transaction</span>），但是</span><span style="font-family: 宋体;">建议你总是使用容器管理的事务</span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">你可以通过修改</span><span style="font-family: 宋体;" lang="FR"> global.properties </span><span style="font-family: 宋体;">的</span><span style="font-family: 宋体;" lang="FR">
jta_transaction_timeout=60</span><span style="font-family: 宋体;">来调整默认的</span><span style="font-family: 宋体;" lang="FR"> Transaction </span><span style="font-family: 宋体;">超时时间。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">关于<span lang="FR">EJB3</span></span><span style="font-family: 宋体;">的事务的更多内容请参考</span><span style="font-family: 宋体;" lang="FR">EJB3</span><span style="font-family: 宋体;">规范。</span></p>

<h3><a name="_Toc171745401"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR">5.1.6</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="FR"> Message
Service</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">实现了一个轻量的符合</span><span style="font-family: 宋体;" lang="FR">JMS</span><span style="font-family: 宋体;">规范的</span><span style="font-family: 宋体;" lang="FR">MessageService</span><span style="font-family: 宋体;">。它非常轻量</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">仅用来实现</span><span style="font-family: 宋体;" lang="FR">Message Driven Bean</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">所以它只实现了往本地分发消息的能力。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">实现一个</span><span style="font-family: 宋体;" lang="FR">Message Driven Bean</span><span style="font-family: 宋体;">非常简单</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">下面的代码展示实现一个基于</span><span style="font-family: 宋体;" lang="FR">Topic</span><span style="font-family: 宋体;">的</span><span style="font-family: 宋体;" lang="FR">Message Driven Bean</span><span style="font-family: 宋体;">。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.MessageDriven;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.ejb.ActivationConfigProperty;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.MessageListener;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.Message;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:yang_y@sysnet.com.cn"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@MessageDriven(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">activationConfig =</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActivationConfigProperty(</span>propertyName=<span style="color: blue;">"destinationType"</span>, propertyValue=<span style="color: blue;">"javax.jms.Topic"</span>),</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActivationConfigProperty(</span>propertyName=<span style="color: blue;">"destination"</span>, propertyValue=<span style="color: blue;">"testT"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> TopicMDB1 <b><span style="color: navy;">implements</span></b> MessageListener {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> onMessage(Message recvMsg) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<b><i><span style="color: rgb(102, 14, 122);">out.</span></i></b>println(<span style="color: blue;">"Received message: "</span> + recvMsg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">注意：<span lang="EN-US">MDB</span>必须实现<span lang="EN-US">javax.jms.MessageListener</span>接口，并且使用<span lang="EN-US">@MessageDriven</span>来描述，并申明两个<span lang="EN-US">ActivationConfigProperty</span>，一个为<span lang="EN-US">destinationType</span>指定地址类型（<span lang="EN-US">javax.jms.Queue</span>或者<span lang="EN-US">javax.jms.Topic</span>），另一个为<span lang="EN-US">destination</span>，指定地址名称。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">一般来说</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">应该使用一个</span><span style="font-family: 宋体;" lang="FR">Statelss Session</span><span style="font-family: 宋体;">来完成发送消息的任务</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">如果</span><span style="font-family: 宋体;" lang="FR">Client</span><span style="font-family: 宋体;">与应用服务器</span><span style="font-family: 宋体;">不在同一个</span><span style="font-family: 宋体;" lang="FR">JVM</span><span style="font-family: 宋体;">中</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">则可以将</span><span style="font-family: 宋体;" lang="FR">Stateless Sesion Bean</span><span style="font-family: 宋体;">发布成</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">，<span lang="FR">Client</span></span><span style="font-family: 宋体;">通过</span><span style="font-family: 宋体;" lang="FR">Web
Service</span><span style="font-family: 宋体;">来实现远程向</span><span style="font-family: 宋体;" lang="FR">Message Service</span><span style="font-family: 宋体;">发送消息。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的代码展示了通过</span><span style="font-family: 宋体;" lang="FR">Stateless Session Bean</span><span style="font-family: 宋体;">向</span><span style="font-family: 宋体;" lang="FR">Message
Service</span><span style="font-family: 宋体;">发布消息</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> jfox.test.ejb3.mdb;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.annotation.Resource;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.ejb.EJBException;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Remote;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.Message;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.QueueConnection;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.QueueConnectionFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.QueueSender;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.QueueSession;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.Session;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.TopicConnection;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.TopicConnectionFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.TopicPublisher;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">16 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.jms.TopicSession;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">17 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">18 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.ejb3.naming.JNDIContextHelper;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:yang_y@sysnet.com.cn"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Remote</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> MessageSenderBean <b><span style="color: navy;">implements</span></b> MessageSender {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Resource</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">QueueConnectionFactory <b><span style="color: rgb(102, 14, 122);">queueConnectionFactory;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> sendQueueMessage(Message message) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// use injected jms connection factory</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueConnection qc = <b><span style="color: rgb(102, 14, 122);">queueConnectionFactory.</span></b>createQueueConnection();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueSession qs = qc.createQueueSession(<b><span style="color: navy;">false</span></b>, Session.<b><i><span style="color: rgb(102, 14, 122);">AUTO_ACKNOWLEDGE)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueueSender sender = qs.createSender(qs.createQueue(<span style="color: blue;">"testQ"</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender.send(qs.createTextMessage(<span style="color: blue;">"Hello, Queue MDB!"</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b> (Exception e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> EJBException(e);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">42 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> sendTopicMessage(Message message) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// lookup jms connection factory by jndi</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TopicConnectionFactory tcf = (TopicConnectionFactory)JNDIContextHelper.<i>lookup(</i><span style="color: blue;">"defaultcf"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TopicConnection tc = tcf.createTopicConnection();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TopicSession ts = tc.createTopicSession(<b><span style="color: navy;">false</span></b>, Session.<b><i><span style="color: rgb(102, 14, 122);">AUTO_ACKNOWLEDGE)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TopicPublisher tp = ts.createPublisher(ts.createTopic(<span style="color: blue;">"testT"</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp.send(ts.createTextMessage(<span style="color: blue;">"Hello, Topic MDB!"</span>));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b> (Exception e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">53 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> EJBException(e);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">54 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">55 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">56 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">57 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">关于<span lang="EN-US">JMS</span>以及<span lang="EN-US">Message Driven Bean</span>的更多内容可以参考相关规范。</span></p>

<h3><a name="_Toc171745402"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">5.1.7</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US"> JFox 3 EJB</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;">容器的局限性</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">了解<span lang="EN-US">JFox 3 EJB</span>容器的局限性，有助于你更好的和正确使用<span lang="EN-US">JFox</span>。<span lang="EN-US">JFox</span>容器设计时，主要考虑普遍的<span lang="EN-US">Web</span>容器和<span lang="EN-US">EJB</span>容器署在同一个<span lang="EN-US">JVM</span>中的情况，所以容器本身并没有提供远程访问服务。如果你有计划将<span lang="EN-US">Web</span>和<span lang="EN-US">EJB</span>部署分离部署在不同的<span lang="EN-US">JVM</span>中，那么只能使用<span lang="EN-US">Web Service</span>来调用<span lang="EN-US">EJB</span>组件。</span></p>

<h3><a name="_Toc171745403"></a><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US">5.1.8</span><span style="font-size: 14pt; line-height: 173%; font-family: 宋体;" lang="EN-US"> JPA
Container</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JPA </span><span style="font-family: 宋体;">是<span lang="EN-US">Java EE</span>体系中另外一个重要的容器，在<span lang="EN-US">EJB3</span>中，<span lang="EN-US">EntityBean</span>已经独立称<span lang="EN-US">JPA</span>规范，<span lang="EN-US">JPA</span>参考了<span lang="EN-US">Hibernate</span>、<span lang="EN-US">JDO</span>等既有的<span lang="EN-US">O/R</span>产品和规范，形成了统一的<span lang="EN-US">Java</span>持久化<span lang="EN-US">API</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox JPA</span><span style="font-family: 宋体;">容器在兼容<span lang="EN-US">JPA</span>接口的前提下，提供了一个可靠的、高效的、易于掌握且可控的持久化方案。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">与纯<span lang="EN-US">O/R Mapping</span>的框架不同，<span lang="EN-US">JFox JPA</span>容器采用了<span lang="EN-US"> SQLTemplate</span>设计思路来实现<span lang="EN-US">JPA</span>的实现，<span lang="EN-US">SQLTemplate</span>最先由<span lang="EN-US">iBatis(<a href="http://ibatis.apache.org/">http://ibatis.apache.org</a>)</span>提出，<span lang="EN-US">SQLTemplate</span>既大大简化了<span lang="EN-US">JDBC</span>的开发，又很好了保留了<span lang="EN-US">SQL</span>的特性，同时提供一定的<span lang="EN-US">O/R</span>映射的能力。由于基于<span lang="EN-US">SQLTemplate</span>更简单和容易掌握，且拥有更好的可控性，便于后期进行查错和调优，所以在一些大型的产品或者对数据库性能敏感的产品中，更受欢迎。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要掌握<span lang="EN-US">JFox JPA</span>，需要掌握<span lang="EN-US">Named Query</span>、字段映射、数据源、缓存等内容。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@NamedNativeQuery</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox 3</span><span style="font-family: 宋体;">使用<span lang="EN-US">JPA</span>的<span lang="EN-US"> @NamedNativeQueries </span>和<span lang="EN-US"> @NamedNativeQuery</span>命名<span lang="EN-US">SQLTemplate</span>，<span lang="EN-US">SQLTemplate</span>采用的是<span lang="EN-US">Velocity(<a href="http://velocity.apache.org/">http://velocity.apache.org</a>)</span>模板表达式语言。<span lang="EN-US">@NamedNativeQuery</span>建议描述对<span lang="EN-US">DAO Session Bean</span>上，但也不是必须的，也可以描述在<span lang="EN-US">Entity</span>上。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的代码取自<span lang="EN-US"> JFox Petstore AccountDAOImpl</span>，这是负责操作<span lang="EN-US">Account
Entity </span>的<span lang="EN-US"> DAO Session Bean</span>。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = AccountDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">GET_ACCOUNT_BY_USERNAME_AND_PASSWORD,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"select "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"signon.username as userid,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.email,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.firstname,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.lastname,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.status,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.addr1,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.addr2,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.city,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.state,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.zip,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.country,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"account.phone,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"profile.langpref,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"profile.favcategory,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"profile.mylistopt,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"profile.banneropt,"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"bannerdata.bannername"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" from account, profile, signon, bannerdata"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" where account.userid = $username"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" and signon.password = $password"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" and signon.username = account.userid"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" and profile.userid = account.userid"</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">" and profile.favcategory = bannerdata.favcategory"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resultClass = Account.<b><span style="color: navy;">class</span></b>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hints = {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@QueryHint(</span>name = <span style="color: blue;">"cache.default.partition"</span>, value = <span style="color: blue;">"account"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">上面的代码定义了根据<span lang="EN-US">username</span>和<span lang="EN-US">password</span>取得<span lang="EN-US">Account</span>的<span lang="EN-US">NamedNativeQuery</span>，<span lang="EN-US">query</span>语句是使用<span lang="EN-US">velocity</span>模板化的标准<span lang="EN-US">SQL</span>，其中有两个变量<span lang="EN-US"> $username</span>和<span lang="EN-US">$passoword</span>，它们会在执行查询时赋值，<span lang="EN-US">resultClass</span>说明返回的对象是<span lang="EN-US">Account.class</span>类型，<span lang="EN-US">hints</span>在<span lang="EN-US">JPA</span>中用来描述附加信息，上面的<span lang="EN-US">QueryHint</span>用于定义该<span lang="EN-US">JFox JPA query</span>使用<span lang="EN-US">cache</span>，下面会具体讲到。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">执行上面定义的<span lang="EN-US">NamedNativeQuery</span>看起来会像下面的代码：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Account getAccount(String username, String password) </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throws</span></b> SQLException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Query query = createNamedNativeQuery(<b><i><span style="color: rgb(102, 14, 122);">GET_ACCOUNT_BY_USERNAME_AND_PASSWORD)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setParameter(<span style="color: blue;">"username"</span>,username)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setParameter(<span style="color: blue;">"password"</span>,password);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (Account)query.getSingleResult();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">AccountDAOImpl</span><span style="font-family: 宋体;">继承了<span lang="EN-US">org.jfox.entity.dao.DAOSupport</span>，<span lang="EN-US">DAOSupport</span>的目的是为了让<span lang="EN-US">DAO</span>的编写更简单，调用<span lang="EN-US">DAOSupport</span>提供的<span lang="EN-US"> createNamedNativeQuery</span>方法创建<span lang="EN-US">Query</span>，然后使用<span lang="EN-US">setParameter</span>方法设置<span lang="EN-US"> username</span>和<span lang="EN-US">password</span>参数，最后执行<span lang="EN-US"> getSingleResult</span>返回的即是需要的<span lang="EN-US">Account</span>对象了，非常的简单吧。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">注意：<span lang="EN-US">JFox JPA</span>没有实现<span lang="EN-US">EJBQL</span>解析，所以不支持使用<span lang="EN-US">EJBQL</span>的<span lang="EN-US">@NamedQuery</span>，当然用户也不需要再去学习令人困惑的<span lang="EN-US">EJBQL</span>了。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Entity</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Entity</span><span style="font-family: 宋体;">用来描述<span lang="EN-US">JPA</span>的实体对象，一般来说<span lang="EN-US">Entity</span>类是一个纯的<span lang="EN-US">Java Bean</span>类，只是在<span lang="EN-US">Field</span>上增加了<span lang="EN-US">@Column</span>描述用来定义<span lang="EN-US">O/R</span>映射，注意，<span lang="EN-US">JFox JPA</span>容器只会分析<span lang="EN-US">Field</span>上的<span lang="EN-US">@Column</span>，并不会分析方法上的<span lang="EN-US">@Column</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">以下是一个<span lang="EN-US">Entity</span>的例子，<span lang="EN-US">JFox</span>的<span lang="EN-US">Entity</span>基本上只需要使用<span lang="EN-US">@Entity</span>、<span lang="EN-US">@Column</span>便可以完成所有的定义，这比掌握<span lang="EN-US">JPA</span>定义的所有<span lang="EN-US">Annotation</span>要简单很多。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.petstore.entity;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.io.Serializable;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.persistence.Column;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.persistence.Entity;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Entity</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> Product <b><span style="color: navy;">implements</span></b> Serializable {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name = <span style="color: blue;">"productid"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">productId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name = <span style="color: blue;">"category"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">categoryId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name = <span style="color: blue;">"name"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">name;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name = <span style="color: blue;">"descn"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">description;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getCategoryId() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">categoryId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setCategoryId(String categoryId) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">categoryId </span></b>= categoryId;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getDescription() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">description;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setDescription(String description) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">description </span></b>= description;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getName() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">name;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setName(String name) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">name </span></b>= name;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getProductId() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">productId;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setProductId(String productId) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">productId </span></b>= productId;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">53 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">一般来说，你总会为一个数据库表定义<span lang="EN-US">Entity</span>对象，并用<span lang="EN-US">@Entity</span>描述它，但有时候，你可能并没有也不想定义一个<span lang="EN-US">Entity</span>，比如：一个多表查询的结果。如果你在使用<span lang="EN-US">@NamedNativeQuery</span>时遇到这个情况，那么你可以指定<span lang="EN-US">resultClass</span>为：<span lang="EN-US">org.jfox.entity.MappedEntity</span>，或者不指定默认值即是；而如果是一个临时的查询，那么你可以指定<span lang="EN-US">createNativeQuery</span>的第二个参数为为<span lang="EN-US"> org.jfox.entity.MappedEntity</span>，看这个例子：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> MappedEntity getAccountMappedEntityById(<b><span style="color: navy;">long</span></b> id) <b><span style="color: navy;">throws</span></b> SQLException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Query query = createNativeQuery(<span style="color: blue;">"select * from ACCOUNT where ACC_ID=$id"</span>, MappedEntity.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setParameter(<span style="color: blue;">"id"</span>, id);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (MappedEntity)query.getSingleResult();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">得到<span lang="EN-US">MappedEntity</span>之后，你可以通过 <span lang="EN-US">MappedEntity.getColumnValue(String
columnName) </span>方法来取得数据库字段的值了。实际上，<span lang="EN-US">MappedEntity</span>使用了一个<span lang="EN-US">Map</span>并以数据库列名为<span lang="EN-US">Key</span>对应的值为<span lang="EN-US">Value</span>来保存查询的结果。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">由于<span lang="EN-US">JFox JPA</span>使用的<span lang="EN-US">SQLTemplate</span>对<span lang="EN-US">ID</span>没有特别的要求，所以<span lang="EN-US">@Id</span>没有意义，所以字段只需要用<span lang="EN-US">@Column</span>描述即可，你会惊喜的发现，<span lang="EN-US">JFox JPA</span>只需要你熟悉非常少数的几个<span lang="EN-US">JPA Annotation</span>就可以完成所有的操作。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Column and
@MappingColumn</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Column</span><span style="font-family: 宋体;">是<span lang="EN-US">JPA</span>的标准<span lang="EN-US">Annotation</span>，用来描述类字段和数据库字段的映射，在<span lang="EN-US">JFox 3</span>中，只需要指明<span lang="EN-US"> name </span>属性即可。<span lang="EN-US">JFox JPA</span>会<span lang="EN-US">@Column</span>所描述的字段的类型将取回的数据转换成正确的类型。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@MappingColumn</span><span style="font-family: 宋体;">是<span lang="EN-US">JFox</span>扩展的<span lang="EN-US">Annotation</span>，用来描述关系字段，需要设置<span lang="EN-US">namedQuery</span>和<span lang="EN-US">params</span>两个属性，在容器构造<span lang="EN-US">Entity</span>对象时，会通过<span lang="EN-US">@MappingColumn</span>的<span lang="EN-US">nameQuery</span>和<span lang="EN-US">params</span>构造查询来获得所映射的对象，并为所描述的<span lang="EN-US">Field</span>赋值。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@MappingColumn</span><span style="font-family: 宋体;">的定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">FIELD,</span></i></b> ElementType.<b><i><span style="color: rgb(102, 14, 122);">METHOD}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">MappingColumn </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">用来查询的<span lang="EN-US"> query</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String namedQuery();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">传给<span lang="EN-US"> namedQuery </span>的参数，要引用改<span lang="EN-US">Entity</span>，使用<span lang="EN-US">$this</span>，比如<span lang="EN-US"> $this.getId()</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">ParameterMap[</span>] params() <b><span style="color: navy;">default</span></b> {};</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是一个使用<span lang="EN-US">@Column</span>和<span lang="EN-US">@MappingColumn</span>描述的<span lang="EN-US">Entity</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Entity</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> Account {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ACC_ID"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">long</span></b> <b><span style="color: rgb(102, 14, 122);">id;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ACC_FIRST_NAME"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">firstName;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ACC_LAST_NAME"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">lastName;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"ACC_EMAIL"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">mail;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@MappingColumn(</span>namedQuery = AddressDAO.<b><i><span style="color: rgb(102, 14, 122);">GET_ADDRESS_BY_ACCOUNT_ID,</span></i></b> </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params = {<span style="color: olive;">@ParameterMap(</span>name = <span style="color: blue;">"accountId"</span>,value=<span style="color: blue;">"$this.getId()"</span>)})</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Address <b><span style="color: rgb(102, 14, 122);">address;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">解释一下其中的<span lang="EN-US">@MappingColumn</span>，<span lang="EN-US">namedQuery</span>指明了用来查询<span lang="EN-US">Address</span>的<span lang="EN-US">NamedNativeQuery</span>的名称，看一下<span lang="EN-US">AddressDAO</span>中定义的名为</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">AddressDAO.<b><i><span style="color: rgb(102, 14, 122);">GET_ADDRESS_BY_ACCOUNT_ID</span></i></b></span><span style="font-family: 宋体;">的<span lang="EN-US">NamedNativeQuery</span>，它的定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span>name = AddressDAO.<b><i><span style="color: rgb(102, 14, 122);">GET_ADDRESS_BY_ACCOUNT_ID,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"select * from address where ADR_ACC_ID = $accountId"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resultClass = Address.<b><span style="color: navy;">class</span></b>)</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以看出，这个<span lang="EN-US">query</span>需要一个参数<span lang="EN-US">$accountId</span>，所以需要在<span lang="EN-US">@MappingColumn</span>的<span lang="EN-US">params</span>用<span lang="EN-US">@ParameterMap</span>指定这个参数，参数名为<span lang="EN-US">accountId</span>，值为<span lang="EN-US">$this.getId()</span>，<span lang="EN-US">$this</span>是<span lang="EN-US">JFox
JPA</span>的<span lang="EN-US">SQLTemplate</span>中的特殊变量，用来指该<span lang="EN-US">Entity</span>，上例中即指<span lang="EN-US">Account</span>对象。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@MappingColumn</span><span style="font-family: 宋体;">的<span lang="EN-US">params</span>属性是一个<span lang="EN-US">@ParameterMap</span>数组，如果<span lang="EN-US">query</span>中需要多个参数，则需要指定多个<span lang="EN-US">@ParameterMap</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">注意：<span lang="EN-US">@Column </span>的<span lang="EN-US">name</span>属性实际上指的是<span lang="EN-US"> SQL </span>查询结果<span lang="EN-US">ResultSet</span>中的列名，所以如果<span lang="EN-US">@Column</span>的<span lang="EN-US">name</span>保持和数据库列名一致，那么在查询时就要慎用<span lang="EN-US">”as”</span>；而所以如果数据库中表的列名和<span lang="EN-US">@Column</span>指定的名称和不匹配，则构建查询时可以通过<span lang="EN-US">”as”</span>建立别名来和<span lang="EN-US">@Column</span>保持一致。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">对于<span lang="EN-US">Lob</span>大字段，在<span lang="EN-US">JFox JPA</span>与一般的字段没有不同，不需要使用<span lang="EN-US">@Lob</span>来标注，看下面的代码。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> jfox.test.ejb3.lob;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.persistence.Column;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">javax.persistence.Entity;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Entity</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> Lobber {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"id"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">long</span></b> <b><span style="color: rgb(102, 14, 122);">id;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"blobby"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">byte</span></b>[] <b><span style="color: rgb(102, 14, 122);">blobby;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Column(</span>name=<span style="color: blue;">"clobby"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String <b><span style="color: rgb(102, 14, 122);">clobby;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">long</span></b> getId() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">id;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setId(<b><span style="color: navy;">long</span></b> id) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">id </span></b>= id;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getClobby() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">clobby;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setClobby(String clobby) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">clobby </span></b>= clobby;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">byte</span></b>[] getBlobby() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">blobby;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setBlobby(<b><span style="color: navy;">byte</span></b>[] blobby) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">blobby </span></b>= blobby;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">DataSource</span></b><b><span style="font-family: 宋体;">和<span lang="EN-US">Cache</span></span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox JPA</span><span style="font-family: 宋体;">使用<span lang="EN-US">XAPool(<a href="http://xapool.objectweb.org/">http://xapool.objectweb.org</a>)</span>提供的<span lang="EN-US">XADatasource</span>来支持连接池以及和<span lang="EN-US">Transaction Manager</span>协作以支持事务处理。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">数据源的配置通过修改<span lang="EN-US">persistence.xml</span>来完成，<span lang="EN-US">persistence.xml</span>的格式是由<span lang="EN-US">JPA</span>的标准定义的，它的配置已经在上面讲过。下面再展示了一下<span lang="EN-US">persistence.xml
</span>的配置。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence-unit</span> <span style="color: blue;">name=</span><span style="color: green;">"default"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">jta-data-source</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java:/DefaultMySqlDS</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">jta-data-source</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"driver"</span> <span style="color: blue;">value=</span><span style="color: green;">"com.mysql.jdbc.Driver"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"url"</span> <span style="color: blue;">value=</span><span style="color: green;">"jdbc:mysql://localhost:3306/test"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"username"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"password"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"minSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- min pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"200"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"lifeTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"1800000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- 3h, connection max idle time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"sleepTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp; <i><span style="color: gray;">&lt;!--PoolKeeper sleep time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockRetryWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"2000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- retry time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockMaxWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"60000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max wait time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"checkLevelObject"</span> <span style="color: blue;">value=</span><span style="color: green;">"4"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- check connection closed --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.algorithm"</span> <span style="color: blue;">value=</span><span style="color: green;">"LRU"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- algorithm for "default" cache category, LRU, LFU, FIFO--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.ttl"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- ttl for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxIdleTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"300000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- maxidletime for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max size for "default" --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxMemorySize"</span> <span style="color: blue;">value=</span><span style="color: green;">"100000000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max memory size for "default", in bytes--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence-unit</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">这里主要解释一下了<span lang="EN-US">JFox JPA</span>的<span lang="EN-US">Cache</span>。<span lang="EN-US">JFox JPA</span>的<span lang="EN-US">Cache</span>是基于<span lang="EN-US">SQL Statement </span>来实现的，工作原理如下：执行一个<span lang="EN-US">Statement</span>之后，比如<span lang="EN-US">Select</span>语句，<span lang="EN-US">JFox</span>会将结果集缓存，如果下次进行同样的查询时，将直接从返回内存中缓存的结果集，判断是否是相同的查询的条件包括同样的<span lang="EN-US">SQL</span>语句以及参数；而一旦对这些数据进行过写的操作，<span lang="EN-US">JFox</span>会将缓存的结果集销毁，下次查询时，将重新访问数据库，并重建缓存。这样的<span lang="EN-US">Cache</span>的设计简单、高效，易于维护，并有效的避免了脏数据的产生。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox JPA Cache</span><span style="font-family: 宋体;">有一个重要的概念，分区<span lang="EN-US">(Partition)</span>。分区是为了细分<span lang="EN-US">Cache</span>的区域，使得能够以更小的粒度重建<span lang="EN-US">Cache</span>，避免频繁的重建整个<span lang="EN-US">Cache</span>而降低了<span lang="EN-US">Cache</span>的工作效率。分区在<span lang="EN-US"> @NamedNativeQuery</span>中使用<span lang="EN-US"> @hints</span>来配置。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = AccountDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">GET_USERNAME_LIST,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"select username as userid from signon"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resultClass = String.<b><span style="color: navy;">class</span></b>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hints = {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@QueryHint(</span>name = <span style="color: blue;">"cache.partition"</span>, value = <span style="color: blue;">"account"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = AccountDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">UPDATE_ACCOUNT,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"update account set "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"email = $account.getEmail(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"firstname = $account.getFirstName(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"lastname = $account.getLastName(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"status = $account.getStatus(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"addr1 = $account.getAddress1(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"addr2 = $account.getAddress2(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"city = $account.getCity(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"state = $account.getState(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"zip = $account.getZip(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"country = $account.getCountry(), "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"phone = $account.getPhone() "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"where "</span> +</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">"userid = $account.getUsername()"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hints = {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@QueryHint(</span>name = <span style="color: blue;">"cache.partition"</span>, value = <span style="color: blue;">"account"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 30 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Cache</span><span style="font-family: 宋体;">的销毁和重建是分区<span lang="EN-US">(partition)</span>为单位的，比如上面的例子，当有用户修改了<span lang="EN-US">Acount</span>信息时，也就是<span lang="EN-US">query </span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">AccountDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">UPDATE_ACCOUNT</span></i></b></span><span style="font-family: 宋体;">被执行时，只会销毁<span lang="EN-US">account</span>分区的<span lang="EN-US">Cache</span>，而有其它的<span lang="EN-US">Cache(</span>如<span lang="EN-US">Product</span>、<span lang="EN-US">Order)</span>则不会收到影响。所以合理的使用分区，将能大大提高应用程序的性能。比如：把很少被修改的数据，放在一个分区中；而把因为会被经常修改而需要重载的数据分别放在多个较小粒度的分区当中就是一个不错的做法。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">JFox</span>管理控制台中可以查看<span lang="EN-US">Cache</span>的使用情况，以及手动销毁<span lang="EN-US">Cache</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">ID</span></b><b><span style="font-family: 宋体;">生成器</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">一些<span lang="EN-US">O/R Mapping</span>工具都提供了多种<span lang="EN-US">ID</span>生成方式，比如：建立<span lang="EN-US">ID</span>生成表或使用<span lang="EN-US">Sequence</span>等。<span lang="EN-US">JFox
JPA</span>提供了完全基于时间的<span lang="EN-US">ID</span>生成器<span lang="EN-US">org.jfox.entity.dao.PKGenerator</span>，根据时间生成一个<span lang="EN-US">19</span>位的<span lang="EN-US">long</span>型数字，如：<span lang="EN-US">2006080816404856650</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果要使用<span lang="EN-US">JFox JPA</span>提供的<span lang="EN-US">ID</span>生成器，请讲数据库表的<span lang="EN-US">ID</span>字段设为相应的类型，如：<span lang="EN-US">NUMBER(19)</span>或<span lang="EN-US">NUMERIC(19)</span>，而对应的<span lang="EN-US">Java</span>类型为<span lang="EN-US">long</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">DAOSupport</span><span style="font-family: 宋体;">的<span lang="EN-US">nextPK()</span>方法使用<span lang="EN-US">PKGenerator</span>生成<span lang="EN-US">PK</span>。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* PK </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">只保证唯一，不包含任何业务意义，比如：对于<span lang="EN-US"> ID </span>连续性的要求</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">long</span></b> nextPK() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> PKGenerator.<i>getInstance(</i>).nextPK();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">注意：由于<span lang="EN-US">ID</span>生成器依赖于系统时间，所以需要在系统上线时调整好系统时间，如果今后把系统时间改为已过去的时间，则可能造成<span lang="EN-US">ID</span>重复的危险；另外，由于<span lang="EN-US">JFox JPA</span>采用的是基于<span lang="EN-US">SQLTemplate</span>的实现，所以并不需要对<span lang="EN-US">ID</span>字段做特殊处理，对于对于<span lang="EN-US">ID</span>字段并不需要用<span lang="EN-US">@Id</span>来标注。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">DAO</span></b><b><span style="font-family: 宋体;">（<span lang="EN-US">Data Access Object</span></span></b><span style="font-family: 宋体;">）</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">EJB3</span><span style="font-family: 宋体;">中，<span lang="EN-US">DAO</span>显得尤为重要，因为需要通过<span lang="EN-US">DAO</span>注入<span lang="EN-US">JPA Persistence Context</span>，以让<span lang="EN-US">JPA</span>容器和<span lang="EN-US">EJB</span>容器协作，推荐将<span lang="EN-US">DAO</span>实现为<span lang="EN-US">Stateless
Session Bean</span>，使用<span lang="EN-US">@PersistenceContext</span>注入<span lang="EN-US">EntityManager</span>以获得操作<span lang="EN-US">Entity</span>的能力。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">已经封装好了<span lang="EN-US">DAOSupport</span>超类，提供了<span lang="EN-US">newEntityObject</span>、<span lang="EN-US">createNativeQuery</span>和生成<span lang="EN-US">ID</span>的方法，还定义了<span lang="EN-US">getEntityManager</span>抽象方法，由子类提供<span lang="EN-US">EntityManager</span>实例。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是<span lang="EN-US">DAOSupport</span>的代码：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.entity.dao;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.util.HashMap;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.util.Map;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> javax.persistence.EntityManager;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.entity.EntityFactory;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.entity.MappedEntity;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.entity.QueryExt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* DAOSupport</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">，封装了<span lang="EN-US"> DAO </span>的基本操作</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">需要由子类提供<span lang="EN-US">EntityManager</span>，在<span lang="EN-US"> getEntityManager</span>方法中返回</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* DAO </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">应该都从<span lang="EN-US"> DAOSupport </span>继承，并且实现为<span lang="EN-US"> Stateless Local SessionBean</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* DAO </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可以脱离容器运行，此时不能使用<span lang="EN-US">@PersistenceContext</span>注入，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">而只能通过<span lang="EN-US">javax.persistence.Persistence</span>的静态方法来构造</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Yang Yong</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">abstract</span></b> <b><span style="color: navy;">class</span></b> DAOSupport <b><span style="color: navy;">implements</span></b> DataAccessObject {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">返回<span lang="EN-US"> EntityManager</span>，由子类使用<span lang="EN-US"> @PersistenceContext </span>注入</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> <b><span style="color: navy;">abstract</span></b> EntityManager getEntityManager();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">根据<span lang="EN-US"> Entity Class</span>生成<span lang="EN-US"> Entity</span>对象</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> entityClass entity class</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> &lt;T&gt; T newEntityObject(Class&lt;T&gt; entityClass) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <i>newEntityObject(</i>entityClass, <b><span style="color: navy;">new</span></b> HashMap&lt;String,Object&gt;());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">使用数据<span lang="EN-US"> Map</span>，生成<span lang="EN-US"> Entity</span>对象，<span lang="EN-US">Map</span>的<span lang="EN-US">key</span>和<span lang="EN-US">Entity</span>的<span lang="EN-US">Column</span>对应</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> entityClass entity class</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> dataMap data dataMap</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> &lt;T&gt; T newEntityObject(<b><span style="color: navy;">final</span></b> Class&lt;T&gt; entityClass, <b><span style="color: navy;">final</span></b> Map&lt;String, Object&gt; dataMap) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> EntityFactory.<i>newEntityObject(</i>entityClass, dataMap);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">给定<span lang="EN-US">query name </span>创建<span lang="EN-US"> NamedNativeQeury</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> queryName query name</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">53 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">final</span></b> QueryExt createNamedNativeQuery(String queryName) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">54 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (QueryExt)getEntityManager().createNamedQuery(queryName);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">55 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">56 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">57 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">58 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">给定<span lang="EN-US"> sql </span>构造<span lang="EN-US"> Qeury</span>，<span lang="EN-US">Result</span>类型为<span lang="EN-US">MappedEntity</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">59 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> sql native sql template</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">60 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">61 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">final</span></b> QueryExt createNativeQuery(String sql) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">62 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> createNativeQuery(sql, MappedEntity.<b><span style="color: navy;">class</span></b>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">63 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">64 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">65 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">66 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">给定<span lang="EN-US"> sql </span>构造<span lang="EN-US"> Qeury</span>，<span lang="EN-US">Result</span>类型为<span lang="EN-US">resultClass</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">67 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> sql native sql template</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">68 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> resultClass </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">返回的结果对象类型</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">69 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">70 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">final</span></b> QueryExt createNativeQuery(String sql, Class&lt;?&gt; resultClass) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">71 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (QueryExt)getEntityManager().createNativeQuery(sql, resultClass);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">72 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">73 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">74 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">75 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">生成<span lang="EN-US">19</span>的<span lang="EN-US">PK</span>，比如：<span lang="EN-US">2006080816404856650</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">76 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* PK </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">只保证唯一，不包含任何业务意义，比如：对于<span lang="EN-US"> ID </span>连续性的要求</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">77 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">78 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">long</span></b> nextPK() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">79 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> PKGenerator.<i>getInstance(</i>).nextPK();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">80 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">81 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">82 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">83 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的代码取自<span lang="EN-US">JFox Petstore</span>提供的<span lang="EN-US">CategoryDAOImpl</span>。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.petstore.dao;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.sql.SQLException;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.util.List;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> javax.persistence.EntityManager;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.persistence.NamedNativeQueries;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.persistence.NamedNativeQuery;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.persistence.PersistenceContext;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.entity.dao.DAOSupport;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.petstore.entity.Category;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@NamedNativeQueries(</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = CategoryDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"select catid, name, descn from category where catid = $id"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resultClass = Category.<b><span style="color: navy;">class</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@NamedNativeQuery(</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = CategoryDAOImpl.<b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY_LIST,</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query = <span style="color: blue;">"select catid, name, descn from category"</span>,</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resultClass = Category.<b><span style="color: navy;">class</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CategoryDAOImpl <b><span style="color: navy;">extends</span></b> DAOSupport <b><span style="color: navy;">implements</span></b> CategoryDAO{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">final</span></b> String <b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY </span></i></b>= <span style="color: blue;">"getCategory"</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">final</span></b> String <b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY_LIST </span></i></b>= <span style="color: blue;">"getCategoryList"</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@PersistenceContext(</span>unitName = <span style="color: blue;">"JPetstoreMysqlDS"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;EntityManager <b><span style="color: rgb(102, 14, 122);">em;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> EntityManager getEntityManager() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">em;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Category getCategory(String categoryId) <b><span style="color: navy;">throws</span></b> SQLException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (Category)createNamedNativeQuery(<b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY)</span></i></b>.setParameter(<span style="color: blue;">"id"</span>,categoryId).getSingleResult();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> List&lt;Category&gt; getCategoryList() <b><span style="color: navy;">throws</span></b> SQLException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> (List&lt;Category&gt;)createNamedNativeQuery(<b><i><span style="color: rgb(102, 14, 122);">GET_CATEGORY_LIST)</span></i></b>.getResultList();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">53 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">54 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">55</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">CategoryDAOImpl</span><span style="font-family: 宋体;">继承了<span lang="EN-US">DAOSupport</span>，并实现<span lang="EN-US">CategoryDAO</span>，标注成<span lang="EN-US"> @Stateless </span>和<span lang="EN-US"> @Local</span>，并使用<span lang="EN-US">@NamedNativeQuery</span>定义了<span lang="EN-US">query</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">其它的<span lang="EN-US">EJB</span>使用<span lang="EN-US">CategoryDAO</span>时，可以通过<span lang="EN-US">@EJB</span>注入：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.util.List;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.util.Collections;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.EJB;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Stateless;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.Local;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.petstore.dao.CategoryDAO;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.petstore.entity.Category;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Stateless</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Local</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CategoryBOImpl <b><span style="color: navy;">implements</span></b> CategoryBO{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">CategoryDAO <b><span style="color: rgb(102, 14, 122);">categoryDAO;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Category getCategory(String categoryId) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">categoryDAO.</span></b>getCategory(categoryId);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b>(Exception e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: navy;">null</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> List&lt;Category&gt; getCategoryList() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">categoryDAO.</span></b>getCategoryList();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b>(Exception e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> Collections.<i>emptyList(</i>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;">如何分页</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">分页是查询中的普遍问题，<span lang="EN-US">JPA</span>的<span lang="EN-US">Query</span>接口中已经提供了两个方法以方便在查询的时候实现分页，它们分别是：</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Query.setFirstResult(int&nbsp;startPosition)</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Query.setMaxResults(int&nbsp;maxResult)</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; setFirstResult</span><span style="font-family: 宋体;">用来设置取值的起始位置，从<span lang="EN-US">0</span>开始计数；<span lang="EN-US">setMaxResults</span>用来设置取多少行记录。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">利用这两个方法，便可以轻松进行分页了，下面的例子展示了分页的用法：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> List&lt;Account&gt; accounts = <b><i><span style="color: rgb(102, 14, 122);">em.</span></i></b>createNativeQuery(<span style="color: blue;">"select * from account"</span>, Account.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .setFirstResult(<span style="color: blue;">2</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .setMaxResults(<span style="color: blue;">2</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getResultList();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">需要注意的是：<span lang="EN-US">JFox</span>实现分页时，采用的并不是物理分页，而是使用<span lang="EN-US">JDBC ResultSet</span>的游标定位来实现的，一般情况下可以满足对性能的要求，但是如果你期望获得最大的性能，则建议根据不同的数据库构造<span lang="EN-US">SQL</span>语句来实现。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;">了解<span lang="EN-US">JFox JPA</span>局限</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox JPA</span><span style="font-family: 宋体;">采用的是基于<span lang="EN-US">SQLTemplate</span>的实现，<span lang="EN-US">SQLTempalte</span>被证明是一种简单直接的持久化方式，它能满足企业应用对<span lang="EN-US">O/R</span>的需求，并提供了更好的可控性，方便应对复杂的数据库问题以及后期的查错和调优，而<span lang="EN-US">JFox
JPA</span>在保持<span lang="EN-US">SQLTemplate</span>特性的前提下，提供了与<span lang="EN-US">JPA</span>接口的兼容，同时，由于<span lang="EN-US">SQLTemplate</span>的特性，有些<span lang="EN-US">JPA</span>内容则没有必要或者不需要去实现。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox JPA</span><span style="font-family: 宋体;">没有实现的主要有：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Id</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">persist, merge, remove</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">EJBQL</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">EntityListener </span><span style="font-family: 宋体;">和<span lang="EN-US"> callback</span></span></p>

<p class="MMTopic2"><a name="_Toc171745404"><span style="font-family: 宋体;" lang="EN-US">5.2 JFox</span></a><span style="font-family: 宋体;">微内核</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">微内核是<span lang="EN-US">JFox</span>应用服务器的基础结构，提供了<span lang="EN-US">IoC</span>注入、<span lang="EN-US">Interceptor</span>、面向组件编程以及模块化能力，<span lang="EN-US">JFox</span>采用的是自主研发的<span lang="EN-US">IoC</span>微内核，存在于包<span lang="EN-US"> org.jfox.framework</span>下，它和<span lang="EN-US">JFox</span>应用服务器一起，经过了反复的重构和改进。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">了解<span lang="EN-US">JFox</span>内核，将能够更好的理解<span lang="EN-US">JFox</span>应用服务器的工作机制，以及基于内核编写新的服务扩展<span lang="EN-US">JFox</span>应用服务器的功能。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要了解<span lang="EN-US">JFox</span>基于<span lang="EN-US">IoC</span>的微内核，需要了解几个重要的概念：<span lang="EN-US">Framework</span>、<span lang="EN-US">Module </span>、<span lang="EN-US">Component</span>。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Framework</span><span style="font-family: 宋体;">用来负责启动以及停止内核，同时它也管理整个微内核的资源，以及负责出发和传递事件。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Module</span><span style="font-family: 宋体;">是模块，一个模块用来完成一个领域的问题，模块拥有封闭性，通过发布接口和其它模块进行交互，模块有自己个独立的<span lang="EN-US">ClassLoader</span>。<span lang="EN-US">Framework</span>会根据<span lang="EN-US">web.xml</span>中的<span lang="EN-US">MODULES_DIR</span>配置加载多个模块，<span lang="EN-US">Framework</span>将本身也加载为一个模块，模块名为<span lang="EN-US">__SYSTEM_MODULE__</span>。在后面的<span lang="EN-US">JFox Module</span>一章中，你将看到看到可以将一个应用模块做一个<span lang="EN-US">Module</span>发布到<span lang="EN-US">JFox</span>应用服务器中。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Component </span><span style="font-family: 宋体;">即为一个组件，用来实现一个特定的功能，组件被实现为<span lang="EN-US">Java</span>类，它们都从<span lang="EN-US">org.jfox.frameowkr.component.Component</span>继承而来，组件总是被加载在一个模块中。</span></p>

<h3><a name="_Toc171745405"><span style="font-family: 宋体;" lang="EN-US">5.2.1 Component</span></a></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.Component</span><span style="font-family: 宋体;">只是一个申明类，并没有定义任何方法，但是所有的组件都应该实现该接口，<span lang="EN-US">JFox</span>内核会根据该接口判断组件的有效性。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">有四个接口直接继承了<span lang="EN-US">Component</span>接口，用来定义不同类型的组件，他们分别是 ：</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.SingltonComponent</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.ActiveComponent</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.InterceptableComponent</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.RunnableComponent</span></p>

<p class="MsoNormal" style="margin-left: 42pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">SingltonComponent</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">SingltonComponent</span><span style="font-family: 宋体;">通过接口来强制了<span lang="EN-US">Component</span>的构造行为，<span lang="EN-US">SingletonComponent</span>表明该组件总是单例的，而忽略<span lang="EN-US">@Service(singlton=false)</span>描述。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果一个<span lang="EN-US">Component</span>没有实现<span lang="EN-US">SingltonComponent</span>接口，也可以通过<span lang="EN-US">@Service(singleton=true)</span>来指明该组件是单例的，而当父类想强制其子类均应该为单例时，则在父类中实现<span lang="EN-US">SingletonComponent</span>接口是更好的方式。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">ActiveComponent</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">ActiveComponent</span><span style="font-family: 宋体;">表明该组件是活跃的，意味着该组件在由<span lang="EN-US">IoC</span>容器加载之后，会立即进行实例化，这对于一些需要立即提供服务的组件是有用的，比如<span lang="EN-US">JFox</span>的<span lang="EN-US">EJB</span>容器就是实现了该接口，以便加载即服务。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">和<span lang="EN-US">SingletonCompnent</span>一样，也可以用<span lang="EN-US">@Service(active=true)</span>来描述一个组件为<span lang="EN-US">Active</span>，而如果父类想强制其子类均应为<span lang="EN-US">Active</span>时，则在父类中实现<span lang="EN-US">ActiveComponent</span>接口更好。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">InterceptableComponent</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">InterceptableComponent</span><span style="font-family: 宋体;">定义了两个新的方法，以在执行<span lang="EN-US">Component</span>方法前后进行进行拦截，这两个新的方法是：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.component;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.reflect.Method;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可进行方法拦截的组件。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">实现该接口的组件，在执行器方法的时候，可以在方法执行前后，进行额外的操作，比如：进行日志记录</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">注意：该功能通过<span lang="EN-US">Java</span>动态代理技术实现</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> InterceptableComponent <b><span style="color: navy;">extends</span></b> Component{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* do something before invoke a method defined in component interface</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* example: want to log, or repack the params</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> method method to invoke</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> params parameter array</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> true/false, if false, will not invoke the method</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">boolean</span></b> preInvoke(Method method, Object[] params);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* do something after invoke a method example: want to repack the result</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> method method invoked</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> params parameter array</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> result result return by the method</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> exception if throws exception</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> the last object return, may not be the result parameter</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Object postInvoke(Method method, Object[] params, Object result, Throwable exception);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">如果需要在执行方法前后进行拦截工作，比如进行日志，那么可以实现<span lang="EN-US">InterceptableComponent</span>接口。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; preInvoke</span><span style="font-family: 宋体;">如果返回<span lang="EN-US">false</span>，将会拒绝执行<span lang="EN-US">Component</span>的方法，并抛出异常。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">RunnableComponent</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">RunnableComponent</span><span style="font-family: 宋体;">继承了<span lang="EN-US">java.lang.Runnable</span>接口，如果你需要编写一个提供服务的线程组件，比如<span lang="EN-US">Socket
Server</span>，那么可以直接实现<span lang="EN-US">RunnableComponent</span>接口。</span></p>

<h3><a name="_Toc171745406"></a><span style="font-family: 宋体;" lang="EN-US">5.2.2</span><span style="font-family: 宋体;" lang="EN-US"> ComponentContext</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">ComponentContext</span><span style="font-family: 宋体;">用来描述组件上下文环境，通过<span lang="EN-US">ComponentContext</span>可以得到<span lang="EN-US">Component</span>相关信息<span lang="EN-US">(</span>比如：<span lang="EN-US">Component Id)</span>，也可以用来和内核进行交互<span lang="EN-US">(</span>比如：根据<span lang="EN-US"> id </span>和接口来查找其它的组件，用来发出<span lang="EN-US">ComponentEvent)</span>等。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果你想访问<span lang="EN-US">ComponentContext</span>，通过实现<span lang="EN-US">ComponentInitialization</span>接口，并在<span lang="EN-US">postConstruct</span>方法中可以传入，<span lang="EN-US">ComponentInitialization</span>在后面会讲到。</span></p>

<h3><a name="_Toc171745407"></a><span style="font-family: 宋体;" lang="EN-US">5.2.3 A</span><span style="font-family: 宋体;" lang="EN-US">nnotation</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">与一般<span lang="EN-US">IoC</span>容器采用<span lang="EN-US">xml</span>配置不同，<span lang="EN-US">JFox
IoC</span>容器全部采用<span lang="EN-US">JDK5</span>的<span lang="EN-US">Annotation</span>来标注组件的属性以及依赖关系，一共有<span lang="EN-US">4</span>个<span lang="EN-US">Annotation</span>：<span lang="EN-US">@Service</span>，<span lang="EN-US">@Exported</span>，<span lang="EN-US">@Inject</span>，<span lang="EN-US">@Constant</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Service</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; @Service</span><span style="font-family: 宋体;">用来描述一个<span lang="EN-US">Component</span>以注册到<span lang="EN-US">IoC</span>容器中，组件实现完之后，必须使用<span lang="EN-US">@Service</span>标注才能被内核加载。<span lang="EN-US">IoC</span>容器启动时，会搜索<span lang="EN-US">classpath</span>中所有描述了<span lang="EN-US">@Service </span>的类，将合法的<span lang="EN-US">Component</span>按要求注册到<span lang="EN-US">IoC</span>容器中。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; Component</span><span style="font-family: 宋体;">在注册到容器之后，均会被分配一个<span lang="EN-US"> Component Id</span>，<span lang="EN-US">Component Id</span>可以由<span lang="EN-US">@Service </span>的<span lang="EN-US"> id </span>属性指定，如未指定，则为<span lang="EN-US">Component</span>实现类的类名的简称<span lang="EN-US">(Class.getSimpleName())</span>，<span lang="EN-US">Component Id</span>用来在<span lang="EN-US">IoC</span>容器中精确查找一个组件。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; @Service</span><span style="font-family: 宋体;">的定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">描述在<span lang="EN-US"> Component </span>上以便将该<span lang="EN-US"> Component </span>发布至<span lang="EN-US">IoC</span>容器中</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">TYPE}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">Service </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">该组件实现的接口，组件只能通过指定的接口来访问，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">如果没有指定接口呢，则为所有接口</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Class[] interfaces() <b><span style="color: navy;">default</span></b> {};</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">部署的<span lang="EN-US"> id</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Default </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">为<span lang="EN-US">Component</span>实现类的类名的简称</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String id() <b><span style="color: navy;">default</span></b> <span style="color: blue;">""</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">是否在<span lang="EN-US"> getInstance </span>时，才实例化</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">否则，在部署之后，立即进行实例化</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">boolean</span></b> active() <b><span style="color: navy;">default</span></b> <b><span style="color: navy;">false</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">是否单例，单例表示该组件只能部署一次</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">boolean</span></b> singleton() <b><span style="color: navy;">default</span></b> <b><span style="color: navy;">true</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">优先级，在一个模块中组件，优先级值小的会被加载</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> priority() <b><span style="color: navy;">default</span></b> <span style="color: blue;">50</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">描述信息</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String description() <b><span style="color: navy;">default</span></b> <span style="color: blue;">""</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Service</span><span style="font-family: 宋体;">的<span lang="EN-US">active</span>和<span lang="EN-US">singleton</span>属性比<span lang="EN-US">ActiveComponent</span>、<span lang="EN-US">SingletonComponent</span>接口的优先级低，如果组件实现了以上接口，对应的<span lang="EN-US">active</span>和<span lang="EN-US">singleton</span>将不起作用。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Inject</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Inject</span><span style="font-family: 宋体;">用来标注组件的<span lang="EN-US">Field</span>，以使得该组件在实例化的时候，由<span lang="EN-US">IoC</span>容器进行依赖注入。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">用来标注一个组件的<span lang="EN-US">Field</span>，以使得该组件在实例化的时候，由<span lang="EN-US">IoC</span>容器进行依赖注入</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">FIELD}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">Inject </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">注入的组件的类型</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">如果未指定，则由<span lang="EN-US">IoC</span>容器根据<span lang="EN-US">Filed</span>的类型判断</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Class type() <b><span style="color: navy;">default</span></b> FieldType.<b><span style="color: navy;">class</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">通过<span lang="EN-US"> component id</span>进行注入</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String id() <b><span style="color: navy;">default</span></b> <span style="color: blue;">""</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">class</span></b> FieldType {}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以通过<span lang="EN-US">type</span>和<span lang="EN-US">id</span>进行注入，<span lang="EN-US">type</span>会通过给定的接口注入满足条件的组件，如果有多个组件满足要求，将会抛出异常；<span lang="EN-US">id</span>则提供根据<span lang="EN-US">Component Id</span>进行精确注入。如果均没有指定，将根据所描述的<span lang="EN-US">Field</span>的<span lang="EN-US">Type</span>进行注入。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Constant</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Constant</span><span style="font-family: 宋体;">用来为<span lang="EN-US">Field</span>注入常量，注入的常量值用 <span lang="EN-US">@Constant</span>的<span lang="EN-US">value </span>属性指定，<span lang="EN-US">value </span>的值实际为一个<span lang="EN-US">Velocity</span>表达式，会使用<span lang="EN-US"> Velocity </span>模板引擎并使用在<span lang="EN-US"> global.properties</span>中定义的全局占位符进行解析，这使得可以动态注入常量，弥补了<span lang="EN-US">Annotaion</span>相对<span lang="EN-US">XML</span>配置在编译时确定的弱点，增加了程序的动态配置能力。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Constant</span><span style="font-family: 宋体;">的定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">注入一个常量，可以使用<span lang="EN-US"> placeholder</span>，<span lang="EN-US">placeholder</span>由<span lang="EN-US"> global.properties </span>导入</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">FIELD}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">Constant </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">对于值注射时，值的对象类型，默认为<span lang="EN-US">Field</span>本身的类型</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Class type() <b><span style="color: navy;">default</span></b> FieldType.<b><span style="color: navy;">class</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">注射一个固定的值，可以带有占位符<span lang="EN-US">(</span>如：<span lang="EN-US">${database.driver})</span>，会在注入之前使用<span lang="EN-US">Velocity</span>解析</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String value() <b><span style="color: navy;">default</span></b> <span style="color: blue;">""</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">由解析器负责根据<span lang="EN-US"> Enjection </span>描述的<span lang="EN-US"> Field/Constructor </span>来判断真实的<span lang="EN-US"> type</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">class</span></b> FieldType {}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">global.properties </span>中定义全局占位符，目前<span lang="EN-US">global.properties</span>的内容如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">#----- JFOX3 Default Gloable PlaceHolder definition, don't delete ------</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">3 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"># jta transaction timetou, in second, used in SimpleEJB3Container</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">jta_transaction_timeout</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">=<b><span style="color: green;">60</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">7 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">#----- user placeholder definition here ---------</span></i></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">SimpleEJB3Container</span>中使用了定义<span lang="EN-US">jta_transaction_timeout</span>常量：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// default Transaction timeout</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Constant(</span>type = Integer.<b><span style="color: navy;">class</span></b>, value = <span style="color: blue;">"$jta_transaction_timeout"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> <b><span style="color: navy;">int</span></b> <b><span style="color: rgb(102, 14, 122);">transactionTimeout </span></b>= <span style="color: blue;">60</span>; <span style="color: gray;">// default transaction timeout 60 seconds</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">那么<span lang="EN-US">SimpleEJB3Container</span>实例化时，会将<span lang="EN-US">$jta_transaction_timeout</span>替换成<span lang="EN-US">global.properties</span>中配置的值，然后进行注入。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">更多关于全局占位符的内容在下面还将讨论。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">@Exported</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">由于<span lang="EN-US">JFox IoC</span>容器设计支持模块化，不同的模块使用不同<span lang="EN-US">ClassLoader</span>来加载，所以模块之间是隔离的，如果要使一个模块中的接口能够被其它的模块引用，则需要使用<span lang="EN-US">@Exported</span>来标注，<span lang="EN-US">@Exported</span>标注的接口能在不同模块的类加载器之间共享。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Export</span><span style="font-family: 宋体;">的定义如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* Exported</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">用来标注一个<span lang="EN-US">Component </span>接口，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">标注了的<span lang="EN-US">Component</span>接口将能够被所有的模块发现，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">所以如果一个<span lang="EN-US">Component</span>要跨模块提供服务，则需要将服务接口使用<span lang="EN-US"> @Exported </span>描述</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">描述了<span lang="EN-US"> Exported </span>的接口在<span lang="EN-US"> Module reload </span>的时候，也不会重新加载</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* Exported </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">描述在<span lang="EN-US">Class</span>上，没有意义</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">TYPE}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">Exported </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">23 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">比如</span><span style="font-family: 宋体;">：<span lang="FR">JAASLoginService </span></span><span style="font-family: 宋体;">组件使用</span><span style="font-family: 宋体;" lang="FR">@Exported</span><span style="font-family: 宋体;">进行了标注</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">这样</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">其它的模块才能引用它，以便使用它提供的</span><span style="font-family: 宋体;" lang="FR">JAAS</span><span style="font-family: 宋体;">登录服务。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Exported</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <b><span style="color: navy;">interface</span></b> JAASLoginService <b><span style="color: navy;">extends</span></b> Component</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">注意</span><span style="font-family: 宋体;">：<span lang="FR">@Export</span></span><span style="font-family: 宋体;">标注的接口</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">不会在模块重启的时候重新加载</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">所以如果</span><span style="font-family: 宋体;" lang="FR">@Exported</span><span style="font-family: 宋体;">标注的接口发生的变化</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">则必须重启</span><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">应用服务器</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">或者重启</span><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">部署的</span><span style="font-family: 宋体;" lang="FR">Web Application</span><span style="font-family: 宋体;">。</span></p>

<h3><a name="_Toc171745408"></a><span style="font-family: 宋体;" lang="FR">5.2.4</span><span style="font-family: 宋体;">事件和监听器</span></h3>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">内核设计了各种</span><span style="font-family: 宋体;" lang="FR">Event</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">用来通知</span><span style="font-family: 宋体;" lang="FR">Component</span><span style="font-family: 宋体;">容器内发生的事件</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">有</span><span style="font-family: 宋体;" lang="FR">3</span><span style="font-family: 宋体;">种事件类型</span><span style="font-family: 宋体;">：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.ComponentEvent</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.ModuleEvent</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.FrameworkEvent</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">分别表示<span lang="EN-US">Component</span>、<span lang="EN-US">Module</span>、<span lang="EN-US">Framework</span>发出的事件。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">组件可以通过实现对应的<span lang="EN-US">3</span>个<span lang="EN-US">Event Listener</span>：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.ComponentListener</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.ModuleListener</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.event.FrameworkListener</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">来监听对应的事件。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox </span><span style="font-family: 宋体;">的<span lang="EN-US">EJB Container</span>即是通过监听<span lang="EN-US">ModuleEvent</span>来实现<span lang="EN-US">load/unload EJB </span>的，代码片段如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="color: maroon;" lang="EN-US">&nbsp;</span><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">监听<span lang="EN-US"> Module </span>事件，根据<span lang="EN-US"> Module </span>的<span lang="EN-US"> load/unload </span>事件来加载其中的<span lang="EN-US"> EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> moduleEvent module event</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> moduleChanged(ModuleEvent moduleEvent) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Module module = moduleEvent.getModule();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (moduleEvent <b><span style="color: navy;">instanceof</span></b> ModuleLoadingEvent) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EJBBucket[] buckets = loadEJB(module);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">for</span></b> (EJBBucket bucket : buckets) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">bucketMap.</span></b>put(bucket.getEJBName(), bucket);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> <b><span style="color: navy;">if</span></b> (moduleEvent <b><span style="color: navy;">instanceof</span></b> ModuleUnloadedEvent) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unloadEJB(module);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h3><a name="_Toc171745409"></a><span style="font-family: 宋体;" lang="EN-US">5.2.5</span><span style="font-family: 宋体;">生命周期回调方法</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox IoC </span><span style="font-family: 宋体;">容器还提供了关于<span lang="EN-US">Component</span>生命周期的回调方法，它们分别定义在两个接口中：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.ComponentInitialization</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">org.jfox.framework.component.ComponentUnregistration</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">ComponentInitialization</span><span style="font-family: 宋体;">定义了组件在实例化之后以及依赖注入完成之后的回调方法：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.component;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* ComponentInitialization </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">提供了两个回调方法，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">使得在组件构造之后，以及依赖注入完成之后进行额外的操作。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* instantiated</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">方法是唯一可以传入<span lang="EN-US">ComponentContext</span>的回调方法，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">如果<span lang="EN-US">Component</span>需要使用<span lang="EN-US">ComponentContex</span>，就必须实现该接口</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> ComponentInitialization {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Component </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">实例化之后的回调方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可以做依赖注入开始前的初始化操作</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> componentContext Component context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> postContruct(ComponentContext componentContext);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Component </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">依赖注入完成之后的回调方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可以做通过该方法进行注入之后额外的检查工作，以及做组件初始化操作</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> postInject();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">通过实现<span lang="EN-US">ComponentInitialization</span>接口，还能获得一个好处，就是通过<span lang="EN-US">postConstruct</span>获得<span lang="EN-US">ComponentContext</span>，如果你需要使用<span lang="EN-US">ComponentContext</span>，那么实现<span lang="EN-US">ComponentInitialization</span>是唯一的途径。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">ComponentUnregistration </span><span style="font-family: 宋体;">定义了在组件被注销之前和注销之后的回调方法。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.framework.component;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">组件被注销之前和注销之后的回调方法。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">组件注册的时候，没有回调方法，因为此时组件还没有实例化。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@See</u></b> ComponentInitialization</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> ComponentUnregistration {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">组件被注销之前的回调方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> context component context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> true if can be unregister, false can not be unregister</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">boolean</span></b> preUnregister(ComponentContext context);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">组件被注销之后的回调方法，进行注销之后的资源清除操作。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">void</span></b> postUnregister();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">如果在注销时，需要做额外的动作，比如：关闭文件或者网络连接，那么有必要实现<span lang="EN-US">ComponentUnregistration</span>接口。</span></p>

<h3><a name="_Toc171745410"></a><span style="font-family: 宋体;" lang="EN-US">5.2.6</span><span style="font-family: 宋体;">全局占位符</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Constant</span><span style="font-family: 宋体;">一节讲到了使用常量注入时，可以使用全局占位符，全局占位符提供了根据外部配置注入常量的能力，从而增加了使用<span lang="EN-US">Annotation</span>注入的灵活性。全局占位符在<span lang="EN-US"> global.properties</span>中进行配置，位于<span lang="EN-US">WEB-INF/classes</span>目录下，使用<span lang="EN-US">java property</span>格式进行配置。使用<span lang="EN-US"> @Constant </span>对<span lang="EN-US"> Field </span>进行常量注入时，系统会调用<span lang="EN-US"> Velocity(<a href="http://velocity.apache.org/">http://velocity.apache.org</a>)</span>引擎使用<span lang="EN-US">global.properties</span>定义的只对<span lang="EN-US">@Contant</span>的<span lang="EN-US"> value</span>进行解析，将解析之后的值注入给<span lang="EN-US"> Field.</span></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如在<span lang="EN-US">gobal.properties</span>有如下定义：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">APPLICATION_NAME = JFOX Example Application</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">而在<span lang="EN-US"> ExampleComponent </span>有以下<span lang="EN-US">Field</span>：</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@Constant(value=”$APPLICATION_NAME 3.0”)</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">private String appName;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">那么<span lang="EN-US"> ExampleComponent </span>由<span lang="EN-US"> IoC </span>容器实例化之后，其<span lang="EN-US">appName</span>的值会设置成：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFOX Example Application 3.0</span><span style="font-family: 宋体;">。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MMTopic2"><a name="_Toc171745411"><span style="font-family: 宋体;" lang="EN-US">5.3 JFox MVC </span></a><span style="font-family: 宋体;">框架</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox </span><span style="font-family: 宋体;">提供<span lang="EN-US">MVC</span>框架，它直接建立在<span lang="EN-US">JFox </span>微内核之上，所以获得了<span lang="EN-US">IoC</span>以及模块化能力，不仅让你可以在<span lang="EN-US">Action</span>类中方便的注入<span lang="EN-US">EJB</span>以及其它组件，而且完全可以满足你按模块设计、开发、部署和升级的需要。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">有了<span lang="EN-US">MVC</span>，<span lang="EN-US">JFox</span>应用服务器为企业应用开发提供了<span lang="EN-US">IoC + MVC + O/R Mapping + EJB3</span>的整套开发平台，以满足企业开发对快速化、模块化的需要。</span></p>

<h3><a name="_Toc171745412"><span style="font-family: 宋体;" lang="EN-US">5.3.1 web.xml</span></a></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">首先需要熟悉一下<span lang="EN-US"> JFox MVC</span>的<span lang="EN-US">web.xml</span>配置文件，这个配置文件是定义在整个<span lang="EN-US">JFox</span>应用中，与<span lang="EN-US">JFox MVC</span>相关的有以下几段。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">context-param</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的<span lang="EN-US">XML</span>片段描述了一些与<span lang="EN-US">JFox MVC</span>相关的参数：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!--encoding used by request &amp; velocity --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">DEFAULT_ENCODING</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">UTF-8</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!-- modules deployment dir --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">MODULES_DIR</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">WEB-INF/MODULES</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!-- module's view template dir --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">VIEW_DIR</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">views</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!-- action url suffix --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">ACTION_SUFFIX</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">.do</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">context-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">以上参数的作用如下：</span></p>

<table class="MsoNormalTable" style="border: medium none ; width: 428.4pt; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0" width="571">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 123.25pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="164">
  <p class="MsoNormal"><b><span style="font-family: 宋体;" lang="EN-US">Param-name</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 117.25pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="156">
  <p class="MsoNormal"><b><span style="font-family: 宋体;" lang="EN-US">Param-value</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 187.9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="251">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">说明</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 123.25pt;" valign="top" width="164">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">DEFAULT-ENCODING</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 117.25pt;" valign="top" width="156">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">UTF-8</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 187.9pt;" valign="top" width="251">
  <p class="MsoNormal"><span style="font-family: 宋体;">定义默认编码为<span lang="EN-US">UTF-8</span>，主要作用于解析<span lang="EN-US">Form</span>数据解码，以及<span lang="EN-US">velocity/freemarker</span>加载模板文件时采用的编码</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 123.25pt;" valign="top" width="164">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">MODULES_DIR</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 117.25pt;" valign="top" width="156">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">WEB-INF/MODULES</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 187.9pt;" valign="top" width="251">
  <p class="MsoNormal"><span style="font-family: 宋体;">应用模块所在的目录，默认为<span lang="EN-US">WEB-INF/MODULES</span>目录，应用服务器启动时，会加载该目录下所有应用模块</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 123.25pt;" valign="top" width="164">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">VIEW_DIR</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 117.25pt;" valign="top" width="156">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">views</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 187.9pt;" valign="top" width="251">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">View</span><span style="font-family: 宋体;">模板文件所处的路径，<span lang="EN-US">JFox MVC</span>使用模板引擎<span lang="EN-US">(velocity/freemarker)</span>来输出<span lang="EN-US">HTML</span>，<span lang="EN-US">VIEW_DIR</span>配置的是模块中模板文件相对模块根目录所在的目录名，默认为<span lang="EN-US">views</span>。</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;">这里放置的文件除了模板文件以外，<span lang="EN-US">image</span>，<span lang="EN-US">jsp</span>等<span lang="EN-US">web</span>可以访问的一切资源也都应放在该目录下<span lang="EN-US">(</span>注：<span lang="EN-US">JFox MVC</span>仅支持将<span lang="EN-US">jsp</span>作为模板使用<span lang="EN-US">)</span></span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 123.25pt;" valign="top" width="164">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">ACTION_SUFFIX</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 117.25pt;" valign="top" width="156">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">.do</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 187.9pt;" valign="top" width="251">
  <p class="MsoNormal"><span style="font-family: 宋体;">访问<span lang="EN-US">ACTION </span>时使用的后缀名，默认为<span lang="EN-US">.do</span></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Controller Servlet</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; Controller
Servlet</span><span style="font-family: 宋体;">用来为<span lang="EN-US">JFox MVC</span>解析<span lang="EN-US">Http</span>请求，根据规则将请求分发给<span lang="EN-US">Action</span>执行，或者分发给模板引擎输出页面，起到控制器的作用。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的<span lang="EN-US">XML</span>片段配置了<span lang="EN-US">JFox MVC</span>的<span lang="EN-US">Controller
Servlet</span>： </span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">controller_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-class</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.mvc.servlet.ControllerServlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-class</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">MAX_UPLOAD_FILE_SIZE</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">5000000</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!-- 5Mbytes --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">load-on-startup</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">1</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">load-on-startup</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">controller_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/modules/*</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">主要完成以下几项定义：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Controller Servlet</span><span style="font-family: 宋体;">的类名为<span lang="EN-US">org.jfox.mvc.servlet.ControllerServlet</span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">MAX_UPLOAD_FILE_SIZE</span><span style="font-family: 宋体;">定义了上传文件的最大尺寸</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Controller Servlet</span><span style="font-family: 宋体;">响应所有 <span lang="EN-US">/modules/* </span>开头的<span lang="EN-US">URL</span>，它会根据<span lang="EN-US">URL</span>而把请求分发到正确的模块中，如：</span></p>

<p class="MsoNormal" style="margin-left: 42pt;"><span style="font-family: 宋体;" lang="EN-US">http://localhost:8080/jfox/modules/petstore/index.jsp</span><span style="font-family: 宋体;">，会调用<span lang="EN-US"> petstore </span>模块中<span lang="EN-US">views</span>目录下的<span lang="EN-US"> index.jsp</span>，而<span lang="EN-US"><a href="http://www.jfox.org.cn/modules/manager/console.sysinfo.do">http://www.jfox.org.cn/modules/manager/console.sysinfo.do</a>
</span>则将调用<span lang="EN-US">manager</span>模块下的<span lang="EN-US">console Action</span>组件的<span lang="EN-US">sysinfo</span>的<span lang="EN-US">Action</span>方法。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: 21pt;"><span style="font-family: 宋体;">关于<span lang="EN-US">Action</span>组件以及<span lang="EN-US">Action</span>方法将在下面讲到。</span></p>

<p class="MsoNormal" style="margin-left: 21pt; text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Template Servlet</span></b></p>

<p class="MsoNormal" style="margin-left: 10.5pt; text-indent: 10.5pt;"><span style="font-family: 宋体;" lang="EN-US">Template Servlet</span><span style="font-family: 宋体;">负责使用<span lang="EN-US">Velocity/Freemark</span>模板引擎，根据传递的数据对配置的模板文件进行渲染，输出最终的<span lang="EN-US">HTML</span>页面。</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;">下面的<span lang="EN-US">XML</span>片段配置了<span lang="EN-US">JFox MVC</span>的<span lang="EN-US">Template
Servlet</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-class</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.mvc.servlet.TemplateServlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-class</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">description</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">velocity</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> render</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">description</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.mvc.velocity.VelocityRender</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">*.vm,*.tmpl,*.vhtm,*.vhtml</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">description</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">freemarker</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> render</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">description</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">org.jfox.mvc.freemarker.FreemarkerRender</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">param-value</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">*.ftl,*.fhtm,*.fhtml</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">param-value</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">init-param</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">load-on-startup</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">1</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">load-on-startup</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">*.vm</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">*.tmpl</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="SV">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">*.vhtm</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">*.vhtml</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">*.ftl</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">*.fhtm</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">servlet-name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">template_servlet</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">servlet-name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> 42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;<span style="color: navy;">url-pattern</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">*.fhtml</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&lt;/<span style="color: navy;">url-pattern</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">servlet-mapping</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 44 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">配置的内容主要有以下几点：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">Template Servlet</span><span style="font-family: 宋体;">类名为<span lang="EN-US">org.jfox.mvc.servlet.TemplateServlet</span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">使用了两个<span lang="EN-US">init-param</span>分别定义<span lang="EN-US"> velocity render</span>和<span lang="EN-US">freemarker render</span>，并为它们配置了的后缀名</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">servlet-mapping</span><span style="font-family: 宋体;">将所有可能的模板后缀名都交给<span lang="EN-US">Template Servlet</span>来处理，<span lang="EN-US">Template Servlet</span>接收到模板请求之后，会再次根据后缀配置选择交给<span lang="EN-US">veloctiy</span>还是<span lang="EN-US">freemarker</span>来处理</span></p>

<h3><a name="_Toc171745413"><span style="font-family: 宋体;" lang="EN-US">5.3.2 Action</span></a></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox MVC Action</span><span style="font-family: 宋体;">用来处理<span lang="EN-US">Http</span>请求，和一般<span lang="EN-US">MVC</span>框架的<span lang="EN-US">Action</span>类不同，<span lang="EN-US">JFox MVC Action</span>可以拥有多个<span lang="EN-US">Action</span>方法，<span lang="EN-US">Action</span>方法使用<span lang="EN-US">@ActionMethod</span>描述。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox MVC</span><span style="font-family: 宋体;">提供了<span lang="EN-US">org.jfox.mvc.ActionSupport</span>来支持<span lang="EN-US">Action</span>的编写，所以所有的<span lang="EN-US">Action</span>类也必须从这里继承，<span lang="EN-US">ActionSupport</span>实现了<span lang="EN-US">org.jfox.framework.component.Component</span>，所以是<span lang="EN-US">JFox</span>内核组件，也就具备<span lang="EN-US">IoC</span>注入功能。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Action</span></b><b><span style="font-family: 宋体;">方法和<span lang="EN-US">@ActionMethod</span></span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">@ActionMethod</span><span style="font-family: 宋体;">用来描述在<span lang="EN-US">Action</span>类的一个方法上，<span lang="EN-US">Action</span>方法可以被<span lang="EN-US">URL</span>直接访问，在一个<span lang="EN-US">Action</span>类中可以描述多个<span lang="EN-US">Action</span>方法，<span lang="EN-US">Action</span>方法必须具备如下条件：</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">以<span lang="EN-US">doGet</span>或<span lang="EN-US">doPost</span>开头，分别用于相应<span lang="EN-US">Get/Post</span>方式的<span lang="EN-US">Http</span>请求</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">只有一个参数<span lang="EN-US"> InvocationContext</span></span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">返回 <span lang="EN-US">void</span></span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">抛出<span lang="EN-US">Exception</span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">有了<span lang="EN-US">@ActionMethod</span>，<span lang="EN-US">JFox MVC</span>不再需要编写和维护类似<span lang="EN-US">structs.xml</span>的配置文件了，从而简化了<span lang="EN-US">Action</span>的配置。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是<span lang="EN-US">@ActionMethod</span>的定义：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.mvc.Invocation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">表示一个</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> Action </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">方法</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">用该</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> Annotation </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">描述的方法</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">，</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">需要满足以下条件</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* 1.</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">只有一个参数</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> Invotation</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* 2.</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">返回</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> PageContext </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">类型</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">{ElementType.<b><i><span style="color: rgb(102, 14, 122);">METHOD}</span></i></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">ActionMethod </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">enum</span></b> TargetMethod {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><i><span style="color: rgb(102, 14, 122);">FORWARD,</span></i></b> <b><i><span style="color: rgb(102, 14, 122);">REDIRECT</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><b><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: rgb(102, 14, 122); -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span></i></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">调用成功时，跳转的页面<span lang="EN-US"> </span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String successView();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">发生错误时，跳转的页面，如果没有定义，讲直接在浏览器中显示异常信息</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;String errorView() <b><span style="color: navy;">default</span></b> <span style="color: blue;">""</span>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">跳转的方式，默认为<span lang="EN-US"> forward</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;TargetMethod targetMethod() <b><span style="color: navy;">default</span></b> TargetMethod.<b><i><span style="color: rgb(102, 14, 122);">FORWARD;</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">用来组装<span lang="EN-US">HttpRequest</span>参数的类，为一个标准的<span lang="EN-US">Java Bean</span>，<span lang="EN-US">file name </span>与<span lang="EN-US"> form input name</span>对应。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* MVC framework</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">会自动根据<span lang="EN-US">Field</span>进行组装。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可以在<span lang="EN-US">field</span>上加上<span lang="EN-US">validate annotation</span>来进行数据校验。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">支持<span lang="EN-US"> file upload</span>，文件上传的<span lang="EN-US">Field</span>类型必须为<span lang="EN-US"> FileUploaded</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Class&lt;? extends Invocation&gt; invocationClass() <b><span style="color: navy;">default</span></b> Invocation.<b><span style="color: navy;">class</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面展示了<span lang="EN-US">Petstore</span>模块的<span lang="EN-US">AccountAction</span>中，使用<span lang="EN-US">@ActionMethod</span>描述<span lang="EN-US">doGetSignOn</span>方法，仅指定了<span lang="EN-US">successView</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"signon.vhtml"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doGetSignon(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// don't need do anything, just forward to successView</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是<span lang="EN-US">Petstore</span>模块的<span lang="EN-US">AccountAction</span>中，使用<span lang="EN-US">@ActionMethod</span>描述<span lang="EN-US">doPostSignOn</span>方法，指定了更多的属性：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"index.vhtml"</span>, errorView = <span style="color: blue;">"signon.vhtml"</span>, invocationClass = SignonInvocation.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doPostSignon(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SignonInvocation invocation = (SignonInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account account = (Account)<b><span style="color: rgb(102, 14, 122);">loginService.</span></b>login(invocationContext.getSessionContext(), <b><span style="color: navy;">this</span></b>, invocation.getUsername(),invocation.getPassword());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (account == <b><span style="color: navy;">null</span></b>) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String msg = <span style="color: blue;">"Invalid username or password. </span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: blue; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">Signon failed"</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"errorMessage"</span>, msg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> Exception(msg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = invocationContext.getSessionContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionContext.setAttribute(<b><i><span style="color: rgb(102, 14, 122);">ACCOUNT_SESSION_KEY,</span></i></b> account);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="color: maroon;" lang="FR"> 16 </span><span style="background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">@ActionMethod</span><span style="font-family: 宋体;">中的</span><span style="font-family: 宋体;" lang="FR">successView/errorView</span><span style="font-family: 宋体;">均使用相对于模块</span><span style="font-family: 宋体;" lang="FR"> views</span><span style="font-family: 宋体;">目录的路径</span><span style="font-family: 宋体;">，<span lang="FR">successView/errorView</span></span><span style="font-family: 宋体;">也可以指向另外一个</span><span style="font-family: 宋体;" lang="FR">ActionMethod</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">只需要指明目标</span><span style="font-family: 宋体;" lang="FR">Action</span><span style="font-family: 宋体;">方法的相对</span><span style="font-family: 宋体;" lang="FR">url</span><span style="font-family: 宋体;">即可</span><span style="font-family: 宋体;">；</span><span style="font-family: 宋体;">在没有指定</span><span style="font-family: 宋体;" lang="FR">errorView</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">当出现异常时</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">异常将会被抛出</span><span style="font-family: 宋体;">；</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">@ActionMethod</span><span style="font-family: 宋体;">中的</span><span style="font-family: 宋体;" lang="FR">TargetMethod</span><span style="font-family: 宋体;">用来指定页面的跳转方式</span><span style="font-family: 宋体;">是</span><span style="font-family: 宋体;">采用</span><span style="font-family: 宋体;" lang="FR">Forward</span><span style="font-family: 宋体;">还是</span><span style="font-family: 宋体;" lang="FR">Redirect</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">默认使用</span><span style="font-family: 宋体;" lang="FR">Forward</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">而有些情况</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">比如</span><span style="font-family: 宋体;">：</span><span style="font-family: 宋体;">为了避免出现</span><span style="font-family: 宋体;" lang="FR">F5 refresh</span><span style="font-family: 宋体;">重复提交问题</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">则需使用</span><span style="font-family: 宋体;" lang="FR">Redirect</span><span style="font-family: 宋体;">进行跳转</span><span style="font-family: 宋体;">。注意<span lang="FR">Redirect</span>情况下，只能使用</span><span style="font-family: 宋体;" lang="EN-US">Session</span><span style="font-family: 宋体;">才能进行数据传递。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">@ActionMethod</span><span style="font-family: 宋体;">可以通过</span><span style="font-family: 宋体;" lang="FR">invocationClass</span><span style="font-family: 宋体;">指定用来封装请求参数的</span><span style="font-family: 宋体;" lang="FR">Invocation</span><span style="font-family: 宋体;">类</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">不指定则会使用匿名</span><span style="font-family: 宋体;" lang="FR">Invocation</span><span style="font-family: 宋体;">类，<span lang="FR">Invocation</span></span><span style="font-family: 宋体;">将在后面讲到。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面的例子展示了</span><span style="font-family: 宋体;" lang="FR">successView</span><span style="font-family: 宋体;">指向另一个<span lang="FR">Action</span></span><span style="font-family: 宋体;">方法</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">并使用</span><span style="font-family: 宋体;" lang="FR">REDIRECT</span><span style="font-family: 宋体;">方式跳转</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">并指定</span><span style="font-family: 宋体;" lang="FR">invocationClass</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"console.jpa.do"</span>, targetMethod = ActionMethod.TargetMethod.<b><i><span style="color: rgb(102, 14, 122);">REDIRECT,</span></i></b>invocationClass = TestConnectionInvocation.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doGetClearCacheConfig(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TestConnectionInvocation invocation = (TestConnectionInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String unitName = invocation.getUnitName();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EntityManagerFactoryBuilderImpl.<i>getEntityManagerFactoryByName(</i>unitName).clearCache();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Action</span></b><b><span style="font-family: 宋体;">类</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; JFox
</span><span style="font-family: 宋体;">的<span lang="EN-US">MVC Action</span>类因为可以申明多个<span lang="EN-US">Action</span>方法，所以<span lang="EN-US">Action</span>类可以设计为完成一个相关领域对象所有操作。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">以<span lang="EN-US">org.jfox.manager.demo.CartsAction</span>为例，它有多个<span lang="EN-US">Action</span>方法，用来完成与<span lang="EN-US">Carts</span>相关的所有动作。下面展示了<span lang="EN-US">CartsAction</span>的部分代码：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.manager.demo;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.util.ArrayList;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">javax.ejb.EJB;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;7 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">org.jfox.framework.annotation.Service;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.ActionSupport;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.Invocation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.InvocationContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.SessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> org.jfox.mvc.PageContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: olive;">org.jfox.mvc.annotation.ActionMethod;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* carts actions</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*&nbsp; </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Young Yang</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Service(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">id=<span style="color: blue;">"carts"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> CartsAction <b><span style="color: navy;">extends</span></b> ActionSupport {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">ICarts <b><span style="color: rgb(102, 14, 122);">carts;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">25 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"demo/carts.fhtml"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doGetView(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// do nothing, just forward to successView</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"demo/carts.fhtml"</span>, invocationClass = CartInvocation.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doPostSubmit(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CartInvocation invocation = (CartInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = invocationContext.getSessionContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&lt;String&gt; carts = (ArrayList&lt;String&gt;)sessionContext.getAttribute(<span style="color: blue;">"carts"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b>(carts == <b><span style="color: navy;">null</span></b>) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carts = <b><span style="color: navy;">new</span></b> ArrayList&lt;String&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionContext.setAttribute(<span style="color: blue;">"carts"</span>, carts);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">40 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b>(invocation.getSubmit().equals(<span style="color: blue;">"add"</span>)) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carts.add(invocation.getItem());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> <b><span style="color: navy;">if</span></b>(invocation.getSubmit().equals(<span style="color: blue;">"remove"</span>)){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carts.remove(invocation.getItem());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"carts"</span>, carts);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">50 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">51 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">class</span></b> CartInvocation <b><span style="color: navy;">extends</span></b> Invocation {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">52 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> String <b><span style="color: rgb(102, 14, 122);">item;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">53 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> String <b><span style="color: rgb(102, 14, 122);">submit;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">54 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">55 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getItem() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">56 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">item;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">57 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">58 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">59 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setItem(String item) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">60 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">item </span></b>= item;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">61 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">62 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">63 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getSubmit() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">64 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">submit;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">65 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">66 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">67 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setSubmit(String submit) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">68 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">submit </span></b>= submit;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">69 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">70 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">71 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">72 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">73 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">一个完整的<span lang="EN-US">Action</span>类应该包含这几部分：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@Service</span><span style="font-family: 宋体;">描述，并指明<span lang="EN-US">id(</span>不指定则为<span lang="EN-US">Action</span>类名的简称<span lang="EN-US">)</span>，用来将<span lang="EN-US">Action</span>部署到<span lang="EN-US">IoC</span>内核，并且使用<span lang="EN-US">URL</span>访问时，也会用到<span lang="EN-US">id</span>；</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">一个或者多个<span lang="EN-US">@ActionMethod</span>描述的方法，并指明相关属性，如：<span lang="EN-US">successView, invocationClass</span>等；</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">被定义成<span lang="EN-US">public static </span>的<span lang="EN-US">Invocation</span>内部类，以及其<span lang="EN-US">Field</span>上相关的<span lang="EN-US">Validation</span>描述。关于<span lang="EN-US">Invocation</span>的更多内容可以参考下面专门关于<span lang="EN-US">Invocation</span>的章节。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">上例中，访问<span lang="EN-US">doGetView</span>的<span lang="EN-US">URL</span>应该像下面这样：</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US"><a href="http://localhost:8080/jfox/modules/manager/carts.view.do">http://localhost:8080/jfox/modules/manager/carts.view.do</a></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">URL</span><span style="font-family: 宋体;">中<span lang="EN-US">cart.view.do</span>解释如下：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">carts</span><span style="font-family: 宋体;">是<span lang="EN-US">Action</span>组件<span lang="EN-US">@Service</span>描述的<span lang="EN-US">id</span>，<span lang="EN-US">view</span>是<span lang="EN-US">doGetView</span>方法名除去<span lang="EN-US">doGet</span>之后的剩余部分，均使用小写名，<span lang="EN-US">.do</span>是<span lang="EN-US">web.xml</span>中配置的<span lang="EN-US">Action</span>访问的后缀名。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;">回调方法</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">在<span lang="EN-US">ActionSupport</span>中定义了回调方法，以便更好的控制<span lang="EN-US">Action</span>方法的执行。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">以下是<span lang="EN-US">ActionSupport</span>定义的<span lang="EN-US">3</span>个回调方法：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* do something before invoke action method</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> invocationContext invcation context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> <b><span style="color: navy;">void</span></b> preAction(InvocationContext invocationContext) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* do something after invocation action method</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> invocationContext invocation context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> <b><span style="color: navy;">void</span></b> postAction(InvocationContext invocationContext) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">在<span lang="EN-US"> execute </span>过程中出现异常时，将回调该方法。</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">该方法可以做一些补偿性工作，比如：在<span lang="EN-US"> buildInvocation </span>过程中出现了异常，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">可以通过实现该方法恢复数据，以便能够在<span lang="EN-US"> errorView</span>中显示用户数据</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> invocationContext invocationContext</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> <b><span style="color: navy;">void</span></b> doActionFailed(InvocationContext invocationContext) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; preAction</span><span style="font-family: 宋体;">在正式执行<span lang="EN-US">Action</span>方法之前被调用，而<span lang="EN-US">postAction</span>在<span lang="EN-US">Action</span>方法执行之后被调用。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">doActionFailed </span><span style="font-family: 宋体;">回调方法在<span lang="EN-US">Action</span>方法执行失败时被调用，可以在<span lang="EN-US">doActionField</span>中进行一些数据补偿工作，比如：当用户登录失败时，在跳转到失败页面之前，需要做一些数据恢复的操作，以便跳转到失败页面时能保留已经输入的信息。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">在<span lang="EN-US">Petstore</span>的<span lang="EN-US">AccountAction</span>中，使用了<span lang="EN-US">doActionField</span>，代码如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">在<span lang="EN-US"> doPostEdit </span>发生异常时，通过该方法设置<span lang="EN-US"> PageContext account</span>，</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">以便跳转到<span lang="EN-US"> errorView </span>时，可以预设数据</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> invocationContext invocationContext</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">protected</span></b> <b><span style="color: navy;">void</span></b> doActionFailed(InvocationContext invocationContext) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (invocationContext.getActionMethod().getName().equals(<span style="color: blue;">"doPostEdit"</span>)) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="FR">9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = invocationContext.getSessionContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account account = (Account)sessionContext.getAttribute(<b><i><span style="color: rgb(102, 14, 122);">ACCOUNT_SESSION_KEY)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"account"</span>, account);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"languages"</span>, <b><i><span style="color: rgb(102, 14, 122);">languages)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Category&gt; categories = <b><span style="color: rgb(102, 14, 122);">categoryBO.</span></b>getCategoryList();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"categories"</span>, categories);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> <b><span style="color: navy;">if</span></b>(invocationContext.getActionMethod().getName().equals(<span style="color: blue;">"doPostCreate"</span>)){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewAccountInvocation invocation = (NewAccountInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account newAccount = EntityFactory.<i>newEntityObject(</i>Account.<b><span style="color: navy;">class</span></b>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setUsername(invocation.getUsername());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setStatus(<span style="color: blue;">"OK"</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setPassword(invocation.getPassword());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setAddress1(invocation.getAddress1());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setAddress2(invocation.getAddress2());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setBannerOption(invocation.getBannerOption());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setCity(invocation.getCity());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setCountry(invocation.getCountry());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setEmail(invocation.getEmail());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setFavouriteCategoryId(invocation.getFavouriteCategoryId());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setFirstName(invocation.getFirstName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setLanguagePreference(invocation.getLanguagePreference());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setLastName(invocation.getLastName());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setListOption(invocation.getListOption());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setPassword(invocation.getPassword());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 37 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setPhone(invocation.getPhone());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 38 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setState(invocation.getState());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 39 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newAccount.setZip(invocation.getZip());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">40 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 41 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"account"</span>, newAccount);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">42 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 43 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doGetNewAccount(invocationContext);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 44 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 45 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b>(Exception e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 46 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">logger.</span></b>error(<span style="color: blue;">"doActionFailed error."</span>, e);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 47 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 48 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 49 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 50 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h3><a name="_Toc171745414"><span style="font-family: 宋体;" lang="EN-US">5.3.3 Invocation</span></a></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">@ActionMethod</span>描述中，有一个重要的属性<span lang="EN-US">invocationClass</span>，<span lang="EN-US">Invocation</span>是用来实现 <span lang="EN-US">Form mapping</span>的<span lang="EN-US">Java Bean</span>类，<span lang="EN-US">JFox MVC</span>会自动将<span lang="EN-US">HTML Form</span>数据映射成<span lang="EN-US">Invocation </span>对象，<span lang="EN-US">Invocation</span>一般直接在<span lang="EN-US">Action</span>类中使用<span lang="EN-US">public static class</span>定义，<span lang="EN-US">Invocation</span>类也可以写成外部类，之所以推荐写成内部类，主要是为了让<span lang="EN-US">Action</span>类看起来更完整。，</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">需要注意的是，为了实现自动映射，<span lang="EN-US">Invocation</span>的<span lang="EN-US">Field</span>名称必须于<span lang="EN-US">Form</span>的<span lang="EN-US">input field</span>的名称保持一致！</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是<span lang="EN-US"> AccountAction</span>定义的用于登录的<span lang="EN-US">SignonInvocation</span>。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">class</span></b> SignonInvocation <b><span style="color: navy;">extends</span></b> Invocation {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@StringValidation(</span>minLength = <span style="color: blue;">4</span>, nullable = <b><span style="color: navy;">false</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> String <b><span style="color: rgb(102, 14, 122);">username;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@StringValidation(</span>minLength = <span style="color: blue;">4</span>, nullable = <b><span style="color: navy;">false</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> String <b><span style="color: rgb(102, 14, 122);">password;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getPassword() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">password;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setPassword(String password) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">password </span></b>= password;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String getUsername() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">username;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setUsername(String username) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">username </span></b>= username;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以看出，<span lang="EN-US">Invocation</span>类需要从<span lang="EN-US"> org.jfox.mvc.Invocation</span>继承，同时在<span lang="EN-US">Field</span>上可以使用<span lang="EN-US">Annotation</span>进行数据校验。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果一个<span lang="EN-US">Action</span>方法没有指定<span lang="EN-US">invocationClass</span>，则会自动构造匿名的<span lang="EN-US">org.jfox.mvc.Invocation</span>的实例，此时可以使用<span lang="EN-US">Invocation</span>类中定义的<span lang="EN-US">getAttribute</span>方法根据<span lang="EN-US">Form</span>中的<span lang="EN-US">input name</span>获得用户输入的值。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Validator</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Invocation</span><span style="font-family: 宋体;">的<span lang="EN-US">Filed</span>上，可以使用各种<span lang="EN-US">Validation Annotation</span>来对用户的输入数据进行校验。<span lang="EN-US">Validation Annotation</span>的定义在<span lang="EN-US">org.jfox.mvc.validate</span>包下，目前已经提供以下几种<span lang="EN-US">Validation:</span></span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@StringValidation</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@IntegerValidation</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@LongValidation</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@FloatValidation</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">5.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@DobuleValidation</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">6.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">@EmailValidation</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">用户还可以根据需要扩展其它的<span lang="EN-US">Annotation</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Invocation</span><span style="font-family: 宋体;">超类中还定义了<span lang="EN-US">validateAll</span>方法，在<span lang="EN-US">Invocation</span>的属性都设置完毕之后，进行综合验证，下面的例子展示了注册用户时，使用<span lang="EN-US">validateAll</span>验证两次输入的密码是否一致的情况。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> validateAll() <b><span style="color: navy;">throws</span></b> ValidateException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">//</span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">验证密码是否一致</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (!getPassword().equals(getRepeatpassword())) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> ValidateException(<span style="color: blue;">"password twice input are different."</span>, <span style="color: blue;">"password"</span>, getPassword());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">注意：<span lang="EN-US">JFox MVC</span>的<span lang="EN-US">Validator</span>只进行服务器端验证，如果需要在浏览器端进行验证，则仍然需要手工编写<span lang="EN-US">javascript</span>代码。</span></p>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 18pt;"><span style="font-family: 宋体;" lang="EN-US">Validator</span><span style="font-family: 宋体;">包括两部分：</span></p>

<ol style="margin-top: 0cm;" start="1" type="1">
 <li class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">Validation
     Annotation</span><span style="font-family: 宋体;">，用来描述在<span lang="EN-US">Invocation
     Class</span>的<span lang="EN-US">Field</span>上；</span></li>
 <li class="MsoNormal"><span style="font-family: 宋体;">用来实现验证过程的<span lang="EN-US">Validator</span>类；</span></li>
</ol>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">n<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">Validation Annotation</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">我们以<span lang="EN-US">String Validate</span>为例，看一下<span lang="EN-US">StringValidation</span>的定下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.validate;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">java.lang.annotation.Retention;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 4 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.lang.annotation.RetentionPolicy;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 5 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <span style="color: olive;">java.lang.annotation.Target;</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 6 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> java.lang.annotation.ElementType;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 7 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">字符串验证</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> Annotation</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">Yang Yong</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Retention(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">RetentionPolicy.<b><i><span style="color: rgb(102, 14, 122);">RUNTIME)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Target(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">ElementType.<b><i><span style="color: rgb(102, 14, 122);">FIELD)</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> @<b><span style="color: navy;">interface</span></b> <span style="color: olive;">StringValidation </span>{</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* default String validator class </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;Class&lt;? <b><span style="color: navy;">extends</span></b> Validator&gt; validatorClass() <b><span style="color: navy;">default</span></b> StringValidator.<b><span style="color: navy;">class</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">最小长度</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> minLength() <b><span style="color: navy;">default</span></b> Integer.<b><i><span style="color: rgb(102, 14, 122);">MIN_VALUE;</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">最大长度</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> maxLength() <b><span style="color: navy;">default</span></b> Integer.<b><i><span style="color: rgb(102, 14, 122);">MAX_VALUE;</span></i></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">是否可以为空</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">boolean</span></b> nullable() <b><span style="color: navy;">default</span></b> <b><span style="color: navy;">false</span></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">36 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Validation Annotation</span><span style="font-family: 宋体;">都需要包含一个<span lang="EN-US">validatorClass</span>属性，指定用来执行校验的<span lang="EN-US">Validator</span>类，这个方法是<span lang="EN-US">JFox MVC</span>对于<span lang="EN-US">Validation Annotation</span>约定的一个方法，会在运行时通过反射该方法得到<span lang="EN-US"> Validator</span>类，以完成数据的校验，所以在自定义的<span lang="EN-US">Validation
Annotation</span>中，也必须包含该属性。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">@StringValidation</span>中，<span lang="EN-US">validatorClass</span>的定义如下：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; font-family: 宋体; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">class&lt;? <b><span style="color: navy;">extends</span></b> Validator&gt; validatorClass() <b><span style="color: navy;">default</span></b> StringValidator.<b><span style="color: navy;">class</span></b>;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">那么对于<span lang="EN-US">@StringValidation</span>，默认会使用<span lang="EN-US">StringValidator</span>类进行校验。如果默认的<span lang="EN-US">Validator</span>类不能满足要求，可以在使用<span lang="EN-US">@StringValidation</span>的时候，指定其它的<span lang="EN-US">Validator</span>类，如下面的例子，指定了<span lang="EN-US">demo.MyStringValidator</span>来进行校验。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="SV">1</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: olive;">@StringValidation(</span>minLength = <span style="color: blue;">4</span>, nullable = <b><span style="color: navy;">false</span></b>, validatorClass = <span style="color: blue;">"demo.MyStringValidator"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV">&nbsp; 2</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">&nbsp;&nbsp;&nbsp;&nbsp; <b><span style="color: navy;">private</span></b> String password;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV">&nbsp; 3 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="SV">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="SV">n<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="SV">Validator</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="SV">Validator</span><span style="font-family: 宋体;">用来完成校验的过程</span><span style="font-family: 宋体;">，<span lang="SV">Validator Class</span></span><span style="font-family: 宋体;">都必须实现</span><span style="font-family: 宋体;" lang="SV">
org.jfox.mvc.validate.Validator </span><span style="font-family: 宋体;">接口。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="SV">Validator</span><span style="font-family: 宋体;">接口定义如下</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="SV"> org.jfox.mvc.validate;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="SV"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.Annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* Validator interface</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Yang Yong</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">interface</span></b> Validator&lt;T&gt; {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp; verify the input according validatation</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp; return Object constructed by input if success</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> inputValue input string</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@param</u></b> validation validation annotation</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@throws</u></b> ValidateException if validate failed</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> T validate(String inputValue, Annotation validation) <b><span style="color: navy;">throws</span></b> ValidateException;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">Validator</span><span style="font-family: 宋体;">中只有一个方法<span lang="EN-US">validate</span>，第一个参数为用户输入的值，第二个参数为<span lang="EN-US">Annotation</span>，通过<span lang="EN-US">Annotation</span>，可以获得校验参数，如果验证失败，应该抛出<span lang="EN-US">ValidateException</span>异常；如果验证通过，返回正确类型的值，如：<span lang="EN-US">IntegerValidator</span>返回<span lang="EN-US"> Integer</span>，<span lang="EN-US">DateValidator</span>返回<span lang="EN-US">Date</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">看一下<span lang="EN-US"> IntegerValidator</span>的例子：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">package</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> org.jfox.mvc.validate;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">import</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> java.lang.annotation.Annotation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">/**</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* validate integer input</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;* <b><u>@author</u></b> </span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;a href="mailto:jfox.young@gmail.com"&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Yang Yong</span><span style="background: rgb(226, 255, 226) none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/a&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> IntegerValidator <b><span style="color: navy;">implements</span></b> Validator&lt;Integer&gt; {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Integer validate(String inputValue, Annotation validation) <b><span style="color: navy;">throws</span></b> ValidateException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">IntegerValidation </span>integerValidation = (<span style="color: olive;">IntegerValidation)</span>validation;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// </span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">整型数据</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> minValue = integerValidation.minValue();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> maxValue = integerValidation.maxValue();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">try</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">int</span></b> intValue = Integer.<i>parseInt(</i>inputValue);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (intValue &lt; minValue || intValue &gt; maxValue) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> ValidateException(<span style="color: blue;">"The input value "</span> + inputValue + <span style="color: blue;">" must between "</span> + minValue + <span style="color: blue;">", "</span> + maxValue, inputValue);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> intValue;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">catch</span></b> (NumberFormatException e) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> ValidateException(<span style="color: blue;">"Illegal Integer format for input: "</span> + inputValue, inputValue);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">}</span></pre></div>

<p class="MsoNormal" style="margin-left: 42pt;"><b><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></b></p>

<p class="MsoNormal" style="margin-left: 63pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">n<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;">获得<span lang="EN-US">Validate</span>异常信息</span></b></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果用户的输入不正确的时候，<span lang="EN-US">Validator.validate()</span>方法会抛出<span lang="EN-US">ValidateException</span>，你可以获得<span lang="EN-US">exception</span>的信息可以在页面上输出，获得异常信息的方式如下：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">$ J_VALIDATE_EXCEPTIONS.get(“username”).getMessage()</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">$ J_VALIDATE_EXCEPTIONS</span><span style="font-family: 宋体;">是<span lang="EN-US">JFox MVC</span>中定义的固化变量，实际的类型是一个只读的<span lang="EN-US">Map</span>，通过<span lang="EN-US">get</span>方法传入<span lang="EN-US">Form</span>的<span lang="EN-US">input
name</span>即可得到该<span lang="EN-US">input </span>的<span lang="EN-US">ValidateException</span>异常，使用<span lang="EN-US"> Exception.getMessage()</span>即可得到异常信息，所以在<span lang="EN-US">validate</span>方法中抛出有意义的异常信息是很有必要的。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox Petstore</span><span style="font-family: 宋体;">中，用户登录的输入<span lang="EN-US">formHTML</span>代码如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">form</span> <span style="color: blue;">action=</span><span style="color: green;">"account.signon.do"</span> <span style="color: blue;">method=</span><span style="color: green;">"POST"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">table</span> <span style="color: blue;">align=</span><span style="color: green;">"center"</span> <span style="color: blue;">border=</span><span style="color: green;">"0"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span> <span style="color: blue;">colspan=</span><span style="color: green;">"2"</span> <span style="color: blue;">align=</span><span style="color: green;">"center"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please enter your username and password.</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">center</span>&gt;&lt;<span style="color: navy;">b</span>&gt;&lt;<span style="color: navy;">font</span> <span style="color: blue;">color=</span><span style="color: green;">"RED"</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">$!errorMessage <span style="color: blue;">&nbsp;</span></span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">font</span>&gt;&lt;/<span style="color: navy;">b</span>&gt;&lt;/<span style="color: navy;">center</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Username:</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;&lt;<span style="color: navy;">input</span> <span style="color: blue;">type=</span><span style="color: green;">"text"</span> <span style="color: blue;">name=</span><span style="color: green;">"username"</span> <span style="color: blue;">value=</span><span style="color: green;">"j2ee"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">font</span> <span style="color: blue;">color=</span><span style="color: green;">"RED"</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> $!J_VALIDATE_EXCEPTIONS.get("username").getMessage()</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">font</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Password:</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;&lt;<span style="color: navy;">input</span> <span style="color: blue;">type=</span><span style="color: green;">"password"</span> <span style="color: blue;">name=</span><span style="color: green;">"password"</span> <span style="color: blue;">value=</span><span style="color: green;">"j2ee"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">font</span> <span style="color: blue;">color=</span><span style="color: green;">"RED"</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">$!J_VALIDATE_EXCEPTIONS.get("password").getMessage()</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">font</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: blue; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">td</span>&gt;&lt;<span style="color: navy;">input</span> <span style="color: blue;">type=</span><span style="color: green;">"image"</span> <span style="color: blue;">border=</span><span style="color: green;">"0"</span> <span style="color: blue;">src=</span><span style="color: green;">"images/button_submit.gif"</span> <span style="color: blue;">name=</span><span style="color: green;">"update"</span>/&gt;&lt;/<span style="color: navy;">td</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">tr</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">table</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">27 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">28 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">form</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果用户名或者密码输入格式有错，便会在页面上用红字打印出来，如下图：</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image006.jpg" border="0" height="98" width="553"></span></p>

<h3><a name="_Toc171745415"></a><span style="font-family: 宋体;" lang="EN-US">5.3.4</span><span style="font-family: 宋体;" lang="EN-US"> InvocationContext</span></h3>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; InvoationContext</span><span style="font-family: 宋体;">是<span lang="EN-US">Action</span>方法需要的唯一的参数，它封装了<span lang="EN-US">Action</span>调用的上下文资源。通过<span lang="EN-US">InvocationContext</span>，可以得到<span lang="EN-US">PageContext</span>，<span lang="EN-US">SessionContext</span>，<span lang="EN-US">Invocation</span>，<span lang="EN-US">Action Method</span>以及<span lang="EN-US">ServletConfig</span>等。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">在一个典型的<span lang="EN-US">Action</span>方法中，对<span lang="EN-US">InvocationContext</span>会有以下的操作步骤：</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">通过<span lang="EN-US">InvocationContext.getInvocaion()
</span>获得<span lang="EN-US">Invocation</span>对象，并造型成正确的类型，以获得<span lang="EN-US">Http</span>请求中的各种参数；</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">如果需要使用<span lang="EN-US">Session</span>，可以调用<span lang="EN-US">InvocationContext.getSessionContext()</span>获得<span lang="EN-US">Session</span>上下文；</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;
</span></span><span style="font-family: 宋体;">最后需要通过<span lang="EN-US">InvocationContext.getPageContext()
</span>获得页面上下文对象，并设置各种属性，以交给模板引擎来渲染页面。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;">下面的代码来自<span lang="EN-US">Petstore</span>的<span lang="EN-US">CartsAction</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"Cart.vhtml"</span>, invocationClass = CartInvocation.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doGetAddItem(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="FR">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CartInvocation invocation = (CartInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = invocationContext.getSessionContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cart cart = (Cart)sessionContext.getAttribute(<b><i><span style="color: rgb(102, 14, 122);">CART_SESSION_KEY)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (cart == <b><span style="color: navy;">null</span></b>) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cart = <b><span style="color: navy;">new</span></b> Cart();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="FR">9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionContext.setAttribute(<b><i><span style="color: rgb(102, 14, 122);">CART_SESSION_KEY,</span></i></b> cart);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (!cart.containsItemId(invocation.getWorkingItemId())) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item item = <b><span style="color: rgb(102, 14, 122);">itemBO.</span></b>getItem(invocation.getWorkingItemId());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cart.addItem(item, <b><span style="color: rgb(102, 14, 122);">itemBO.</span></b>isItemInStock(invocation.getWorkingItemId()));</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cart.incrementQuantityByItemId(invocation.getWorkingItemId());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> </span><span style="font-size: 9pt; color: maroon;" lang="FR">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 18 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp;19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"cart"</span>, cart);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="FR">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="FR">PageContext</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;&nbsp;&nbsp; PageContext</span><span style="font-family: 宋体;">用来设置页面上下文</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">其中的数据将被模板引擎</span><span style="font-family: 宋体;" lang="FR">(Velocity,
Freemark)</span><span style="font-family: 宋体;">用来渲染模板</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">以正确输出</span><span style="font-family: 宋体;" lang="FR">HTML</span><span style="font-family: 宋体;">页面。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">在</span><span style="font-family: 宋体;" lang="FR">Action</span><span style="font-family: 宋体;">方法中</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">执行完毕之后</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">一般都需要通过</span><span style="font-family: 宋体;" lang="FR">PageContext.setAttribute()</span><span style="font-family: 宋体;">来设置相关的属性值</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">以便模板引擎用来渲染页面。如下面打开新建用户页面的例子：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"NewAccountForm.vhtml"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doGetNewAccount(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="FR">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// do nothing</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"languages"</span>, <b><i><span style="color: rgb(102, 14, 122);">languages)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Category&gt; categories = <b><span style="color: rgb(102, 14, 122);">categoryBO.</span></b>getCategoryList();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"categories"</span>, categories);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">MVC</span><span style="font-family: 宋体;">框架已经在<span lang="EN-US">PageContext</span>中设置了一些通用的数据属性，其中包括一些环境信息和校验异常、业务异常等，这些变量均为大写，且以<span lang="EN-US">J_ </span>开头，以避免和应用设置的属性重名而覆盖了应用属性，因为通用属性在。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">下面是通用属性列表：</span></p>

<table class="MsoNormalTable" style="border: medium none ; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 147.6pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="197">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-family: 宋体;">属性名</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 194.35pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="259">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-family: 宋体;">解释</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 84.15pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="112">
  <p class="MsoNormal" style="text-align: center;" align="center"><b><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_VALIDATE_EXCEPTION</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">校验异常，这是一个<span lang="EN-US">Map</span>，<span lang="EN-US">Key</span>为<span lang="EN-US">From input field name</span>，<span lang="EN-US">value</span>为<span lang="EN-US">ValidateException</span></span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_EXCEPTION</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">业务异常，即<span lang="EN-US">Action</span>执行过程中抛出的异常</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_SESSION_CONTEXT</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">执行<span lang="EN-US">SessionContext</span>，获得<span lang="EN-US">Session</span>中存储的数据</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_PAGE_CONTEXT</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">PageContext</span><span style="font-family: 宋体;">本身</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_REQUEST</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">HttpServletRequest</span><span style="font-family: 宋体;">对象</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_WEBAPP_CONTEXT_PATH</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 147.6pt;" valign="top" width="197">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">J_SERVLET_PATH</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.35pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 84.15pt;" valign="top" width="112">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">另外，使用<span lang="EN-US">PageContext.setTargetView</span>可以手动设置<span lang="EN-US">Action</span>的跳转页面，用于程序控制的页面跳转。</span></p>

<p class="MsoNormal" style="margin-left: 42pt; text-indent: -21pt;"><span style="font-family: Wingdings;" lang="EN-US">l<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><b><span style="font-family: 宋体;" lang="EN-US">SessionContext</span></b></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; SessionContext</span><span style="font-family: 宋体;">是<span lang="EN-US">JFox MVC</span>用来存在<span lang="EN-US">Session</span>数据的上下文对象，它和<span lang="EN-US">InvocationContext</span>关联在一起，随时可以通过<span lang="EN-US">InvocationContext.getSessionContext()</span>获得。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; SessionContext</span><span style="font-family: 宋体;">使用了<span lang="EN-US">Map&lt;String, Serializable&gt; </span>来存储<span lang="EN-US">Session</span>数据，所以存储到<span lang="EN-US">Session</span>中的数据都应该是可序列化的：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">使用<span lang="EN-US">Map</span>存储<span lang="EN-US">Session</span>数据</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> Map&lt;String, Serializable&gt; <b><span style="color: rgb(102, 14, 122);">sessionMap </span></b>= <b><span style="color: navy;">new</span></b> HashMap&lt;String, Serializable&gt;();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; SessionContext</span><span style="font-family: 宋体;">提供了以下方法用来操作<span lang="EN-US">Session</span>数据：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setAttribute(String key, Serializable value) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>put(key,value);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Serializable getAttribute(String key) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>get(key);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">boolean</span></b> containsAttribute(String key){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>containsKey(key);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> Serializable removeAttribute(String key) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>remove(key);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> String[] getAttributeNames(){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>keySet().toArray(<b><span style="color: navy;">new</span></b> String[<b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>size()]);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">销毁<span lang="EN-US"> SessionContext</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> destroy(){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">sessionMap.</span></b>clear();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext.<i>disassociateThreadSessionContext(</i>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: rgb(102, 14, 122);">request.</span></b>getSession().removeAttribute(<b><i><span style="color: rgb(102, 14, 122);">SESSION_KEY)</span></i></b>;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span lang="EN-US">&nbsp;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">因为<span lang="EN-US">SessionContext</span>在初始化的时候，已经和当前的线程进行了关联，所以你还可以通过静态方法<span lang="EN-US">SessionContext.currentThreadSessionContext()</span>获得获得与当前线程关联的<span lang="EN-US">SessionContext</span>。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">/**</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;">得到与当前线程绑定的<span lang="EN-US">SessionContext</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <b><u>@return</u></b> return null if current thread not associate session context</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> SessionContext currentThreadSessionContext(){</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = <b><i><span style="color: rgb(102, 14, 122);">threadSession.</span></i></b>get();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b>(sessionContext == <b><span style="color: navy;">null</span></b>) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><i><span style="color: rgb(102, 14, 122);">threadSession.</span></i></b>remove();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> sessionContext;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 12 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h3><a name="_Toc171745416"></a><span style="font-family: 宋体;" lang="EN-US">5.3.5</span><span style="font-family: 宋体;">依赖注入</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在<span lang="EN-US">Action</span>中可以，直接使用<span lang="EN-US"> @EJB </span>来注入<span lang="EN-US"> EJB</span>，从而简化了<span lang="EN-US">Action</span>类对<span lang="EN-US">EJB
</span>的访问。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">在上面的例子中，在字段定义部分，可以看到如下的代码：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">ICarts <b><span style="color: rgb(102, 14, 122);">carts;</span></b></span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">上面说到</span><span style="font-family: 宋体;">，<span lang="FR">Action</span></span><span style="font-family: 宋体;">是一个</span><span style="font-family: 宋体;" lang="FR">JFox</span><span style="font-family: 宋体;">内核标准</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">所以自然能够使用</span><span style="font-family: 宋体;" lang="FR">@Inject
@Constant</span><span style="font-family: 宋体;">来进行注入</span><span style="font-family: 宋体;">；</span><span style="font-family: 宋体;">但同时</span><span style="font-family: 宋体;">，<span lang="FR">Action</span></span><span style="font-family: 宋体;">中也可以使用</span><span style="font-family: 宋体;" lang="FR">@EJB</span><span style="font-family: 宋体;">来注入</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">，<span lang="FR">@Resource</span></span><span style="font-family: 宋体;">从</span><span style="font-family: 宋体;" lang="FR">JNDI</span><span style="font-family: 宋体;">中注入资源</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">和在</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">中使用完全一样</span><span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">这大大简化了</span><span style="font-family: 宋体;" lang="FR">Action</span><span style="font-family: 宋体;">对</span><span style="font-family: 宋体;" lang="FR">EJB</span><span style="font-family: 宋体;">容器资源的访问。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以说</span><span style="font-family: 宋体;">，<span lang="FR">JFox MVC is EJB3 ready!</span></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="FR">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">还是来看</span><span style="font-family: 宋体;" lang="FR">Petstore</span><span style="font-family: 宋体;">中</span><span style="font-family: 宋体;" lang="FR">AccountAction</span><span style="font-family: 宋体;">的例子</span><span style="font-family: 宋体;">：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">@Service(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">id = <span style="color: blue;">"account"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR"> <b><span style="color: navy;">class</span></b> AccountAction <b><span style="color: navy;">extends</span></b> ActionSupport <b><span style="color: navy;">implements</span></b> CallbackHandler {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> &nbsp;</span><span style="font-size: 9pt; color: maroon;" lang="EN-US">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Inject</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">JAASLoginService <b><span style="color: rgb(102, 14, 122);">loginService;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">AccountBO <b><span style="color: rgb(102, 14, 122);">accountBO;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@EJB</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">CategoryBO <b><span style="color: rgb(102, 14, 122);">categoryBO;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 11 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">&nbsp;…</span></b></span></pre></div>

<h3><a name="_Toc171745417"></a><span style="font-family: 宋体;" lang="EN-US">5.3.6</span><span style="font-family: 宋体;">文件上传</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">使用<span lang="EN-US">JFox MVC</span>实现文件上传是非常容易的，只需要在<span lang="EN-US">Invocation Class</span>中定义一个类型为<span lang="EN-US"> org.jfox.mvc.FileUploaded</span>字段即可，通过<span lang="EN-US">FileUploaded.getFileName()</span>可以得到文件名，通过<span lang="EN-US">FileUploaded.getContent()</span>可以得到文件内容，返回值的类型为<span lang="EN-US">byte</span>数组。</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">static</span></b> <b><span style="color: navy;">class</span></b> UploadInvocation <b><span style="color: navy;">extends</span></b> Invocation {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">private</span></b> FileUploaded <b><span style="color: rgb(102, 14, 122);">uploadFile;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> FileUploaded getUploadFile() {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">return</span></b> <b><span style="color: rgb(102, 14, 122);">uploadFile;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> setUploadFile(FileUploaded uploadFile) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">this</span></b>.<b><span style="color: rgb(102, 14, 122);">uploadFile </span></b>= uploadFile;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">上传文件的大小限制在<span lang="EN-US">web.xml</span>中配置。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h3><a name="_Toc171745418"></a><span style="font-family: 宋体;" lang="EN-US">5.3.7</span><span style="font-family: 宋体;">使用<span lang="EN-US">JAAS</span>登录</span></h3>

<p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JFox
Java EE</span><span style="font-family: 宋体;">容器中已经讲述了</span><span lang="EN-US">EJB
Security</span><span style="font-family: 宋体;">，再来看一下</span><span style="font-family: 宋体;" lang="EN-US">JFox MVC</span><span style="font-family: 宋体;">中如果使用<span lang="EN-US">JAAS</span>进行登录。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">为了使用<span lang="EN-US">JAAS</span>登录，你需要对你的<span lang="EN-US">Action</span>做如下动作：</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">使用<span lang="EN-US">@Inject</span>注入<span lang="EN-US">JAASLoginService</span></span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">让<span lang="EN-US">Action</span>实现<span lang="EN-US">javax.security.auth.callback.CallbackHandler</span>接口</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">在<span lang="EN-US">handle</span>方法中进行登录，并设置<span lang="EN-US"> setCallbackObject, setPrincipalName, setRole</span></span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">4.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">使用<span lang="EN-US">LoginService</span>的<span lang="EN-US">login</span>方法登录</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">以下的代码摘自<span lang="EN-US">Petstore</span>模块的<span lang="EN-US">org.jfox.petstore.action.AccountAction</span>。</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">1.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">实现<span lang="EN-US">JAAS
CallbackHandler</span>接口，并注入登录服务<span lang="EN-US">JAASLoginService</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">@Service(</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">id = <span style="color: blue;">"account"</span>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: navy; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">public</span></b><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <b><span style="color: navy;">class</span></b> AccountAction <b><span style="color: navy;">extends</span></b> ActionSupport <b><span style="color: navy;">implements</span></b> CallbackHandler {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@Inject</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: olive; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">JAASLoginService <b><span style="color: rgb(102, 14, 122);">loginService;</span></b></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">2.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;">在<span lang="EN-US">handle</span>实现登录过程，<span lang="EN-US">Action</span>方法中调用<span lang="EN-US">JAASLoginService.login</span>方法</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">@ActionMethod(</span>successView = <span style="color: blue;">"index.vhtml"</span>, errorView = <span style="color: blue;">"signon.vhtml"</span>, invocationClass = SignonInvocation.<b><span style="color: navy;">class</span></b>)</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> doPostSignon(InvocationContext invocationContext) <b><span style="color: navy;">throws</span></b> Exception {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SignonInvocation invocation = (SignonInvocation)invocationContext.getInvocation();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 4 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;&nbsp;5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account account = (Account)<b><span style="color: rgb(102, 14, 122);">loginService.</span></b>login(invocationContext.getSessionContext(), <b><span style="color: navy;">this</span></b>, invocation.getUsername(),invocation.getPassword());</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">if</span></b> (account == <b><span style="color: navy;">null</span></b>) {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp; 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String msg = <span style="color: blue;">"Invalid username or password. </span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: blue; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">Signon failed"</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageContext pageContext = invocationContext.getPageContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR">&nbsp; 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageContext.setAttribute(<span style="color: blue;">"errorMessage"</span>, msg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">throw</span></b> <b><span style="color: navy;">new</span></b> Exception(msg);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">else</span></b> {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> 13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="FR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionContext sessionContext = invocationContext.getSessionContext();</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="FR"> </span><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionContext.setAttribute(<b><i><span style="color: rgb(102, 14, 122);">ACCOUNT_SESSION_KEY,</span></i></b> account);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 17 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">//JAAS CallbackHandler method</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<b><span style="color: navy;">public</span></b> <b><span style="color: navy;">void</span></b> handle(Callback[] callbacks) <b><span style="color: navy;">throws</span></b> IOException, UnsupportedCallbackException {</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JAASLoginRequestCallback requestCallback = (JAASLoginRequestCallback)callbacks[<span style="color: blue;">0</span>];</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JAASLoginResponseCallback responseCallback = (JAASLoginResponseCallback)callbacks[<span style="color: blue;">1</span>];</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 22 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;23 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// first parameter is username</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 24 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String username = requestCallback.getParams().get(<span style="color: blue;">0</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 25 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// second parameter is password</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 26 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String password = requestCallback.getParams().get(<span style="color: blue;">1</span>);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 27 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;28 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Account account = <b><span style="color: rgb(102, 14, 122);">accountBO.</span></b>getAccount(username, password);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 29 </span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">&nbsp;30 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set callback object, will return by LoginService.login</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 31 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setCallbackObject(account);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 32 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set principal name</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 33 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setPrincipalName(username);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 34 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: gray;">// set role</span></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 35 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responseCallback.setRole(username);</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 36 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">注意：<span lang="EN-US">handle</span>方法中，需要设置<span lang="EN-US">JAASLoginResponseCallback</span>的各项属性。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal" style="margin-left: 39pt; text-indent: -18pt;"><span style="font-family: 宋体;" lang="EN-US">3.<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;
</span></span><span style="font-family: 宋体;" lang="EN-US">AccountAction.doPostSignOn</span><span style="font-family: 宋体;">方法调用<span lang="EN-US">JAASLoginService.login</span>登录，将<span lang="EN-US">this</span>作为<span lang="EN-US">CallbackHandler</span>：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Account account = (Account)<b><span style="color: rgb(102, 14, 122);">loginService.</span></b>login(invocationContext.getSessionContext(), <b><span style="color: navy;">this</span></b>, invocation.getUsername(),invocation.getPassword())</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<h3><a name="_Toc171745419"></a><span style="font-family: 宋体;" lang="EN-US">5.3.8</span><span style="font-family: 宋体;">访问<span lang="EN-US">Action</span></span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">最后，再总结一下如何通过<span lang="EN-US">URL</span>访问你的<span lang="EN-US">Action</span>以及<span lang="EN-US">view</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">比如<span lang="EN-US">manager</span>模块，访问静态文件的<span lang="EN-US"> url </span>为：</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">http://localhost/jfox/modules/manager/index.html</span><span style="font-family: 宋体;">，或者 </span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">http://localhost/jfox/modules/manager/sub/index.html</span><span style="font-family: 宋体;">；<span lang="EN-US"> </span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">访问<span lang="EN-US">Action</span>的<span lang="EN-US">url</span>为：<span lang="EN-US">/jfox3/modules/manager/example.view.do</span></span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">example</span><span style="font-family: 宋体;">是<span lang="EN-US"> Action</span>部署的<span lang="EN-US">id</span>，<span lang="EN-US">view</span>是<span lang="EN-US">Action</span>中的<span lang="EN-US">Action</span>方法，如果是<span lang="EN-US">Get</span>访问则是<span lang="EN-US">doGetView</span>方法，如果是<span lang="EN-US">Post</span>访问，则是<span lang="EN-US">doPostView</span>。</span></p>

<h2><a name="_Toc171745420"><span style="font-family: 宋体;" lang="EN-US">5.4 JFox Module</span></a></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">现在来讲解<span lang="EN-US">JFox</span>模块的概念，之所以把模块单独作为一个章节来将，是因为模块既与<span lang="EN-US">JFox</span>内核相关，也与<span lang="EN-US">MVC</span>框架相关。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">模
块的特性表现在首先模块具有一定的自包含性，能够比较独立的开发、运行和维护，同时模块又可以与其它模块组合并交互以实现复杂的功能，并且可以不断的增加
模块来完善整个系统，所以模块化在当今的系统设计中越来越被重视。但同时，由于模块的自包含性和可交互性这一对矛盾，使得设计时，首先需要将一个系统按照
业务需求以及依赖关系合理的划分成多个模块，比如：模块之间如果有循环依赖的话，就需要考虑一下模块的划分是否合理了；其次还需要有一个平台来支持。<span lang="EN-US">JFox</span>提供了良好的模块化支持能力。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">的模块分为两种类型，一种只提供服务，没有界面；而另一种则拥有界面。没有界面的模块只需要<span lang="EN-US">JFox</span>内核就可以支持，而有界面的模块则需要<span lang="EN-US">JFox MVC</span>框架支持。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如：<span lang="EN-US">JFox</span>应用服务器的内置组件都处于默认的名为<span lang="EN-US"> __SYSTEM_MODULE__ </span>的模块中，<span lang="EN-US">JFox</span>控制台<span lang="EN-US">(manager)</span>以及<span lang="EN-US">Petstore</span>则被实现成具有界面的模块，部署在<span lang="EN-US">WEB-INF/MODULES</span>下。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如果你正在考虑基于<span lang="EN-US">JFox</span>实现一个<span lang="EN-US">B/S</span>结构的简单应用，你也许考虑不需要模块化支持，那么直接使用<span lang="EN-US">JFox</span>应用服务器所在的<span lang="EN-US">Web Application</span>，并且可以使用你熟悉的<span lang="EN-US">MVC</span>框架比如：<span lang="EN-US">Structs, Webwork</span>，<span lang="EN-US">Tapestry</span>等；而如果你正在开发的是一个较大的应用，并且已经有比较清晰的业务模块的划分，而且期望将来能够按模块进行开发、部署、维护，那么<span lang="EN-US">JFox</span>提供的模块化功能将刚好能够满足你的要求，你可以将你的应用按业务模块分解成<span lang="EN-US">JFox</span>的一个一个的模块，并按模块组织你的开发团队，如此将能够获得模块化带来的诸多好处。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">实际上，即使你的应用不需要模块，我们仍建议你将其设计成只有一个模块的应用，以<span lang="EN-US">Module</span>的形式来部署。</span></p>

<h3><a name="_Toc171745421"></a><span style="font-family: 宋体;" lang="EN-US">5.4.1</span><span style="font-family: 宋体;">模块结构</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">模块主要有这几部分组成：配置文件，<span lang="EN-US">Java</span>类和<span lang="EN-US">jar</span>，<span lang="EN-US">views (</span>包括模板和其它<span lang="EN-US">Web</span>资源<span lang="EN-US">)</span>，以及其它目录和文件。 模块一般以独立目录的形式部署到<span lang="EN-US">JFox</span>应用服务器中，默认的发布目录为：<span lang="EN-US">WEB-INF/MODULES</span>。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">对于模块的结构，是有一定要求的。</span></p>

<table class="MsoNormalTable" style="border: medium none ; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="border: 1pt solid windowtext; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 98.55pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="131">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">目录名</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 133.4pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="178">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">作用</span></b></p>
  </td>
  <td style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0cm 5.4pt; background: rgb(224, 224, 224) none repeat scroll 0% 0%; width: 194.15pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" valign="top" width="259">
  <p class="MsoNormal"><b><span style="font-family: 宋体;">备注</span></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">conf</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">模块配置文件目录</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">该目录会加入到模块的<span lang="EN-US">ClassLoader</span>，以便可以用<span lang="EN-US">ClassLoader.getResource </span>获得文件</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">conf/module.xml</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">模块配置文件（见安装模块的配置一节）</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">如果不存在，则<span lang="EN-US">JFox</span>会使用默认配置进行部署</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">src</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">模块的源码路径</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal"><span style="font-family: 宋体;">运行时不需要</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">views</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">存放<span lang="EN-US">template</span>以及其它可以直接<span lang="EN-US">Http</span>访问的资源</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;">可以存在子目录，如果在<span lang="EN-US"> view </span>文件里使用相对路径，均指相对与该路径，而不是相对于文件所在的路径</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">lib</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">WEB-INF/lib</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">该模块需要的<span lang="EN-US">jar</span>文件</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;">每个模块的<span lang="EN-US">jar</span>由不同的类加载器加载，是完全隔离的，即时有相同的也不会发生冲突；支持多层目录</span></p>
  </td>
 </tr>
 <tr>
  <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0cm 5.4pt; width: 98.55pt;" valign="top" width="131">
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">classes</span></p>
  <p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">WEB-INF/classes</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 133.4pt;" valign="top" width="178">
  <p class="MsoNormal"><span style="font-family: 宋体;">模块源码的编译输出路径</span></p>
  </td>
  <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0cm 5.4pt; width: 194.15pt;" valign="top" width="259">
  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-family: 宋体;">也可打成<span lang="EN-US">jar</span>包之后放在<span lang="EN-US">lib</span>目录下</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">每个模块都拥有完善的项目结构，所以开发时，可以作为独立项目来开发，而模块之间依赖关系，也上升为项目之间的依赖关系；这将可以避免多个模块作为同一个项目开发时，因为模块之间的依赖关系得不到控制，导致最后模块界限无法划分的情况。</span></p>

<h3><a name="_Toc171745422"><span style="font-family: 宋体;" lang="EN-US">5.4.2</span></a><span style="font-family: 宋体;">模块类路径</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">每个模块都由独立的类加载器加载，类加载器的加载路径为：<span lang="EN-US">conf, classes,WEB-INF/classes,lib,WEB-INF/lib</span>。对于<span lang="EN-US">lib</span>和<span lang="EN-US">WEB-INF/lib</span>目录，类加载器会加载其子目录下的<span lang="EN-US">jar</span>文件，所以，在开发和部署的时候，可以方便的将不同的<span lang="EN-US">jar</span>文件放在不同的二级目录中。</span></p>

<h3><a name="_Toc171745423"><span style="font-family: 宋体;" lang="EN-US">5.4.3</span></a><span style="font-family: 宋体;">模块的配置</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">可以使用<span lang="EN-US"> module.xml </span>来为模块进行配置，主要包括模块的名称、描述、加载优先级以及所引用的模块列表，也可以省略<span lang="EN-US">module.xml</span>文件，那么加载使用默认模块的配置。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">如<span lang="EN-US"> manager </span>模块的<span lang="EN-US"> module.xml </span>配置如下：</span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;?</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; color: blue; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">xml</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <span style="color: blue;">version=</span><span style="color: green;">"1.0"</span> <span style="color: blue;">encoding=</span><span style="color: green;">"utf-8"</span></span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">?&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">2 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">module</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">name</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">Manager</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">name</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">description</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">JFox</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> manager module</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">description</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">priority</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">1</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">priority</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;<i><span style="color: gray;">&lt;!--</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">7 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&lt;ref-modules&gt;Module_1,Module_2,Module_3,Module_4&lt;/ref-modules&gt;</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">8 </span><i><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; color: gray; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;--&gt;</span></i></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">9 </span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">module</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">在<span lang="EN-US">WEB-INF/MODULES</span>下的模块，会按照<span lang="EN-US"> priority</span>值从小到大的顺序进行加载。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; &lt;ref-modules&gt;</span><span style="font-family: 宋体;">以逗号为分隔列出该模块所有依赖的模块，该模块里的组件只能依赖这里列出的模块中的<span lang="EN-US">@Exported</span>的接口。</span></p>

<h3><a name="_Toc171745424"><span style="font-family: 宋体;" lang="EN-US">5.4.4</span></a><span style="font-family: 宋体;">模块的部署</span></h3>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">模块开发完成之后，需要部署，<span lang="EN-US">JFox</span>追求开发结构和部署结构一致的理念，所以开发完成之后，只需要将模块目录<span lang="EN-US">copy</span>至默认的<span lang="EN-US">WEB-INF/MODULES</span>下，即可在<span lang="EN-US">JFox </span>应用服务器启动时被加载。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">如果你不希望将源码一起部署，则尽管删除就是。你也可以使用<span lang="EN-US">ant</span>等工作将模块打包成<span lang="EN-US">zip</span>文件，并拷贝到<span lang="EN-US">WEB-INF/MODULES</span>下，<span lang="EN-US">JFox</span>启动时会将其解压并加载。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">部署之后，即可以通过浏览器访问模块中的<span lang="EN-US">Action</span>或者静态文件了，详见<span lang="EN-US">JFox MVC</span>框架中的访问<span lang="EN-US">Action</span>章节；或者编写<span lang="EN-US">Web Service</span>客户端访问模块中发布的<span lang="EN-US">Web Service</span>。</span></p>

<h1><a name="_Toc171745425"><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;" lang="EN-US">6</span></a><span style="font-size: 18pt; line-height: 240%; font-family: 宋体;">管理控制台</span></h1>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JFox</span><span style="font-family: 宋体;">已经内置了<span lang="EN-US">manager</span>，用于提供管理控制台，你可以通过它查看服务器的各项参数。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">管理控制台共提供了<span lang="EN-US">System Information</span>、<span lang="EN-US">JNDI View</span>、<span lang="EN-US">EJB Container</span>、<span lang="EN-US">JPA Container</span>、<span lang="EN-US">Modules</span>五个方面的功能。</span></p>

<h2><a name="_Toc171745426"><span style="font-family: 宋体;" lang="EN-US">6.1 System
Information</span></a></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">查看各种系统信息，包括<span lang="EN-US">JFox</span>版本、<span lang="EN-US">Web</span>容器版本、<span lang="EN-US">JVM</span>信息等。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image007.jpg" border="0" height="388" width="554"></span></p>

<h2><a name="_Toc171745427"><span style="font-family: 宋体;" lang="EN-US">6.2 JNDI
View</span></a></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">查看<span lang="EN-US">JNDI</span>信息，这里列出了包括<span lang="EN-US">Transaction Manager</span>、<span lang="EN-US">DataSource</span>、<span lang="EN-US">JMS Connection Factory</span>和<span lang="EN-US">EJB</span>所有的注册到<span lang="EN-US">JNDI</span>中的对象。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image008.jpg" border="0" height="415" width="553"></span></p>

<h2><a name="_Toc171745428"><span style="font-family: 宋体;" lang="EN-US">6.3 EJB
Container</span></a></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">这里列出了所有的部署的<span lang="EN-US">EJB</span>的详细信息，包括<span lang="EN-US">EJB</span>名称、类型、接口类、实现类，所在模块等。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image009.jpg" border="0" height="415" width="553"></span></p>

<h2><a name="_Toc171745429"><span style="font-family: 宋体;" lang="EN-US">6.4 JPA
Container</span></a></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">这里列出与<span lang="EN-US">JPA</span>相关的<span lang="EN-US">Persistence
Units</span>、<span lang="EN-US">Caches</span>、<span lang="EN-US">Named Queries</span>，并且可以测试数据源是否能够连接，以及手动销毁一个<span lang="EN-US">Persistence Unit</span>的<span lang="EN-US">Cache</span>。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image010.jpg" border="0" height="415" width="553"></span></p>

<h2><a name="_Toc171745430"><span style="font-family: 宋体;" lang="EN-US">6.5 Modules</span></a></h2>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;&nbsp;&nbsp; </span><span style="font-family: 宋体;">这里可以查看已成功部署至<span lang="EN-US">JFox</span>内核的模块的详细信息，包括<span lang="EN-US">Classpath</span>以及模块中已经部署的组件。</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image011.jpg" border="0" height="415" width="553"></span></p>

<h2><a name="_Toc171745431"><span style="font-family: 宋体;" lang="EN-US">6.6</span></a><span style="font-family: 宋体;">查看<span lang="EN-US">Web Service</span></span></h2>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;">如果要查看已经发布的</span><span lang="EN-US">Web Service</span><span style="font-family: 宋体;">，可以访问</span></p>

<p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;" lang="EN-US"><a href="http://localhost:8080/jfox/webservice">http://localhost:8080/jfox/webservice</a></span></p>

<h1><a name="_Toc171745432"><span style="font-family: 宋体;" lang="EN-US">7</span></a><span style="font-family: 宋体;">安装<span lang="EN-US">JFox Petstore</span>模块</span></h1>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">JPetstore</span><span style="font-family: 宋体;">是一个在线宠物商店，一般用来演示<span lang="EN-US">J2EE Web</span>应用。<span lang="EN-US">JFox Petstore</span>基于<span lang="EN-US">iBatis JPetstore</span>改造，针对<span lang="EN-US">JFox</span>的<span lang="EN-US">EJB3</span>、<span lang="EN-US">JPA</span>以及<span lang="EN-US">MVC</span>进行了重写，该模块对于如何基于<span lang="EN-US">JFox</span>来开发应用具有一定的指导意义。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">接下来介绍如何正确的安装和配置<span lang="EN-US">JFox Petstore</span>。</span></p>

<h2><a name="_Toc171745433"><span style="font-family: 宋体;" lang="EN-US">7.1 </span></a><span style="font-family: 宋体;">环境准备</span></h2>

<p class="MsoNormal" style="text-align: left; text-indent: 21pt;" align="left"><span style="font-family: 宋体;">首先请确认已经正确的安装了<span lang="EN-US">JFox 3</span>和<span lang="EN-US">MySQL(</span>建议<span lang="EN-US">5.0</span>以上版本<span lang="EN-US">)</span>，如何安装<span lang="EN-US">JFox 3</span>请参考本文<span lang="EN-US">JFox</span>安装与配置一章，<span lang="EN-US">MySQL</span>的安装请参考相关文档；然后从<span lang="EN-US">JFox</span>项目网站<span lang="EN-US">(<a href="http://code.google.com/p/jfox">http://code.google.com/p/jfox</a>)</span>下载<span lang="EN-US">Petstore</span>模块<span lang="EN-US">(</span>文件名<span lang="EN-US">petstore.zip)</span>，并拷贝到<span lang="EN-US">JFox</span>模块发布目录（默认为<span lang="EN-US">WEB-INF/MODULES</span>）。注：也可以解压后，以目录的形式拷贝到发布目录下（默认为<span lang="EN-US">WEB-INF/MODULES</span>），目录名为<span lang="EN-US">petstore</span>。</span></p>

<h2><a name="_Toc171745434"><span style="font-family: 宋体;" lang="EN-US">7.2 </span></a><span style="font-family: 宋体;">配置<span lang="EN-US">Petstore</span>数据源</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">打开<span lang="EN-US">JFox JPA</span>配置文件，<span lang="EN-US">WEB-INF/classes/META-INF/persistence.xml</span>，添加名称为的<span lang="EN-US">JPetstoreMysqlDS </span>的<span lang="EN-US">persistence-unit</span>，类似如下<span lang="EN-US">:</span></span></p>

<div style="border: 1pt solid black; padding: 3pt; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; text-indent: 4.5pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">1 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">persistence-unit</span> <span style="color: blue;">name=</span><span style="color: green;">"JPetstoreMysqlDS"</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 2 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">jta-data-source</span>&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">java:/JPetstoreMysqlDS</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">jta-data-source</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 3 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 4 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"driver"</span> <span style="color: blue;">value=</span><span style="color: green;">"com.mysql.jdbc.Driver"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 5 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"url"</span> <span style="color: blue;">value=</span><span style="color: green;">"jdbc:mysql://localhost:3306/jpetstore"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 6 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"username"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 7 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"password"</span> <span style="color: blue;">value=</span><span style="color: green;">"root"</span>/&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 8 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"minSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- min pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US"> 9 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"200"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max pool size --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">10 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"lifeTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"1800000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- 3h, connection max idle time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">11 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"sleepTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp; <i><span style="color: gray;">&lt;!--PoolKeeper sleep time, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">12 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockRetryWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"2000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- retry time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">13 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"deadLockMaxWait"</span> <span style="color: blue;">value=</span><span style="color: green;">"60000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max wait time if no free connection, in ms --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">14 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"checkLevelObject"</span> <span style="color: blue;">value=</span><span style="color: green;">"4"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- check connection closed --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">15 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.algorithm"</span> <span style="color: blue;">value=</span><span style="color: green;">"LRU"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- algorithm for "default" cache category, LRU, LFU, FIFO--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">16 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.ttl"</span> <span style="color: blue;">value=</span><span style="color: green;">"600000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- ttl for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">17 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxIdleTime"</span> <span style="color: blue;">value=</span><span style="color: green;">"300000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- maxidletime for "default", in ms--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">18 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxSize"</span> <span style="color: blue;">value=</span><span style="color: green;">"1000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max size for "default" --&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">19 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;<span style="color: navy;">property</span> <span style="color: blue;">name=</span><span style="color: green;">"cache.maxMemorySize"</span> <span style="color: blue;">value=</span><span style="color: green;">"100000000"</span>/&gt;</span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US"> <i><span style="color: gray;">&lt;!-- max memory size for "default", in bytes--&gt;</span></i></span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">20 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">properties</span>&gt;</span></pre><pre style="border: medium none ; padding: 0cm; background: white none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><span style="font-size: 9pt; color: maroon;" lang="EN-US">21 </span><span style="background: white none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: rgb(239, 239, 239) none repeat scroll 0% 0%; font-size: 9pt; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" lang="EN-US">&lt;/<span style="color: navy;">persistence-unit</span>&gt;</span></pre></div>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">应该保证用于创建数据库连接的<span lang="EN-US">driver</span>、<span lang="EN-US">url</span>、<span lang="EN-US">username</span>、<span lang="EN-US">password</span>是正确的。</span></p>

<h2><a name="_Toc171745435"><span style="font-family: 宋体;" lang="EN-US">7.3 </span></a><span style="font-family: 宋体;">导入初始化数据</span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">注意：<span lang="EN-US">JFox Petstore</span>默认使用的数据库名为<span lang="EN-US">jpetstore</span>，请确认当前<span lang="EN-US">mysql</span>中没有该库，因为导入数据的时候会删除以存在的<span lang="EN-US">jpetstore</span>库而造成你的数据丢失。</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">用于初始化<span lang="EN-US">MySQL</span>的脚本位于<span lang="EN-US">Petstore</span>模块下的<span lang="EN-US">/db/mysql/jfox-petstore-backup.sql</span>中，使用你熟悉的工具或者命令行将其导入，建议你使用<span lang="EN-US">SQLyog(<a href="http://www.webyog.com/">http://www.webyog.com/</a>)</span>，一个不错的开源<span lang="EN-US">MySQL GUI Manager Tool</span>。</span></p>

<h2><a name="_Toc171745436"><span style="font-family: 宋体;" lang="EN-US">7.4 </span></a><span style="font-family: 宋体;">访问<span lang="EN-US">Petstore</span></span></h2>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">接下来，启动<span lang="EN-US">Tomcat</span>，正常的话，可以看到类似如下的日志输出：</span></p>

<p class="MsoNormal"><span style="font-size: 9pt; font-family: 宋体;" lang="EN-US">17:29:08,532
INFO&nbsp; [Framework] Module: Petstore loaded, from D:\apache-tomcat-5.5.20\webapps\jfox3\WEB-INF\MODULES\petstore</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">然后，打开浏览器，访问
</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;" lang="EN-US"><a href="http://localhost:8080/jfox3/modules/petstore/welcome.html"><span style="color: windowtext; text-decoration: none;">http://localhost:8080/jfox3/modules/petstore/welcome.html</span></a></span><span style="font-family: 宋体;">，</span></p>

<p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">即可以看到<span lang="EN-US">Petstore</span>的欢迎页面了，恭喜！</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US"><img src="JFox_3_0_Reference_Guide_CN_files/image012.jpg" border="0" height="342" width="554"></span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family: 宋体;" lang="EN-US">&nbsp;</span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><span style="font-family: 宋体;" lang="EN-US">&lt; </span><span style="font-family: 宋体;">全文完<span lang="EN-US"> &gt;</span></span></p>

<p class="MsoNormal" style="text-align: center;" align="center"><span style="font-family: 宋体;" lang="EN-US">2007-5-23</span></p>

</div>

</body></html>